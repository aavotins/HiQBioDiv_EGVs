<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Raw geodata | High-resolution ecogeographical variables for species distribution modelling describing Latvia, 2024</title>
  <meta name="description" content="<p>Description of the geodata used and the geoprocessing workflows employed to
create ecogeographical variables (EGVs) for species distribution modelling
describing Latvia, 2024.</p>" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Raw geodata | High-resolution ecogeographical variables for species distribution modelling describing Latvia, 2024" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>Description of the geodata used and the geoprocessing workflows employed to
create ecogeographical variables (EGVs) for species distribution modelling
describing Latvia, 2024.</p>" />
  <meta name="github-repo" content="aavotins/HiQBioDiv_EGVs" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Raw geodata | High-resolution ecogeographical variables for species distribution modelling describing Latvia, 2024" />
  
  <meta name="twitter:description" content="<p>Description of the geodata used and the geoprocessing workflows employed to
create ecogeographical variables (EGVs) for species distribution modelling
describing Latvia, 2024.</p>" />
  

<meta name="author" content="Andris Avotiņš" />


<meta name="date" content="2025-10-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Ch03.html"/>
<link rel="next" href="Ch05.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">HiQBioDiv EGVs</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-this-material"><i class="fa fa-check"></i>About this material</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#outline"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="Ch01.html"><a href="Ch01.html"><i class="fa fa-check"></i><b>1</b> Terminology and acronyms</a></li>
<li class="chapter" data-level="2" data-path="Ch02.html"><a href="Ch02.html"><i class="fa fa-check"></i><b>2</b> Utilities</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Ch02.html"><a href="Ch02.html#Ch02.01"><i class="fa fa-check"></i><b>2.1</b> R package egvtools</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="Ch02.html"><a href="Ch02.html#Ch02.01.01"><i class="fa fa-check"></i><b>2.1.1</b> Reproduction only functions</a></li>
<li class="chapter" data-level="2.1.2" data-path="Ch02.html"><a href="Ch02.html#Ch02.01.02"><i class="fa fa-check"></i><b>2.1.2</b> General purpose functions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="Ch02.html"><a href="Ch02.html#Ch02.02"><i class="fa fa-check"></i><b>2.2</b> Other utility functions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Ch03.html"><a href="Ch03.html"><i class="fa fa-check"></i><b>3</b> Templates and utilities</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Ch03.html"><a href="Ch03.html#Ch03.01"><i class="fa fa-check"></i><b>3.1</b> Vector data</a></li>
<li class="chapter" data-level="3.2" data-path="Ch03.html"><a href="Ch03.html#Ch03.02"><i class="fa fa-check"></i><b>3.2</b> Raster data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Ch04.html"><a href="Ch04.html"><i class="fa fa-check"></i><b>4</b> Raw geodata</a>
<ul>
<li class="chapter" data-level="4.1" data-path="Ch04.html"><a href="Ch04.html#Ch04.01"><i class="fa fa-check"></i><b>4.1</b> State Forest Service’s State Forest Registry</a></li>
<li class="chapter" data-level="4.2" data-path="Ch04.html"><a href="Ch04.html#Ch04.02"><i class="fa fa-check"></i><b>4.2</b> Rural Support Service’s information on declared fields</a></li>
<li class="chapter" data-level="4.3" data-path="Ch04.html"><a href="Ch04.html#Ch04.03"><i class="fa fa-check"></i><b>4.3</b> Melioration Cadaster</a></li>
<li class="chapter" data-level="4.4" data-path="Ch04.html"><a href="Ch04.html#Ch04.04"><i class="fa fa-check"></i><b>4.4</b> TopographicMap</a></li>
<li class="chapter" data-level="4.5" data-path="Ch04.html"><a href="Ch04.html#Ch04.05"><i class="fa fa-check"></i><b>4.5</b> Corine Land Cover 2018</a></li>
<li class="chapter" data-level="4.6" data-path="Ch04.html"><a href="Ch04.html#Ch04.06"><i class="fa fa-check"></i><b>4.6</b> Publicly available LVM data</a></li>
<li class="chapter" data-level="4.7" data-path="Ch04.html"><a href="Ch04.html#Ch04.07"><i class="fa fa-check"></i><b>4.7</b> Soil data</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="Ch04.html"><a href="Ch04.html#Ch04.07.01"><i class="fa fa-check"></i><b>4.7.1</b> Soil chemistry</a></li>
<li class="chapter" data-level="4.7.2" data-path="Ch04.html"><a href="Ch04.html#Ch04.07.02"><i class="fa fa-check"></i><b>4.7.2</b> Soil texture: Europe</a></li>
<li class="chapter" data-level="4.7.3" data-path="Ch04.html"><a href="Ch04.html#Ch04.07.03"><i class="fa fa-check"></i><b>4.7.3</b> Soil texture: Farmland</a></li>
<li class="chapter" data-level="4.7.4" data-path="Ch04.html"><a href="Ch04.html#Ch04.07.04"><i class="fa fa-check"></i><b>4.7.4</b> Soil texture: Quaternary</a></li>
<li class="chapter" data-level="4.7.5" data-path="Ch04.html"><a href="Ch04.html#Ch04.07.05"><i class="fa fa-check"></i><b>4.7.5</b> Organic soils: SILAVA</a></li>
<li class="chapter" data-level="4.7.6" data-path="Ch04.html"><a href="Ch04.html#Ch04.07.06"><i class="fa fa-check"></i><b>4.7.6</b> Organic soils: LU</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="Ch04.html"><a href="Ch04.html#Ch04.08"><i class="fa fa-check"></i><b>4.8</b> Dynamic World data</a></li>
<li class="chapter" data-level="4.9" data-path="Ch04.html"><a href="Ch04.html#Ch04.09"><i class="fa fa-check"></i><b>4.9</b> The Global Forest Watch</a></li>
<li class="chapter" data-level="4.10" data-path="Ch04.html"><a href="Ch04.html#Ch04.10"><i class="fa fa-check"></i><b>4.10</b> Palsar</a></li>
<li class="chapter" data-level="4.11" data-path="Ch04.html"><a href="Ch04.html#Ch04.11"><i class="fa fa-check"></i><b>4.11</b> CHELSA v2.1</a></li>
<li class="chapter" data-level="4.12" data-path="Ch04.html"><a href="Ch04.html#Ch04.12"><i class="fa fa-check"></i><b>4.12</b> HydroClim data</a></li>
<li class="chapter" data-level="4.13" data-path="Ch04.html"><a href="Ch04.html#Ch04.13"><i class="fa fa-check"></i><b>4.13</b> Sentinel-2 indices</a></li>
<li class="chapter" data-level="4.14" data-path="Ch04.html"><a href="Ch04.html#Ch04.14"><i class="fa fa-check"></i><b>4.14</b> Waste and garbage disposal sites, landfills</a></li>
<li class="chapter" data-level="4.15" data-path="Ch04.html"><a href="Ch04.html#Ch04.15"><i class="fa fa-check"></i><b>4.15</b> Digital elevation/terrain models</a></li>
<li class="chapter" data-level="4.16" data-path="Ch04.html"><a href="Ch04.html#Ch04.16"><i class="fa fa-check"></i><b>4.16</b> Latvian Exclusive Economic Zone polygon</a></li>
<li class="chapter" data-level="4.17" data-path="Ch04.html"><a href="Ch04.html#Ch04.17"><i class="fa fa-check"></i><b>4.17</b> Bogs and Mires: EDI</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Ch05.html"><a href="Ch05.html"><i class="fa fa-check"></i><b>5</b> Geodata products</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Ch05.html"><a href="Ch05.html#Ch05.01"><i class="fa fa-check"></i><b>5.1</b> Terrain products</a></li>
<li class="chapter" data-level="5.2" data-path="Ch05.html"><a href="Ch05.html#Ch05.02"><i class="fa fa-check"></i><b>5.2</b> Soil texture product</a></li>
<li class="chapter" data-level="5.3" data-path="Ch05.html"><a href="Ch05.html#Ch05.03"><i class="fa fa-check"></i><b>5.3</b> Landscape classification</a></li>
<li class="chapter" data-level="5.4" data-path="Ch05.html"><a href="Ch05.html#Ch05.04"><i class="fa fa-check"></i><b>5.4</b> Landscape diversity</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="Ch05.html"><a href="Ch05.html#Ch05.04.01"><i class="fa fa-check"></i><b>5.4.1</b> Landscape in general diversity</a></li>
<li class="chapter" data-level="5.4.2" data-path="Ch05.html"><a href="Ch05.html#Ch05.04.02"><i class="fa fa-check"></i><b>5.4.2</b> Forest diversity</a></li>
<li class="chapter" data-level="5.4.3" data-path="Ch05.html"><a href="Ch05.html#Ch05.04.03"><i class="fa fa-check"></i><b>5.4.3</b> Farmland diversity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Ch06.html"><a href="Ch06.html"><i class="fa fa-check"></i><b>6</b> Ecogeographical variables</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Ch06.html"><a href="Ch06.html#ch06.001"><i class="fa fa-check"></i><b>6.1</b> Climate_CHELSAv2.1-bio1_cell</a></li>
<li class="chapter" data-level="6.2" data-path="Ch06.html"><a href="Ch06.html#ch06.002"><i class="fa fa-check"></i><b>6.2</b> Climate_CHELSAv2.1-bio10_cell</a></li>
<li class="chapter" data-level="6.3" data-path="Ch06.html"><a href="Ch06.html#ch06.003"><i class="fa fa-check"></i><b>6.3</b> Climate_CHELSAv2.1-bio11_cell</a></li>
<li class="chapter" data-level="6.4" data-path="Ch06.html"><a href="Ch06.html#ch06.004"><i class="fa fa-check"></i><b>6.4</b> Climate_CHELSAv2.1-bio12_cell</a></li>
<li class="chapter" data-level="6.5" data-path="Ch06.html"><a href="Ch06.html#ch06.005"><i class="fa fa-check"></i><b>6.5</b> Climate_CHELSAv2.1-bio13_cell</a></li>
<li class="chapter" data-level="6.6" data-path="Ch06.html"><a href="Ch06.html#ch06.006"><i class="fa fa-check"></i><b>6.6</b> Climate_CHELSAv2.1-bio14_cell</a></li>
<li class="chapter" data-level="6.7" data-path="Ch06.html"><a href="Ch06.html#ch06.007"><i class="fa fa-check"></i><b>6.7</b> Climate_CHELSAv2.1-bio15_cell</a></li>
<li class="chapter" data-level="6.8" data-path="Ch06.html"><a href="Ch06.html#ch06.008"><i class="fa fa-check"></i><b>6.8</b> Climate_CHELSAv2.1-bio16_cell</a></li>
<li class="chapter" data-level="6.9" data-path="Ch06.html"><a href="Ch06.html#ch06.009"><i class="fa fa-check"></i><b>6.9</b> Climate_CHELSAv2.1-bio17_cell</a></li>
<li class="chapter" data-level="6.10" data-path="Ch06.html"><a href="Ch06.html#ch06.010"><i class="fa fa-check"></i><b>6.10</b> Climate_CHELSAv2.1-bio18_cell</a></li>
<li class="chapter" data-level="6.11" data-path="Ch06.html"><a href="Ch06.html#ch06.011"><i class="fa fa-check"></i><b>6.11</b> Climate_CHELSAv2.1-bio19_cell</a></li>
<li class="chapter" data-level="6.12" data-path="Ch06.html"><a href="Ch06.html#ch06.012"><i class="fa fa-check"></i><b>6.12</b> Climate_CHELSAv2.1-bio2_cell</a></li>
<li class="chapter" data-level="6.13" data-path="Ch06.html"><a href="Ch06.html#ch06.013"><i class="fa fa-check"></i><b>6.13</b> Climate_CHELSAv2.1-bio3_cell</a></li>
<li class="chapter" data-level="6.14" data-path="Ch06.html"><a href="Ch06.html#ch06.014"><i class="fa fa-check"></i><b>6.14</b> Climate_CHELSAv2.1-bio4_cell</a></li>
<li class="chapter" data-level="6.15" data-path="Ch06.html"><a href="Ch06.html#ch06.015"><i class="fa fa-check"></i><b>6.15</b> Climate_CHELSAv2.1-bio5_cell</a></li>
<li class="chapter" data-level="6.16" data-path="Ch06.html"><a href="Ch06.html#ch06.016"><i class="fa fa-check"></i><b>6.16</b> Climate_CHELSAv2.1-bio6_cell</a></li>
<li class="chapter" data-level="6.17" data-path="Ch06.html"><a href="Ch06.html#ch06.017"><i class="fa fa-check"></i><b>6.17</b> Climate_CHELSAv2.1-bio7_cell</a></li>
<li class="chapter" data-level="6.18" data-path="Ch06.html"><a href="Ch06.html#ch06.018"><i class="fa fa-check"></i><b>6.18</b> Climate_CHELSAv2.1-bio8_cell</a></li>
<li class="chapter" data-level="6.19" data-path="Ch06.html"><a href="Ch06.html#ch06.019"><i class="fa fa-check"></i><b>6.19</b> Climate_CHELSAv2.1-bio9_cell</a></li>
<li class="chapter" data-level="6.20" data-path="Ch06.html"><a href="Ch06.html#ch06.020"><i class="fa fa-check"></i><b>6.20</b> Climate_CHELSAv2.1-clt-max_cell</a></li>
<li class="chapter" data-level="6.21" data-path="Ch06.html"><a href="Ch06.html#ch06.021"><i class="fa fa-check"></i><b>6.21</b> Climate_CHELSAv2.1-clt-mean_cell</a></li>
<li class="chapter" data-level="6.22" data-path="Ch06.html"><a href="Ch06.html#ch06.022"><i class="fa fa-check"></i><b>6.22</b> Climate_CHELSAv2.1-clt-min_cell</a></li>
<li class="chapter" data-level="6.23" data-path="Ch06.html"><a href="Ch06.html#ch06.023"><i class="fa fa-check"></i><b>6.23</b> Climate_CHELSAv2.1-clt-range_cell</a></li>
<li class="chapter" data-level="6.24" data-path="Ch06.html"><a href="Ch06.html#ch06.024"><i class="fa fa-check"></i><b>6.24</b> Climate_CHELSAv2.1-cmi-max_cell</a></li>
<li class="chapter" data-level="6.25" data-path="Ch06.html"><a href="Ch06.html#ch06.025"><i class="fa fa-check"></i><b>6.25</b> Climate_CHELSAv2.1-cmi-mean_cell</a></li>
<li class="chapter" data-level="6.26" data-path="Ch06.html"><a href="Ch06.html#ch06.026"><i class="fa fa-check"></i><b>6.26</b> Climate_CHELSAv2.1-cmi-min_cell</a></li>
<li class="chapter" data-level="6.27" data-path="Ch06.html"><a href="Ch06.html#ch06.027"><i class="fa fa-check"></i><b>6.27</b> Climate_CHELSAv2.1-cmi-range_cell</a></li>
<li class="chapter" data-level="6.28" data-path="Ch06.html"><a href="Ch06.html#ch06.028"><i class="fa fa-check"></i><b>6.28</b> Climate_CHELSAv2.1-fcf_cell</a></li>
<li class="chapter" data-level="6.29" data-path="Ch06.html"><a href="Ch06.html#ch06.029"><i class="fa fa-check"></i><b>6.29</b> Climate_CHELSAv2.1-fgd_cell</a></li>
<li class="chapter" data-level="6.30" data-path="Ch06.html"><a href="Ch06.html#ch06.030"><i class="fa fa-check"></i><b>6.30</b> Climate_CHELSAv2.1-gdd0_cell</a></li>
<li class="chapter" data-level="6.31" data-path="Ch06.html"><a href="Ch06.html#ch06.031"><i class="fa fa-check"></i><b>6.31</b> Climate_CHELSAv2.1-gdd10_cell</a></li>
<li class="chapter" data-level="6.32" data-path="Ch06.html"><a href="Ch06.html#ch06.032"><i class="fa fa-check"></i><b>6.32</b> Climate_CHELSAv2.1-gdd5_cell</a></li>
<li class="chapter" data-level="6.33" data-path="Ch06.html"><a href="Ch06.html#ch06.033"><i class="fa fa-check"></i><b>6.33</b> Climate_CHELSAv2.1-gddlgd0_cell</a></li>
<li class="chapter" data-level="6.34" data-path="Ch06.html"><a href="Ch06.html#ch06.034"><i class="fa fa-check"></i><b>6.34</b> Climate_CHELSAv2.1-gddlgd10_cell</a></li>
<li class="chapter" data-level="6.35" data-path="Ch06.html"><a href="Ch06.html#ch06.035"><i class="fa fa-check"></i><b>6.35</b> Climate_CHELSAv2.1-gddlgd5_cell</a></li>
<li class="chapter" data-level="6.36" data-path="Ch06.html"><a href="Ch06.html#ch06.036"><i class="fa fa-check"></i><b>6.36</b> Climate_CHELSAv2.1-gdgfgd0_cell</a></li>
<li class="chapter" data-level="6.37" data-path="Ch06.html"><a href="Ch06.html#ch06.037"><i class="fa fa-check"></i><b>6.37</b> Climate_CHELSAv2.1-gdgfgd10_cell</a></li>
<li class="chapter" data-level="6.38" data-path="Ch06.html"><a href="Ch06.html#ch06.038"><i class="fa fa-check"></i><b>6.38</b> Climate_CHELSAv2.1-gdgfgd5_cell</a></li>
<li class="chapter" data-level="6.39" data-path="Ch06.html"><a href="Ch06.html#ch06.039"><i class="fa fa-check"></i><b>6.39</b> Climate_CHELSAv2.1-gsl_cell</a></li>
<li class="chapter" data-level="6.40" data-path="Ch06.html"><a href="Ch06.html#ch06.040"><i class="fa fa-check"></i><b>6.40</b> Climate_CHELSAv2.1-gsp_cell</a></li>
<li class="chapter" data-level="6.41" data-path="Ch06.html"><a href="Ch06.html#ch06.041"><i class="fa fa-check"></i><b>6.41</b> Climate_CHELSAv2.1-gst_cell</a></li>
<li class="chapter" data-level="6.42" data-path="Ch06.html"><a href="Ch06.html#ch06.042"><i class="fa fa-check"></i><b>6.42</b> Climate_CHELSAv2.1-hurs-max_cell</a></li>
<li class="chapter" data-level="6.43" data-path="Ch06.html"><a href="Ch06.html#ch06.043"><i class="fa fa-check"></i><b>6.43</b> Climate_CHELSAv2.1-hurs-mean_cell</a></li>
<li class="chapter" data-level="6.44" data-path="Ch06.html"><a href="Ch06.html#ch06.044"><i class="fa fa-check"></i><b>6.44</b> Climate_CHELSAv2.1-hurs-min_cell</a></li>
<li class="chapter" data-level="6.45" data-path="Ch06.html"><a href="Ch06.html#ch06.045"><i class="fa fa-check"></i><b>6.45</b> Climate_CHELSAv2.1-hurs-range_cell</a></li>
<li class="chapter" data-level="6.46" data-path="Ch06.html"><a href="Ch06.html#ch06.046"><i class="fa fa-check"></i><b>6.46</b> Climate_CHELSAv2.1-lgd_cell</a></li>
<li class="chapter" data-level="6.47" data-path="Ch06.html"><a href="Ch06.html#ch06.047"><i class="fa fa-check"></i><b>6.47</b> Climate_CHELSAv2.1-ngd0_cell</a></li>
<li class="chapter" data-level="6.48" data-path="Ch06.html"><a href="Ch06.html#ch06.048"><i class="fa fa-check"></i><b>6.48</b> Climate_CHELSAv2.1-ngd10_cell</a></li>
<li class="chapter" data-level="6.49" data-path="Ch06.html"><a href="Ch06.html#ch06.049"><i class="fa fa-check"></i><b>6.49</b> Climate_CHELSAv2.1-ngd5_cell</a></li>
<li class="chapter" data-level="6.50" data-path="Ch06.html"><a href="Ch06.html#ch06.050"><i class="fa fa-check"></i><b>6.50</b> Climate_CHELSAv2.1-npp_cell</a></li>
<li class="chapter" data-level="6.51" data-path="Ch06.html"><a href="Ch06.html#ch06.051"><i class="fa fa-check"></i><b>6.51</b> Climate_CHELSAv2.1-pet-penman-max_cell</a></li>
<li class="chapter" data-level="6.52" data-path="Ch06.html"><a href="Ch06.html#ch06.052"><i class="fa fa-check"></i><b>6.52</b> Climate_CHELSAv2.1-pet-penman-mean_cell</a></li>
<li class="chapter" data-level="6.53" data-path="Ch06.html"><a href="Ch06.html#ch06.053"><i class="fa fa-check"></i><b>6.53</b> Climate_CHELSAv2.1-pet-penman-min_cell</a></li>
<li class="chapter" data-level="6.54" data-path="Ch06.html"><a href="Ch06.html#ch06.054"><i class="fa fa-check"></i><b>6.54</b> Climate_CHELSAv2.1-pet-penman-range_cell</a></li>
<li class="chapter" data-level="6.55" data-path="Ch06.html"><a href="Ch06.html#ch06.055"><i class="fa fa-check"></i><b>6.55</b> Climate_CHELSAv2.1-rsds-max_cell</a></li>
<li class="chapter" data-level="6.56" data-path="Ch06.html"><a href="Ch06.html#ch06.056"><i class="fa fa-check"></i><b>6.56</b> Climate_CHELSAv2.1-rsds-mean_cell</a></li>
<li class="chapter" data-level="6.57" data-path="Ch06.html"><a href="Ch06.html#ch06.057"><i class="fa fa-check"></i><b>6.57</b> Climate_CHELSAv2.1-rsds-min_cell</a></li>
<li class="chapter" data-level="6.58" data-path="Ch06.html"><a href="Ch06.html#ch06.058"><i class="fa fa-check"></i><b>6.58</b> Climate_CHELSAv2.1-rsds-range_cell</a></li>
<li class="chapter" data-level="6.59" data-path="Ch06.html"><a href="Ch06.html#ch06.059"><i class="fa fa-check"></i><b>6.59</b> Climate_CHELSAv2.1-scd_cell</a></li>
<li class="chapter" data-level="6.60" data-path="Ch06.html"><a href="Ch06.html#ch06.060"><i class="fa fa-check"></i><b>6.60</b> Climate_CHELSAv2.1-sfcWind-max_cell</a></li>
<li class="chapter" data-level="6.61" data-path="Ch06.html"><a href="Ch06.html#ch06.061"><i class="fa fa-check"></i><b>6.61</b> Climate_CHELSAv2.1-sfcWind-mean_cell</a></li>
<li class="chapter" data-level="6.62" data-path="Ch06.html"><a href="Ch06.html#ch06.062"><i class="fa fa-check"></i><b>6.62</b> Climate_CHELSAv2.1-sfcWind-min_cell</a></li>
<li class="chapter" data-level="6.63" data-path="Ch06.html"><a href="Ch06.html#ch06.063"><i class="fa fa-check"></i><b>6.63</b> Climate_CHELSAv2.1-sfcWind-range_cell</a></li>
<li class="chapter" data-level="6.64" data-path="Ch06.html"><a href="Ch06.html#ch06.064"><i class="fa fa-check"></i><b>6.64</b> Climate_CHELSAv2.1-swb_cell</a></li>
<li class="chapter" data-level="6.65" data-path="Ch06.html"><a href="Ch06.html#ch06.065"><i class="fa fa-check"></i><b>6.65</b> Climate_CHELSAv2.1-swe_cell</a></li>
<li class="chapter" data-level="6.66" data-path="Ch06.html"><a href="Ch06.html#ch06.066"><i class="fa fa-check"></i><b>6.66</b> Climate_CHELSAv2.1-vpd-max_cell</a></li>
<li class="chapter" data-level="6.67" data-path="Ch06.html"><a href="Ch06.html#ch06.067"><i class="fa fa-check"></i><b>6.67</b> Climate_CHELSAv2.1-vpd-mean_cell</a></li>
<li class="chapter" data-level="6.68" data-path="Ch06.html"><a href="Ch06.html#ch06.068"><i class="fa fa-check"></i><b>6.68</b> Climate_CHELSAv2.1-vpd-min_cell</a></li>
<li class="chapter" data-level="6.69" data-path="Ch06.html"><a href="Ch06.html#ch06.069"><i class="fa fa-check"></i><b>6.69</b> Climate_CHELSAv2.1-vpd-range_cell</a></li>
<li class="chapter" data-level="6.70" data-path="Ch06.html"><a href="Ch06.html#ch06.070"><i class="fa fa-check"></i><b>6.70</b> HydroClim_01-max_cell</a></li>
<li class="chapter" data-level="6.71" data-path="Ch06.html"><a href="Ch06.html#ch06.071"><i class="fa fa-check"></i><b>6.71</b> HydroClim_02-max_cell</a></li>
<li class="chapter" data-level="6.72" data-path="Ch06.html"><a href="Ch06.html#ch06.072"><i class="fa fa-check"></i><b>6.72</b> HydroClim_03-max_cell</a></li>
<li class="chapter" data-level="6.73" data-path="Ch06.html"><a href="Ch06.html#ch06.073"><i class="fa fa-check"></i><b>6.73</b> HydroClim_04-max_cell</a></li>
<li class="chapter" data-level="6.74" data-path="Ch06.html"><a href="Ch06.html#ch06.074"><i class="fa fa-check"></i><b>6.74</b> HydroClim_05-max_cell</a></li>
<li class="chapter" data-level="6.75" data-path="Ch06.html"><a href="Ch06.html#ch06.075"><i class="fa fa-check"></i><b>6.75</b> HydroClim_06-min_cell</a></li>
<li class="chapter" data-level="6.76" data-path="Ch06.html"><a href="Ch06.html#ch06.076"><i class="fa fa-check"></i><b>6.76</b> HydroClim_07-max_cell</a></li>
<li class="chapter" data-level="6.77" data-path="Ch06.html"><a href="Ch06.html#ch06.077"><i class="fa fa-check"></i><b>6.77</b> HydroClim_08-max_cell</a></li>
<li class="chapter" data-level="6.78" data-path="Ch06.html"><a href="Ch06.html#ch06.078"><i class="fa fa-check"></i><b>6.78</b> HydroClim_09-min_cell</a></li>
<li class="chapter" data-level="6.79" data-path="Ch06.html"><a href="Ch06.html#ch06.079"><i class="fa fa-check"></i><b>6.79</b> HydroClim_10-max_cell</a></li>
<li class="chapter" data-level="6.80" data-path="Ch06.html"><a href="Ch06.html#ch06.080"><i class="fa fa-check"></i><b>6.80</b> HydroClim_11-min_cell</a></li>
<li class="chapter" data-level="6.81" data-path="Ch06.html"><a href="Ch06.html#ch06.081"><i class="fa fa-check"></i><b>6.81</b> HydroClim_12-max_cell</a></li>
<li class="chapter" data-level="6.82" data-path="Ch06.html"><a href="Ch06.html#ch06.082"><i class="fa fa-check"></i><b>6.82</b> HydroClim_13-max_cell</a></li>
<li class="chapter" data-level="6.83" data-path="Ch06.html"><a href="Ch06.html#ch06.083"><i class="fa fa-check"></i><b>6.83</b> HydroClim_14-max_cell</a></li>
<li class="chapter" data-level="6.84" data-path="Ch06.html"><a href="Ch06.html#ch06.084"><i class="fa fa-check"></i><b>6.84</b> HydroClim_15-max_cell</a></li>
<li class="chapter" data-level="6.85" data-path="Ch06.html"><a href="Ch06.html#ch06.085"><i class="fa fa-check"></i><b>6.85</b> HydroClim_16-max_cell</a></li>
<li class="chapter" data-level="6.86" data-path="Ch06.html"><a href="Ch06.html#ch06.086"><i class="fa fa-check"></i><b>6.86</b> HydroClim_17-max_cell</a></li>
<li class="chapter" data-level="6.87" data-path="Ch06.html"><a href="Ch06.html#ch06.087"><i class="fa fa-check"></i><b>6.87</b> HydroClim_18-max_cell</a></li>
<li class="chapter" data-level="6.88" data-path="Ch06.html"><a href="Ch06.html#ch06.088"><i class="fa fa-check"></i><b>6.88</b> HydroClim_19-max_cell</a></li>
<li class="chapter" data-level="6.89" data-path="Ch06.html"><a href="Ch06.html#ch06.089"><i class="fa fa-check"></i><b>6.89</b> Distance_Builtup_cell</a></li>
<li class="chapter" data-level="6.90" data-path="Ch06.html"><a href="Ch06.html#ch06.090"><i class="fa fa-check"></i><b>6.90</b> Distance_ForestInside_cell</a></li>
<li class="chapter" data-level="6.91" data-path="Ch06.html"><a href="Ch06.html#ch06.091"><i class="fa fa-check"></i><b>6.91</b> Distance_GrasslandPermanent_cell</a></li>
<li class="chapter" data-level="6.92" data-path="Ch06.html"><a href="Ch06.html#ch06.092"><i class="fa fa-check"></i><b>6.92</b> Distance_Landfill_cell</a></li>
<li class="chapter" data-level="6.93" data-path="Ch06.html"><a href="Ch06.html#ch06.093"><i class="fa fa-check"></i><b>6.93</b> Distance_Sea_cell</a></li>
<li class="chapter" data-level="6.94" data-path="Ch06.html"><a href="Ch06.html#ch06.094"><i class="fa fa-check"></i><b>6.94</b> Distance_Trees_cell</a></li>
<li class="chapter" data-level="6.95" data-path="Ch06.html"><a href="Ch06.html#ch06.095"><i class="fa fa-check"></i><b>6.95</b> Distance_Waste_cell</a></li>
<li class="chapter" data-level="6.96" data-path="Ch06.html"><a href="Ch06.html#ch06.096"><i class="fa fa-check"></i><b>6.96</b> Distance_Water_cell</a></li>
<li class="chapter" data-level="6.97" data-path="Ch06.html"><a href="Ch06.html#ch06.097"><i class="fa fa-check"></i><b>6.97</b> Distance_WaterInside_cell</a></li>
<li class="chapter" data-level="6.98" data-path="Ch06.html"><a href="Ch06.html#ch06.098"><i class="fa fa-check"></i><b>6.98</b> Diversity_Farmland_r500</a></li>
<li class="chapter" data-level="6.99" data-path="Ch06.html"><a href="Ch06.html#ch06.099"><i class="fa fa-check"></i><b>6.99</b> Diversity_Farmland_r1250</a></li>
<li class="chapter" data-level="6.100" data-path="Ch06.html"><a href="Ch06.html#ch06.100"><i class="fa fa-check"></i><b>6.100</b> Diversity_Farmland_r3000</a></li>
<li class="chapter" data-level="6.101" data-path="Ch06.html"><a href="Ch06.html#ch06.101"><i class="fa fa-check"></i><b>6.101</b> Diversity_Farmland_r10000</a></li>
<li class="chapter" data-level="6.102" data-path="Ch06.html"><a href="Ch06.html#ch06.102"><i class="fa fa-check"></i><b>6.102</b> Diversity_Forest_r500</a></li>
<li class="chapter" data-level="6.103" data-path="Ch06.html"><a href="Ch06.html#ch06.103"><i class="fa fa-check"></i><b>6.103</b> Diversity_Forest_r1250</a></li>
<li class="chapter" data-level="6.104" data-path="Ch06.html"><a href="Ch06.html#ch06.104"><i class="fa fa-check"></i><b>6.104</b> Diversity_Forest_r3000</a></li>
<li class="chapter" data-level="6.105" data-path="Ch06.html"><a href="Ch06.html#ch06.105"><i class="fa fa-check"></i><b>6.105</b> Diversity_Forest_r10000</a></li>
<li class="chapter" data-level="6.106" data-path="Ch06.html"><a href="Ch06.html#ch06.106"><i class="fa fa-check"></i><b>6.106</b> Diversity_Total_r500</a></li>
<li class="chapter" data-level="6.107" data-path="Ch06.html"><a href="Ch06.html#ch06.107"><i class="fa fa-check"></i><b>6.107</b> Diversity_Total_r1250</a></li>
<li class="chapter" data-level="6.108" data-path="Ch06.html"><a href="Ch06.html#ch06.108"><i class="fa fa-check"></i><b>6.108</b> Diversity_Total_r3000</a></li>
<li class="chapter" data-level="6.109" data-path="Ch06.html"><a href="Ch06.html#ch06.109"><i class="fa fa-check"></i><b>6.109</b> Diversity_Total_r10000</a></li>
<li class="chapter" data-level="6.110" data-path="Ch06.html"><a href="Ch06.html#ch06.110"><i class="fa fa-check"></i><b>6.110</b> Edges_Bogs-Trees_cell</a></li>
<li class="chapter" data-level="6.111" data-path="Ch06.html"><a href="Ch06.html#ch06.111"><i class="fa fa-check"></i><b>6.111</b> Edges_Bogs-Trees_r500</a></li>
<li class="chapter" data-level="6.112" data-path="Ch06.html"><a href="Ch06.html#ch06.112"><i class="fa fa-check"></i><b>6.112</b> Edges_Bogs-Trees_r1250</a></li>
<li class="chapter" data-level="6.113" data-path="Ch06.html"><a href="Ch06.html#ch06.113"><i class="fa fa-check"></i><b>6.113</b> Edges_Bogs-Trees_r3000</a></li>
<li class="chapter" data-level="6.114" data-path="Ch06.html"><a href="Ch06.html#ch06.114"><i class="fa fa-check"></i><b>6.114</b> Edges_Bogs-Trees_r10000</a></li>
<li class="chapter" data-level="6.115" data-path="Ch06.html"><a href="Ch06.html#ch06.115"><i class="fa fa-check"></i><b>6.115</b> Edges_Bogs-Water_cell</a></li>
<li class="chapter" data-level="6.116" data-path="Ch06.html"><a href="Ch06.html#ch06.116"><i class="fa fa-check"></i><b>6.116</b> Edges_Bogs-Water_r500</a></li>
<li class="chapter" data-level="6.117" data-path="Ch06.html"><a href="Ch06.html#ch06.117"><i class="fa fa-check"></i><b>6.117</b> Edges_Bogs-Water_r1250</a></li>
<li class="chapter" data-level="6.118" data-path="Ch06.html"><a href="Ch06.html#ch06.118"><i class="fa fa-check"></i><b>6.118</b> Edges_Bogs-Water_r3000</a></li>
<li class="chapter" data-level="6.119" data-path="Ch06.html"><a href="Ch06.html#ch06.119"><i class="fa fa-check"></i><b>6.119</b> Edges_Bogs-Water_r10000</a></li>
<li class="chapter" data-level="6.120" data-path="Ch06.html"><a href="Ch06.html#ch06.120"><i class="fa fa-check"></i><b>6.120</b> Edges_Farmland-Builtup_cell</a></li>
<li class="chapter" data-level="6.121" data-path="Ch06.html"><a href="Ch06.html#ch06.121"><i class="fa fa-check"></i><b>6.121</b> Edges_Farmland-Builtup_r500</a></li>
<li class="chapter" data-level="6.122" data-path="Ch06.html"><a href="Ch06.html#ch06.122"><i class="fa fa-check"></i><b>6.122</b> Edges_Farmland-Builtup_r1250</a></li>
<li class="chapter" data-level="6.123" data-path="Ch06.html"><a href="Ch06.html#ch06.123"><i class="fa fa-check"></i><b>6.123</b> Edges_Farmland-Builtup_r3000</a></li>
<li class="chapter" data-level="6.124" data-path="Ch06.html"><a href="Ch06.html#ch06.124"><i class="fa fa-check"></i><b>6.124</b> Edges_Farmland-Builtup_r10000</a></li>
<li class="chapter" data-level="6.125" data-path="Ch06.html"><a href="Ch06.html#ch06.125"><i class="fa fa-check"></i><b>6.125</b> Edges_Trees-Builtup_cell</a></li>
<li class="chapter" data-level="6.126" data-path="Ch06.html"><a href="Ch06.html#ch06.126"><i class="fa fa-check"></i><b>6.126</b> Edges_Trees-Builtup_r500</a></li>
<li class="chapter" data-level="6.127" data-path="Ch06.html"><a href="Ch06.html#ch06.127"><i class="fa fa-check"></i><b>6.127</b> Edges_Trees-Builtup_r1250</a></li>
<li class="chapter" data-level="6.128" data-path="Ch06.html"><a href="Ch06.html#ch06.128"><i class="fa fa-check"></i><b>6.128</b> Edges_Trees-Builtup_r3000</a></li>
<li class="chapter" data-level="6.129" data-path="Ch06.html"><a href="Ch06.html#ch06.129"><i class="fa fa-check"></i><b>6.129</b> Edges_Trees-Builtup_r10000</a></li>
<li class="chapter" data-level="6.130" data-path="Ch06.html"><a href="Ch06.html#ch06.130"><i class="fa fa-check"></i><b>6.130</b> Edges_CropsFallow_cell</a></li>
<li class="chapter" data-level="6.131" data-path="Ch06.html"><a href="Ch06.html#ch06.131"><i class="fa fa-check"></i><b>6.131</b> Edges_CropsFallow_r500</a></li>
<li class="chapter" data-level="6.132" data-path="Ch06.html"><a href="Ch06.html#ch06.132"><i class="fa fa-check"></i><b>6.132</b> Edges_CropsFallow_r1250</a></li>
<li class="chapter" data-level="6.133" data-path="Ch06.html"><a href="Ch06.html#ch06.133"><i class="fa fa-check"></i><b>6.133</b> Edges_CropsFallow_r3000</a></li>
<li class="chapter" data-level="6.134" data-path="Ch06.html"><a href="Ch06.html#ch06.134"><i class="fa fa-check"></i><b>6.134</b> Edges_CropsFallow_r10000</a></li>
<li class="chapter" data-level="6.135" data-path="Ch06.html"><a href="Ch06.html#ch06.135"><i class="fa fa-check"></i><b>6.135</b> Edges_FarmlandShrubs-Trees_cell</a></li>
<li class="chapter" data-level="6.136" data-path="Ch06.html"><a href="Ch06.html#ch06.136"><i class="fa fa-check"></i><b>6.136</b> Edges_FarmlandShrubs-Trees_r500</a></li>
<li class="chapter" data-level="6.137" data-path="Ch06.html"><a href="Ch06.html#ch06.137"><i class="fa fa-check"></i><b>6.137</b> Edges_FarmlandShrubs-Trees_r1250</a></li>
<li class="chapter" data-level="6.138" data-path="Ch06.html"><a href="Ch06.html#ch06.138"><i class="fa fa-check"></i><b>6.138</b> Edges_FarmlandShrubs-Trees_r3000</a></li>
<li class="chapter" data-level="6.139" data-path="Ch06.html"><a href="Ch06.html#ch06.139"><i class="fa fa-check"></i><b>6.139</b> Edges_FarmlandShrubs-Trees_r10000</a></li>
<li class="chapter" data-level="6.140" data-path="Ch06.html"><a href="Ch06.html#ch06.140"><i class="fa fa-check"></i><b>6.140</b> Edges_Grasslands_cell</a></li>
<li class="chapter" data-level="6.141" data-path="Ch06.html"><a href="Ch06.html#ch06.141"><i class="fa fa-check"></i><b>6.141</b> Edges_Grasslands_r500</a></li>
<li class="chapter" data-level="6.142" data-path="Ch06.html"><a href="Ch06.html#ch06.142"><i class="fa fa-check"></i><b>6.142</b> Edges_Grasslands_r1250</a></li>
<li class="chapter" data-level="6.143" data-path="Ch06.html"><a href="Ch06.html#ch06.143"><i class="fa fa-check"></i><b>6.143</b> Edges_Grasslands_r3000</a></li>
<li class="chapter" data-level="6.144" data-path="Ch06.html"><a href="Ch06.html#ch06.144"><i class="fa fa-check"></i><b>6.144</b> Edges_Grasslands_r10000</a></li>
<li class="chapter" data-level="6.145" data-path="Ch06.html"><a href="Ch06.html#ch06.145"><i class="fa fa-check"></i><b>6.145</b> Edges_OldForests_cell</a></li>
<li class="chapter" data-level="6.146" data-path="Ch06.html"><a href="Ch06.html#ch06.146"><i class="fa fa-check"></i><b>6.146</b> Edges_OldForests_r500</a></li>
<li class="chapter" data-level="6.147" data-path="Ch06.html"><a href="Ch06.html#ch06.147"><i class="fa fa-check"></i><b>6.147</b> Edges_OldForests_r1250</a></li>
<li class="chapter" data-level="6.148" data-path="Ch06.html"><a href="Ch06.html#ch06.148"><i class="fa fa-check"></i><b>6.148</b> Edges_OldForests_r3000</a></li>
<li class="chapter" data-level="6.149" data-path="Ch06.html"><a href="Ch06.html#ch06.149"><i class="fa fa-check"></i><b>6.149</b> Edges_OldForests_r10000</a></li>
<li class="chapter" data-level="6.150" data-path="Ch06.html"><a href="Ch06.html#ch06.150"><i class="fa fa-check"></i><b>6.150</b> Edges_Roads_cell</a></li>
<li class="chapter" data-level="6.151" data-path="Ch06.html"><a href="Ch06.html#ch06.151"><i class="fa fa-check"></i><b>6.151</b> Edges_Roads_r500</a></li>
<li class="chapter" data-level="6.152" data-path="Ch06.html"><a href="Ch06.html#ch06.152"><i class="fa fa-check"></i><b>6.152</b> Edges_Roads_r1250</a></li>
<li class="chapter" data-level="6.153" data-path="Ch06.html"><a href="Ch06.html#ch06.153"><i class="fa fa-check"></i><b>6.153</b> Edges_Roads_r3000</a></li>
<li class="chapter" data-level="6.154" data-path="Ch06.html"><a href="Ch06.html#ch06.154"><i class="fa fa-check"></i><b>6.154</b> Edges_Roads_r10000</a></li>
<li class="chapter" data-level="6.155" data-path="Ch06.html"><a href="Ch06.html#ch06.155"><i class="fa fa-check"></i><b>6.155</b> Edges_Trees_cell</a></li>
<li class="chapter" data-level="6.156" data-path="Ch06.html"><a href="Ch06.html#ch06.156"><i class="fa fa-check"></i><b>6.156</b> Edges_Trees_r500</a></li>
<li class="chapter" data-level="6.157" data-path="Ch06.html"><a href="Ch06.html#ch06.157"><i class="fa fa-check"></i><b>6.157</b> Edges_Trees_r1250</a></li>
<li class="chapter" data-level="6.158" data-path="Ch06.html"><a href="Ch06.html#ch06.158"><i class="fa fa-check"></i><b>6.158</b> Edges_Trees_r3000</a></li>
<li class="chapter" data-level="6.159" data-path="Ch06.html"><a href="Ch06.html#ch06.159"><i class="fa fa-check"></i><b>6.159</b> Edges_Trees_r10000</a></li>
<li class="chapter" data-level="6.160" data-path="Ch06.html"><a href="Ch06.html#ch06.160"><i class="fa fa-check"></i><b>6.160</b> Edges_Water_cell</a></li>
<li class="chapter" data-level="6.161" data-path="Ch06.html"><a href="Ch06.html#ch06.161"><i class="fa fa-check"></i><b>6.161</b> Edges_Water_r500</a></li>
<li class="chapter" data-level="6.162" data-path="Ch06.html"><a href="Ch06.html#ch06.162"><i class="fa fa-check"></i><b>6.162</b> Edges_Water_r1250</a></li>
<li class="chapter" data-level="6.163" data-path="Ch06.html"><a href="Ch06.html#ch06.163"><i class="fa fa-check"></i><b>6.163</b> Edges_Water_r3000</a></li>
<li class="chapter" data-level="6.164" data-path="Ch06.html"><a href="Ch06.html#ch06.164"><i class="fa fa-check"></i><b>6.164</b> Edges_Water_r10000</a></li>
<li class="chapter" data-level="6.165" data-path="Ch06.html"><a href="Ch06.html#ch06.165"><i class="fa fa-check"></i><b>6.165</b> Edges_Water-Farmland_cell</a></li>
<li class="chapter" data-level="6.166" data-path="Ch06.html"><a href="Ch06.html#ch06.166"><i class="fa fa-check"></i><b>6.166</b> Edges_Water-Farmland_r500</a></li>
<li class="chapter" data-level="6.167" data-path="Ch06.html"><a href="Ch06.html#ch06.167"><i class="fa fa-check"></i><b>6.167</b> Edges_Water-Farmland_r1250</a></li>
<li class="chapter" data-level="6.168" data-path="Ch06.html"><a href="Ch06.html#ch06.168"><i class="fa fa-check"></i><b>6.168</b> Edges_Water-Farmland_r3000</a></li>
<li class="chapter" data-level="6.169" data-path="Ch06.html"><a href="Ch06.html#ch06.169"><i class="fa fa-check"></i><b>6.169</b> Edges_Water-Farmland_r10000</a></li>
<li class="chapter" data-level="6.170" data-path="Ch06.html"><a href="Ch06.html#ch06.170"><i class="fa fa-check"></i><b>6.170</b> Edges_Water-Grassland_cell</a></li>
<li class="chapter" data-level="6.171" data-path="Ch06.html"><a href="Ch06.html#ch06.171"><i class="fa fa-check"></i><b>6.171</b> Edges_Water-Grassland_r500</a></li>
<li class="chapter" data-level="6.172" data-path="Ch06.html"><a href="Ch06.html#ch06.172"><i class="fa fa-check"></i><b>6.172</b> Edges_Water-Grassland_r1250</a></li>
<li class="chapter" data-level="6.173" data-path="Ch06.html"><a href="Ch06.html#ch06.173"><i class="fa fa-check"></i><b>6.173</b> Edges_Water-Grassland_r3000</a></li>
<li class="chapter" data-level="6.174" data-path="Ch06.html"><a href="Ch06.html#ch06.174"><i class="fa fa-check"></i><b>6.174</b> Edges_Water-Grassland_r10000</a></li>
<li class="chapter" data-level="6.175" data-path="Ch06.html"><a href="Ch06.html#ch06.175"><i class="fa fa-check"></i><b>6.175</b> Edges_ReedSedgeRushBeds-Water_cell</a></li>
<li class="chapter" data-level="6.176" data-path="Ch06.html"><a href="Ch06.html#ch06.176"><i class="fa fa-check"></i><b>6.176</b> Edges_ReedSedgeRushBeds-Water_r500</a></li>
<li class="chapter" data-level="6.177" data-path="Ch06.html"><a href="Ch06.html#ch06.177"><i class="fa fa-check"></i><b>6.177</b> Edges_ReedSedgeRushBeds-Water_r1250</a></li>
<li class="chapter" data-level="6.178" data-path="Ch06.html"><a href="Ch06.html#ch06.178"><i class="fa fa-check"></i><b>6.178</b> Edges_ReedSedgeRushBeds-Water_r3000</a></li>
<li class="chapter" data-level="6.179" data-path="Ch06.html"><a href="Ch06.html#ch06.179"><i class="fa fa-check"></i><b>6.179</b> Edges_ReedSedgeRushBeds-Water_r10000</a></li>
<li class="chapter" data-level="6.180" data-path="Ch06.html"><a href="Ch06.html#ch06.180"><i class="fa fa-check"></i><b>6.180</b> FarmlandCrops_CropsAll_cell</a></li>
<li class="chapter" data-level="6.181" data-path="Ch06.html"><a href="Ch06.html#ch06.181"><i class="fa fa-check"></i><b>6.181</b> FarmlandCrops_CropsAll_r500</a></li>
<li class="chapter" data-level="6.182" data-path="Ch06.html"><a href="Ch06.html#ch06.182"><i class="fa fa-check"></i><b>6.182</b> FarmlandCrops_CropsAll_r1250</a></li>
<li class="chapter" data-level="6.183" data-path="Ch06.html"><a href="Ch06.html#ch06.183"><i class="fa fa-check"></i><b>6.183</b> FarmlandCrops_CropsAll_r3000</a></li>
<li class="chapter" data-level="6.184" data-path="Ch06.html"><a href="Ch06.html#ch06.184"><i class="fa fa-check"></i><b>6.184</b> FarmlandCrops_CropsAll_r10000</a></li>
<li class="chapter" data-level="6.185" data-path="Ch06.html"><a href="Ch06.html#ch06.185"><i class="fa fa-check"></i><b>6.185</b> FarmlandCrops_CropsHoed_cell</a></li>
<li class="chapter" data-level="6.186" data-path="Ch06.html"><a href="Ch06.html#ch06.186"><i class="fa fa-check"></i><b>6.186</b> FarmlandCrops_CropsHoed_r500</a></li>
<li class="chapter" data-level="6.187" data-path="Ch06.html"><a href="Ch06.html#ch06.187"><i class="fa fa-check"></i><b>6.187</b> FarmlandCrops_CropsHoed_r1250</a></li>
<li class="chapter" data-level="6.188" data-path="Ch06.html"><a href="Ch06.html#ch06.188"><i class="fa fa-check"></i><b>6.188</b> FarmlandCrops_CropsHoed_r3000</a></li>
<li class="chapter" data-level="6.189" data-path="Ch06.html"><a href="Ch06.html#ch06.189"><i class="fa fa-check"></i><b>6.189</b> FarmlandCrops_CropsHoed_r10000</a></li>
<li class="chapter" data-level="6.190" data-path="Ch06.html"><a href="Ch06.html#ch06.190"><i class="fa fa-check"></i><b>6.190</b> FarmlandCrops_CropsOther_cell</a></li>
<li class="chapter" data-level="6.191" data-path="Ch06.html"><a href="Ch06.html#ch06.191"><i class="fa fa-check"></i><b>6.191</b> FarmlandCrops_CropsOther_r500</a></li>
<li class="chapter" data-level="6.192" data-path="Ch06.html"><a href="Ch06.html#ch06.192"><i class="fa fa-check"></i><b>6.192</b> FarmlandCrops_CropsOther_r1250</a></li>
<li class="chapter" data-level="6.193" data-path="Ch06.html"><a href="Ch06.html#ch06.193"><i class="fa fa-check"></i><b>6.193</b> FarmlandCrops_CropsOther_r3000</a></li>
<li class="chapter" data-level="6.194" data-path="Ch06.html"><a href="Ch06.html#ch06.194"><i class="fa fa-check"></i><b>6.194</b> FarmlandCrops_CropsOther_r10000</a></li>
<li class="chapter" data-level="6.195" data-path="Ch06.html"><a href="Ch06.html#ch06.195"><i class="fa fa-check"></i><b>6.195</b> FarmlandCrops_CropsSpring_cell</a></li>
<li class="chapter" data-level="6.196" data-path="Ch06.html"><a href="Ch06.html#ch06.196"><i class="fa fa-check"></i><b>6.196</b> FarmlandCrops_CropsSpring_r500</a></li>
<li class="chapter" data-level="6.197" data-path="Ch06.html"><a href="Ch06.html#ch06.197"><i class="fa fa-check"></i><b>6.197</b> FarmlandCrops_CropsSpring_r1250</a></li>
<li class="chapter" data-level="6.198" data-path="Ch06.html"><a href="Ch06.html#ch06.198"><i class="fa fa-check"></i><b>6.198</b> FarmlandCrops_CropsSpring_r3000</a></li>
<li class="chapter" data-level="6.199" data-path="Ch06.html"><a href="Ch06.html#ch06.199"><i class="fa fa-check"></i><b>6.199</b> FarmlandCrops_CropsSpring_r10000</a></li>
<li class="chapter" data-level="6.200" data-path="Ch06.html"><a href="Ch06.html#ch06.200"><i class="fa fa-check"></i><b>6.200</b> FarmlandCrops_CropsWinter_cell</a></li>
<li class="chapter" data-level="6.201" data-path="Ch06.html"><a href="Ch06.html#ch06.201"><i class="fa fa-check"></i><b>6.201</b> FarmlandCrops_CropsWinter_r500</a></li>
<li class="chapter" data-level="6.202" data-path="Ch06.html"><a href="Ch06.html#ch06.202"><i class="fa fa-check"></i><b>6.202</b> FarmlandCrops_CropsWinter_r1250</a></li>
<li class="chapter" data-level="6.203" data-path="Ch06.html"><a href="Ch06.html#ch06.203"><i class="fa fa-check"></i><b>6.203</b> FarmlandCrops_CropsWinter_r3000</a></li>
<li class="chapter" data-level="6.204" data-path="Ch06.html"><a href="Ch06.html#ch06.204"><i class="fa fa-check"></i><b>6.204</b> FarmlandCrops_CropsWinter_r10000</a></li>
<li class="chapter" data-level="6.205" data-path="Ch06.html"><a href="Ch06.html#ch06.205"><i class="fa fa-check"></i><b>6.205</b> FarmlandCrops_RapeseedsSpring_cell</a></li>
<li class="chapter" data-level="6.206" data-path="Ch06.html"><a href="Ch06.html#ch06.206"><i class="fa fa-check"></i><b>6.206</b> FarmlandCrops_RapeseedsSpring_r500</a></li>
<li class="chapter" data-level="6.207" data-path="Ch06.html"><a href="Ch06.html#ch06.207"><i class="fa fa-check"></i><b>6.207</b> FarmlandCrops_RapeseedsSpring_r1250</a></li>
<li class="chapter" data-level="6.208" data-path="Ch06.html"><a href="Ch06.html#ch06.208"><i class="fa fa-check"></i><b>6.208</b> FarmlandCrops_RapeseedsSpring_r3000</a></li>
<li class="chapter" data-level="6.209" data-path="Ch06.html"><a href="Ch06.html#ch06.209"><i class="fa fa-check"></i><b>6.209</b> FarmlandCrops_RapeseedsSpring_r10000</a></li>
<li class="chapter" data-level="6.210" data-path="Ch06.html"><a href="Ch06.html#ch06.210"><i class="fa fa-check"></i><b>6.210</b> FarmlandCrops_RapeseedsWinter_cell</a></li>
<li class="chapter" data-level="6.211" data-path="Ch06.html"><a href="Ch06.html#ch06.211"><i class="fa fa-check"></i><b>6.211</b> FarmlandCrops_RapeseedsWinter_r500</a></li>
<li class="chapter" data-level="6.212" data-path="Ch06.html"><a href="Ch06.html#ch06.212"><i class="fa fa-check"></i><b>6.212</b> FarmlandCrops_RapeseedsWinter_r1250</a></li>
<li class="chapter" data-level="6.213" data-path="Ch06.html"><a href="Ch06.html#ch06.213"><i class="fa fa-check"></i><b>6.213</b> FarmlandCrops_RapeseedsWinter_r3000</a></li>
<li class="chapter" data-level="6.214" data-path="Ch06.html"><a href="Ch06.html#ch06.214"><i class="fa fa-check"></i><b>6.214</b> FarmlandCrops_RapeseedsWinter_r10000</a></li>
<li class="chapter" data-level="6.215" data-path="Ch06.html"><a href="Ch06.html#ch06.215"><i class="fa fa-check"></i><b>6.215</b> FarmlandGrassland_GrasslandsAbandoned_cell</a></li>
<li class="chapter" data-level="6.216" data-path="Ch06.html"><a href="Ch06.html#ch06.216"><i class="fa fa-check"></i><b>6.216</b> FarmlandGrassland_GrasslandsAbandoned_r500</a></li>
<li class="chapter" data-level="6.217" data-path="Ch06.html"><a href="Ch06.html#ch06.217"><i class="fa fa-check"></i><b>6.217</b> FarmlandGrassland_GrasslandsAbandoned_r1250</a></li>
<li class="chapter" data-level="6.218" data-path="Ch06.html"><a href="Ch06.html#ch06.218"><i class="fa fa-check"></i><b>6.218</b> FarmlandGrassland_GrasslandsAbandoned_r3000</a></li>
<li class="chapter" data-level="6.219" data-path="Ch06.html"><a href="Ch06.html#ch06.219"><i class="fa fa-check"></i><b>6.219</b> FarmlandGrassland_GrasslandsAbandoned_r10000</a></li>
<li class="chapter" data-level="6.220" data-path="Ch06.html"><a href="Ch06.html#ch06.220"><i class="fa fa-check"></i><b>6.220</b> FarmlandGrassland_GrasslandsAll_cell</a></li>
<li class="chapter" data-level="6.221" data-path="Ch06.html"><a href="Ch06.html#ch06.221"><i class="fa fa-check"></i><b>6.221</b> FarmlandGrassland_GrasslandsAll_r500</a></li>
<li class="chapter" data-level="6.222" data-path="Ch06.html"><a href="Ch06.html#ch06.222"><i class="fa fa-check"></i><b>6.222</b> FarmlandGrassland_GrasslandsAll_r1250</a></li>
<li class="chapter" data-level="6.223" data-path="Ch06.html"><a href="Ch06.html#ch06.223"><i class="fa fa-check"></i><b>6.223</b> FarmlandGrassland_GrasslandsAll_r3000</a></li>
<li class="chapter" data-level="6.224" data-path="Ch06.html"><a href="Ch06.html#ch06.224"><i class="fa fa-check"></i><b>6.224</b> FarmlandGrassland_GrasslandsAll_r10000</a></li>
<li class="chapter" data-level="6.225" data-path="Ch06.html"><a href="Ch06.html#ch06.225"><i class="fa fa-check"></i><b>6.225</b> FarmlandGrassland_GrasslandsPermanent_cell</a></li>
<li class="chapter" data-level="6.226" data-path="Ch06.html"><a href="Ch06.html#ch06.226"><i class="fa fa-check"></i><b>6.226</b> FarmlandGrassland_GrasslandsPermanent_r500</a></li>
<li class="chapter" data-level="6.227" data-path="Ch06.html"><a href="Ch06.html#ch06.227"><i class="fa fa-check"></i><b>6.227</b> FarmlandGrassland_GrasslandsPermanent_r1250</a></li>
<li class="chapter" data-level="6.228" data-path="Ch06.html"><a href="Ch06.html#ch06.228"><i class="fa fa-check"></i><b>6.228</b> FarmlandGrassland_GrasslandsPermanent_r3000</a></li>
<li class="chapter" data-level="6.229" data-path="Ch06.html"><a href="Ch06.html#ch06.229"><i class="fa fa-check"></i><b>6.229</b> FarmlandGrassland_GrasslandsPermanent_r10000</a></li>
<li class="chapter" data-level="6.230" data-path="Ch06.html"><a href="Ch06.html#ch06.230"><i class="fa fa-check"></i><b>6.230</b> FarmlandGrassland_GrasslandsTemporary_cell</a></li>
<li class="chapter" data-level="6.231" data-path="Ch06.html"><a href="Ch06.html#ch06.231"><i class="fa fa-check"></i><b>6.231</b> FarmlandGrassland_GrasslandsTemporary_r500</a></li>
<li class="chapter" data-level="6.232" data-path="Ch06.html"><a href="Ch06.html#ch06.232"><i class="fa fa-check"></i><b>6.232</b> FarmlandGrassland_GrasslandsTemporary_r1250</a></li>
<li class="chapter" data-level="6.233" data-path="Ch06.html"><a href="Ch06.html#ch06.233"><i class="fa fa-check"></i><b>6.233</b> FarmlandGrassland_GrasslandsTemporary_r3000</a></li>
<li class="chapter" data-level="6.234" data-path="Ch06.html"><a href="Ch06.html#ch06.234"><i class="fa fa-check"></i><b>6.234</b> FarmlandGrassland_GrasslandsTemporary_r10000</a></li>
<li class="chapter" data-level="6.235" data-path="Ch06.html"><a href="Ch06.html#ch06.235"><i class="fa fa-check"></i><b>6.235</b> FarmlandParcels_FieldsActive_cell</a></li>
<li class="chapter" data-level="6.236" data-path="Ch06.html"><a href="Ch06.html#ch06.236"><i class="fa fa-check"></i><b>6.236</b> FarmlandParcels_FieldsActive_r500</a></li>
<li class="chapter" data-level="6.237" data-path="Ch06.html"><a href="Ch06.html#ch06.237"><i class="fa fa-check"></i><b>6.237</b> FarmlandParcels_FieldsActive_r1250</a></li>
<li class="chapter" data-level="6.238" data-path="Ch06.html"><a href="Ch06.html#ch06.238"><i class="fa fa-check"></i><b>6.238</b> FarmlandParcels_FieldsActive_r3000</a></li>
<li class="chapter" data-level="6.239" data-path="Ch06.html"><a href="Ch06.html#ch06.239"><i class="fa fa-check"></i><b>6.239</b> FarmlandParcels_FieldsActive_r10000</a></li>
<li class="chapter" data-level="6.240" data-path="Ch06.html"><a href="Ch06.html#ch06.240"><i class="fa fa-check"></i><b>6.240</b> FarmlandPloughed_CropsFallow_cell</a></li>
<li class="chapter" data-level="6.241" data-path="Ch06.html"><a href="Ch06.html#ch06.241"><i class="fa fa-check"></i><b>6.241</b> FarmlandPloughed_CropsFallow_r500</a></li>
<li class="chapter" data-level="6.242" data-path="Ch06.html"><a href="Ch06.html#ch06.242"><i class="fa fa-check"></i><b>6.242</b> FarmlandPloughed_CropsFallow_r1250</a></li>
<li class="chapter" data-level="6.243" data-path="Ch06.html"><a href="Ch06.html#ch06.243"><i class="fa fa-check"></i><b>6.243</b> FarmlandPloughed_CropsFallow_r3000</a></li>
<li class="chapter" data-level="6.244" data-path="Ch06.html"><a href="Ch06.html#ch06.244"><i class="fa fa-check"></i><b>6.244</b> FarmlandPloughed_CropsFallow_r10000</a></li>
<li class="chapter" data-level="6.245" data-path="Ch06.html"><a href="Ch06.html#ch06.245"><i class="fa fa-check"></i><b>6.245</b> FarmlandPloughed_CropsFallowTempGrass_cell</a></li>
<li class="chapter" data-level="6.246" data-path="Ch06.html"><a href="Ch06.html#ch06.246"><i class="fa fa-check"></i><b>6.246</b> FarmlandPloughed_CropsFallowTempGrass_r500</a></li>
<li class="chapter" data-level="6.247" data-path="Ch06.html"><a href="Ch06.html#ch06.247"><i class="fa fa-check"></i><b>6.247</b> FarmlandPloughed_CropsFallowTempGrass_r1250</a></li>
<li class="chapter" data-level="6.248" data-path="Ch06.html"><a href="Ch06.html#ch06.248"><i class="fa fa-check"></i><b>6.248</b> FarmlandPloughed_CropsFallowTempGrass_r3000</a></li>
<li class="chapter" data-level="6.249" data-path="Ch06.html"><a href="Ch06.html#ch06.249"><i class="fa fa-check"></i><b>6.249</b> FarmlandPloughed_CropsFallowTempGrass_r10000</a></li>
<li class="chapter" data-level="6.250" data-path="Ch06.html"><a href="Ch06.html#ch06.250"><i class="fa fa-check"></i><b>6.250</b> FarmlandPloughed_Fallow_cell</a></li>
<li class="chapter" data-level="6.251" data-path="Ch06.html"><a href="Ch06.html#ch06.251"><i class="fa fa-check"></i><b>6.251</b> FarmlandPloughed_Fallow_r500</a></li>
<li class="chapter" data-level="6.252" data-path="Ch06.html"><a href="Ch06.html#ch06.252"><i class="fa fa-check"></i><b>6.252</b> FarmlandPloughed_Fallow_r1250</a></li>
<li class="chapter" data-level="6.253" data-path="Ch06.html"><a href="Ch06.html#ch06.253"><i class="fa fa-check"></i><b>6.253</b> FarmlandPloughed_Fallow_r3000</a></li>
<li class="chapter" data-level="6.254" data-path="Ch06.html"><a href="Ch06.html#ch06.254"><i class="fa fa-check"></i><b>6.254</b> FarmlandPloughed_Fallow_r10000</a></li>
<li class="chapter" data-level="6.255" data-path="Ch06.html"><a href="Ch06.html#ch06.255"><i class="fa fa-check"></i><b>6.255</b> FarmlandSubsidies_BiologicalSubsidies_cell</a></li>
<li class="chapter" data-level="6.256" data-path="Ch06.html"><a href="Ch06.html#ch06.256"><i class="fa fa-check"></i><b>6.256</b> FarmlandSubsidies_BiologicalSubsidies_r500</a></li>
<li class="chapter" data-level="6.257" data-path="Ch06.html"><a href="Ch06.html#ch06.257"><i class="fa fa-check"></i><b>6.257</b> FarmlandSubsidies_BiologicalSubsidies_r1250</a></li>
<li class="chapter" data-level="6.258" data-path="Ch06.html"><a href="Ch06.html#ch06.258"><i class="fa fa-check"></i><b>6.258</b> FarmlandSubsidies_BiologicalSubsidies_r3000</a></li>
<li class="chapter" data-level="6.259" data-path="Ch06.html"><a href="Ch06.html#ch06.259"><i class="fa fa-check"></i><b>6.259</b> FarmlandSubsidies_BiologicalSubsidies_r10000</a></li>
<li class="chapter" data-level="6.260" data-path="Ch06.html"><a href="Ch06.html#ch06.260"><i class="fa fa-check"></i><b>6.260</b> FarmlandTrees_PermanentCrops_cell</a></li>
<li class="chapter" data-level="6.261" data-path="Ch06.html"><a href="Ch06.html#ch06.261"><i class="fa fa-check"></i><b>6.261</b> FarmlandTrees_PermanentCrops_r500</a></li>
<li class="chapter" data-level="6.262" data-path="Ch06.html"><a href="Ch06.html#ch06.262"><i class="fa fa-check"></i><b>6.262</b> FarmlandTrees_PermanentCrops_r1250</a></li>
<li class="chapter" data-level="6.263" data-path="Ch06.html"><a href="Ch06.html#ch06.263"><i class="fa fa-check"></i><b>6.263</b> FarmlandTrees_PermanentCrops_r3000</a></li>
<li class="chapter" data-level="6.264" data-path="Ch06.html"><a href="Ch06.html#ch06.264"><i class="fa fa-check"></i><b>6.264</b> FarmlandTrees_PermanentCrops_r10000</a></li>
<li class="chapter" data-level="6.265" data-path="Ch06.html"><a href="Ch06.html#ch06.265"><i class="fa fa-check"></i><b>6.265</b> FarmlandTrees_ShortRotationCoppice_cell</a></li>
<li class="chapter" data-level="6.266" data-path="Ch06.html"><a href="Ch06.html#ch06.266"><i class="fa fa-check"></i><b>6.266</b> FarmlandTrees_ShortRotationCoppice_r500</a></li>
<li class="chapter" data-level="6.267" data-path="Ch06.html"><a href="Ch06.html#ch06.267"><i class="fa fa-check"></i><b>6.267</b> FarmlandTrees_ShortRotationCoppice_r1250</a></li>
<li class="chapter" data-level="6.268" data-path="Ch06.html"><a href="Ch06.html#ch06.268"><i class="fa fa-check"></i><b>6.268</b> FarmlandTrees_ShortRotationCoppice_r3000</a></li>
<li class="chapter" data-level="6.269" data-path="Ch06.html"><a href="Ch06.html#ch06.269"><i class="fa fa-check"></i><b>6.269</b> FarmlandTrees_ShortRotationCoppice_r10000</a></li>
<li class="chapter" data-level="6.270" data-path="Ch06.html"><a href="Ch06.html#ch06.270"><i class="fa fa-check"></i><b>6.270</b> ForestsAge_ClearcutsLowStands_cell</a></li>
<li class="chapter" data-level="6.271" data-path="Ch06.html"><a href="Ch06.html#ch06.271"><i class="fa fa-check"></i><b>6.271</b> ForestsAge_ClearcutsLowStands_r500</a></li>
<li class="chapter" data-level="6.272" data-path="Ch06.html"><a href="Ch06.html#ch06.272"><i class="fa fa-check"></i><b>6.272</b> ForestsAge_ClearcutsLowStands_r1250</a></li>
<li class="chapter" data-level="6.273" data-path="Ch06.html"><a href="Ch06.html#ch06.273"><i class="fa fa-check"></i><b>6.273</b> ForestsAge_ClearcutsLowStands_r3000</a></li>
<li class="chapter" data-level="6.274" data-path="Ch06.html"><a href="Ch06.html#ch06.274"><i class="fa fa-check"></i><b>6.274</b> ForestsAge_ClearcutsLowStands_r10000</a></li>
<li class="chapter" data-level="6.275" data-path="Ch06.html"><a href="Ch06.html#ch06.275"><i class="fa fa-check"></i><b>6.275</b> ForestsAge_Middle_cell</a></li>
<li class="chapter" data-level="6.276" data-path="Ch06.html"><a href="Ch06.html#ch06.276"><i class="fa fa-check"></i><b>6.276</b> ForestsAge_Middle_r500</a></li>
<li class="chapter" data-level="6.277" data-path="Ch06.html"><a href="Ch06.html#ch06.277"><i class="fa fa-check"></i><b>6.277</b> ForestsAge_Middle_r1250</a></li>
<li class="chapter" data-level="6.278" data-path="Ch06.html"><a href="Ch06.html#ch06.278"><i class="fa fa-check"></i><b>6.278</b> ForestsAge_Middle_r3000</a></li>
<li class="chapter" data-level="6.279" data-path="Ch06.html"><a href="Ch06.html#ch06.279"><i class="fa fa-check"></i><b>6.279</b> ForestsAge_Middle_r10000</a></li>
<li class="chapter" data-level="6.280" data-path="Ch06.html"><a href="Ch06.html#ch06.280"><i class="fa fa-check"></i><b>6.280</b> ForestsAge_Old_cell</a></li>
<li class="chapter" data-level="6.281" data-path="Ch06.html"><a href="Ch06.html#ch06.281"><i class="fa fa-check"></i><b>6.281</b> ForestsAge_Old_r500</a></li>
<li class="chapter" data-level="6.282" data-path="Ch06.html"><a href="Ch06.html#ch06.282"><i class="fa fa-check"></i><b>6.282</b> ForestsAge_Old_r1250</a></li>
<li class="chapter" data-level="6.283" data-path="Ch06.html"><a href="Ch06.html#ch06.283"><i class="fa fa-check"></i><b>6.283</b> ForestsAge_Old_r3000</a></li>
<li class="chapter" data-level="6.284" data-path="Ch06.html"><a href="Ch06.html#ch06.284"><i class="fa fa-check"></i><b>6.284</b> ForestsAge_Old_r10000</a></li>
<li class="chapter" data-level="6.285" data-path="Ch06.html"><a href="Ch06.html#ch06.285"><i class="fa fa-check"></i><b>6.285</b> ForestsAge_YoungTallStandsShrubs_cell</a></li>
<li class="chapter" data-level="6.286" data-path="Ch06.html"><a href="Ch06.html#ch06.286"><i class="fa fa-check"></i><b>6.286</b> ForestsAge_YoungTallStandsShrubs_r500</a></li>
<li class="chapter" data-level="6.287" data-path="Ch06.html"><a href="Ch06.html#ch06.287"><i class="fa fa-check"></i><b>6.287</b> ForestsAge_YoungTallStandsShrubs_r1250</a></li>
<li class="chapter" data-level="6.288" data-path="Ch06.html"><a href="Ch06.html#ch06.288"><i class="fa fa-check"></i><b>6.288</b> ForestsAge_YoungTallStandsShrubs_r3000</a></li>
<li class="chapter" data-level="6.289" data-path="Ch06.html"><a href="Ch06.html#ch06.289"><i class="fa fa-check"></i><b>6.289</b> ForestsAge_YoungTallStandsShrubs_r10000</a></li>
<li class="chapter" data-level="6.290" data-path="Ch06.html"><a href="Ch06.html#ch06.290"><i class="fa fa-check"></i><b>6.290</b> ForestsQuant_AgeProp-average_cell</a></li>
<li class="chapter" data-level="6.291" data-path="Ch06.html"><a href="Ch06.html#ch06.291"><i class="fa fa-check"></i><b>6.291</b> ForestsQuant_DominantDiameter-max_cell</a></li>
<li class="chapter" data-level="6.292" data-path="Ch06.html"><a href="Ch06.html#ch06.292"><i class="fa fa-check"></i><b>6.292</b> ForestsQuant_LargestDiameter-max_cell</a></li>
<li class="chapter" data-level="6.293" data-path="Ch06.html"><a href="Ch06.html#ch06.293"><i class="fa fa-check"></i><b>6.293</b> ForestsQuant_TimeSinceDisturbance-average_cell</a></li>
<li class="chapter" data-level="6.294" data-path="Ch06.html"><a href="Ch06.html#ch06.294"><i class="fa fa-check"></i><b>6.294</b> ForestsQuant_VolumeAspen-sum_cell</a></li>
<li class="chapter" data-level="6.295" data-path="Ch06.html"><a href="Ch06.html#ch06.295"><i class="fa fa-check"></i><b>6.295</b> ForestsQuant_VolumeBirch-sum_cell</a></li>
<li class="chapter" data-level="6.296" data-path="Ch06.html"><a href="Ch06.html#ch06.296"><i class="fa fa-check"></i><b>6.296</b> ForestsQuant_VolumeBlackAlder-sum_cell</a></li>
<li class="chapter" data-level="6.297" data-path="Ch06.html"><a href="Ch06.html#ch06.297"><i class="fa fa-check"></i><b>6.297</b> ForestsQuant_VolumeBorealDeciduousOther-sum_cell</a></li>
<li class="chapter" data-level="6.298" data-path="Ch06.html"><a href="Ch06.html#ch06.298"><i class="fa fa-check"></i><b>6.298</b> ForestsQuant_VolumeBorealDeciduousTotal-sum_cell</a></li>
<li class="chapter" data-level="6.299" data-path="Ch06.html"><a href="Ch06.html#ch06.299"><i class="fa fa-check"></i><b>6.299</b> ForestsQuant_VolumeConiferous-sum_cell</a></li>
<li class="chapter" data-level="6.300" data-path="Ch06.html"><a href="Ch06.html#ch06.300"><i class="fa fa-check"></i><b>6.300</b> ForestsQuant_VolumeOak-sum_cell</a></li>
<li class="chapter" data-level="6.301" data-path="Ch06.html"><a href="Ch06.html#ch06.301"><i class="fa fa-check"></i><b>6.301</b> ForestsQuant_VolumeOakMaple-sum_cell</a></li>
<li class="chapter" data-level="6.302" data-path="Ch06.html"><a href="Ch06.html#ch06.302"><i class="fa fa-check"></i><b>6.302</b> ForestsQuant_VolumePine-sum_cell</a></li>
<li class="chapter" data-level="6.303" data-path="Ch06.html"><a href="Ch06.html#ch06.303"><i class="fa fa-check"></i><b>6.303</b> ForestsQuant_VolumeSpruce-sum_cell</a></li>
<li class="chapter" data-level="6.304" data-path="Ch06.html"><a href="Ch06.html#ch06.304"><i class="fa fa-check"></i><b>6.304</b> ForestsQuant_VolumeTemperateDeciduousTotal-sum_cell</a></li>
<li class="chapter" data-level="6.305" data-path="Ch06.html"><a href="Ch06.html#ch06.305"><i class="fa fa-check"></i><b>6.305</b> ForestsQuant_VolumeTemperateWithoutOak-sum_cell</a></li>
<li class="chapter" data-level="6.306" data-path="Ch06.html"><a href="Ch06.html#ch06.306"><i class="fa fa-check"></i><b>6.306</b> ForestsQuant_VolumeTemperateWithoutOakMaple-sum_cell</a></li>
<li class="chapter" data-level="6.307" data-path="Ch06.html"><a href="Ch06.html#ch06.307"><i class="fa fa-check"></i><b>6.307</b> ForestsQuant_VolumeTotal-sum_cell</a></li>
<li class="chapter" data-level="6.308" data-path="Ch06.html"><a href="Ch06.html#ch06.308"><i class="fa fa-check"></i><b>6.308</b> ForestsSoil_EutrophicDrained_cell</a></li>
<li class="chapter" data-level="6.309" data-path="Ch06.html"><a href="Ch06.html#ch06.309"><i class="fa fa-check"></i><b>6.309</b> ForestsSoil_EutrophicDrained_r500</a></li>
<li class="chapter" data-level="6.310" data-path="Ch06.html"><a href="Ch06.html#ch06.310"><i class="fa fa-check"></i><b>6.310</b> ForestsSoil_EutrophicDrained_r1250</a></li>
<li class="chapter" data-level="6.311" data-path="Ch06.html"><a href="Ch06.html#ch06.311"><i class="fa fa-check"></i><b>6.311</b> ForestsSoil_EutrophicDrained_r3000</a></li>
<li class="chapter" data-level="6.312" data-path="Ch06.html"><a href="Ch06.html#ch06.312"><i class="fa fa-check"></i><b>6.312</b> ForestsSoil_EutrophicDrained_r10000</a></li>
<li class="chapter" data-level="6.313" data-path="Ch06.html"><a href="Ch06.html#ch06.313"><i class="fa fa-check"></i><b>6.313</b> ForestsSoil_EutrophicMineral_cell</a></li>
<li class="chapter" data-level="6.314" data-path="Ch06.html"><a href="Ch06.html#ch06.314"><i class="fa fa-check"></i><b>6.314</b> ForestsSoil_EutrophicMineral_r500</a></li>
<li class="chapter" data-level="6.315" data-path="Ch06.html"><a href="Ch06.html#ch06.315"><i class="fa fa-check"></i><b>6.315</b> ForestsSoil_EutrophicMineral_r1250</a></li>
<li class="chapter" data-level="6.316" data-path="Ch06.html"><a href="Ch06.html#ch06.316"><i class="fa fa-check"></i><b>6.316</b> ForestsSoil_EutrophicMineral_r3000</a></li>
<li class="chapter" data-level="6.317" data-path="Ch06.html"><a href="Ch06.html#ch06.317"><i class="fa fa-check"></i><b>6.317</b> ForestsSoil_EutrophicMineral_r10000</a></li>
<li class="chapter" data-level="6.318" data-path="Ch06.html"><a href="Ch06.html#ch06.318"><i class="fa fa-check"></i><b>6.318</b> ForestsSoil_EutrophicOrganic_cell</a></li>
<li class="chapter" data-level="6.319" data-path="Ch06.html"><a href="Ch06.html#ch06.319"><i class="fa fa-check"></i><b>6.319</b> ForestsSoil_EutrophicOrganic_r500</a></li>
<li class="chapter" data-level="6.320" data-path="Ch06.html"><a href="Ch06.html#ch06.320"><i class="fa fa-check"></i><b>6.320</b> ForestsSoil_EutrophicOrganic_r1250</a></li>
<li class="chapter" data-level="6.321" data-path="Ch06.html"><a href="Ch06.html#ch06.321"><i class="fa fa-check"></i><b>6.321</b> ForestsSoil_EutrophicOrganic_r3000</a></li>
<li class="chapter" data-level="6.322" data-path="Ch06.html"><a href="Ch06.html#ch06.322"><i class="fa fa-check"></i><b>6.322</b> ForestsSoil_EutrophicOrganic_r10000</a></li>
<li class="chapter" data-level="6.323" data-path="Ch06.html"><a href="Ch06.html#ch06.323"><i class="fa fa-check"></i><b>6.323</b> ForestsSoil_MesotrophicMineral_cell</a></li>
<li class="chapter" data-level="6.324" data-path="Ch06.html"><a href="Ch06.html#ch06.324"><i class="fa fa-check"></i><b>6.324</b> ForestsSoil_MesotrophicMineral_r500</a></li>
<li class="chapter" data-level="6.325" data-path="Ch06.html"><a href="Ch06.html#ch06.325"><i class="fa fa-check"></i><b>6.325</b> ForestsSoil_MesotrophicMineral_r1250</a></li>
<li class="chapter" data-level="6.326" data-path="Ch06.html"><a href="Ch06.html#ch06.326"><i class="fa fa-check"></i><b>6.326</b> ForestsSoil_MesotrophicMineral_r3000</a></li>
<li class="chapter" data-level="6.327" data-path="Ch06.html"><a href="Ch06.html#ch06.327"><i class="fa fa-check"></i><b>6.327</b> ForestsSoil_MesotrophicMineral_r10000</a></li>
<li class="chapter" data-level="6.328" data-path="Ch06.html"><a href="Ch06.html#ch06.328"><i class="fa fa-check"></i><b>6.328</b> ForestsSoil_OligotrophicDrained_cell</a></li>
<li class="chapter" data-level="6.329" data-path="Ch06.html"><a href="Ch06.html#ch06.329"><i class="fa fa-check"></i><b>6.329</b> ForestsSoil_OligotrophicDrained_r500</a></li>
<li class="chapter" data-level="6.330" data-path="Ch06.html"><a href="Ch06.html#ch06.330"><i class="fa fa-check"></i><b>6.330</b> ForestsSoil_OligotrophicDrained_r1250</a></li>
<li class="chapter" data-level="6.331" data-path="Ch06.html"><a href="Ch06.html#ch06.331"><i class="fa fa-check"></i><b>6.331</b> ForestsSoil_OligotrophicDrained_r3000</a></li>
<li class="chapter" data-level="6.332" data-path="Ch06.html"><a href="Ch06.html#ch06.332"><i class="fa fa-check"></i><b>6.332</b> ForestsSoil_OligotrophicDrained_r10000</a></li>
<li class="chapter" data-level="6.333" data-path="Ch06.html"><a href="Ch06.html#ch06.333"><i class="fa fa-check"></i><b>6.333</b> ForestsSoil_OligotrophicMineral_cell</a></li>
<li class="chapter" data-level="6.334" data-path="Ch06.html"><a href="Ch06.html#ch06.334"><i class="fa fa-check"></i><b>6.334</b> ForestsSoil_OligotrophicMineral_r500</a></li>
<li class="chapter" data-level="6.335" data-path="Ch06.html"><a href="Ch06.html#ch06.335"><i class="fa fa-check"></i><b>6.335</b> ForestsSoil_OligotrophicMineral_r1250</a></li>
<li class="chapter" data-level="6.336" data-path="Ch06.html"><a href="Ch06.html#ch06.336"><i class="fa fa-check"></i><b>6.336</b> ForestsSoil_OligotrophicMineral_r3000</a></li>
<li class="chapter" data-level="6.337" data-path="Ch06.html"><a href="Ch06.html#ch06.337"><i class="fa fa-check"></i><b>6.337</b> ForestsSoil_OligotrophicMineral_r10000</a></li>
<li class="chapter" data-level="6.338" data-path="Ch06.html"><a href="Ch06.html#ch06.338"><i class="fa fa-check"></i><b>6.338</b> ForestsSoil_OligotrophicOrganic_cell</a></li>
<li class="chapter" data-level="6.339" data-path="Ch06.html"><a href="Ch06.html#ch06.339"><i class="fa fa-check"></i><b>6.339</b> ForestsSoil_OligotrophicOrganic_r500</a></li>
<li class="chapter" data-level="6.340" data-path="Ch06.html"><a href="Ch06.html#ch06.340"><i class="fa fa-check"></i><b>6.340</b> ForestsSoil_OligotrophicOrganic_r1250</a></li>
<li class="chapter" data-level="6.341" data-path="Ch06.html"><a href="Ch06.html#ch06.341"><i class="fa fa-check"></i><b>6.341</b> ForestsSoil_OligotrophicOrganic_r3000</a></li>
<li class="chapter" data-level="6.342" data-path="Ch06.html"><a href="Ch06.html#ch06.342"><i class="fa fa-check"></i><b>6.342</b> ForestsSoil_OligotrophicOrganic_r10000</a></li>
<li class="chapter" data-level="6.343" data-path="Ch06.html"><a href="Ch06.html#ch06.343"><i class="fa fa-check"></i><b>6.343</b> ForestsTreesAge_BorealDeciduousOld_cell</a></li>
<li class="chapter" data-level="6.344" data-path="Ch06.html"><a href="Ch06.html#ch06.344"><i class="fa fa-check"></i><b>6.344</b> ForestsTreesAge_BorealDeciduousOld_r500</a></li>
<li class="chapter" data-level="6.345" data-path="Ch06.html"><a href="Ch06.html#ch06.345"><i class="fa fa-check"></i><b>6.345</b> ForestsTreesAge_BorealDeciduousOld_r1250</a></li>
<li class="chapter" data-level="6.346" data-path="Ch06.html"><a href="Ch06.html#ch06.346"><i class="fa fa-check"></i><b>6.346</b> ForestsTreesAge_BorealDeciduousOld_r3000</a></li>
<li class="chapter" data-level="6.347" data-path="Ch06.html"><a href="Ch06.html#ch06.347"><i class="fa fa-check"></i><b>6.347</b> ForestsTreesAge_BorealDeciduousOld_r10000</a></li>
<li class="chapter" data-level="6.348" data-path="Ch06.html"><a href="Ch06.html#ch06.348"><i class="fa fa-check"></i><b>6.348</b> ForestsTreesAge_BorealDeciduousYoung_cell</a></li>
<li class="chapter" data-level="6.349" data-path="Ch06.html"><a href="Ch06.html#ch06.349"><i class="fa fa-check"></i><b>6.349</b> ForestsTreesAge_BorealDeciduousYoung_r500</a></li>
<li class="chapter" data-level="6.350" data-path="Ch06.html"><a href="Ch06.html#ch06.350"><i class="fa fa-check"></i><b>6.350</b> ForestsTreesAge_BorealDeciduousYoung_r1250</a></li>
<li class="chapter" data-level="6.351" data-path="Ch06.html"><a href="Ch06.html#ch06.351"><i class="fa fa-check"></i><b>6.351</b> ForestsTreesAge_BorealDeciduousYoung_r3000</a></li>
<li class="chapter" data-level="6.352" data-path="Ch06.html"><a href="Ch06.html#ch06.352"><i class="fa fa-check"></i><b>6.352</b> ForestsTreesAge_BorealDeciduousYoung_r10000</a></li>
<li class="chapter" data-level="6.353" data-path="Ch06.html"><a href="Ch06.html#ch06.353"><i class="fa fa-check"></i><b>6.353</b> ForestsTreesAge_ConiferousOld_cell</a></li>
<li class="chapter" data-level="6.354" data-path="Ch06.html"><a href="Ch06.html#ch06.354"><i class="fa fa-check"></i><b>6.354</b> ForestsTreesAge_ConiferousOld_r500</a></li>
<li class="chapter" data-level="6.355" data-path="Ch06.html"><a href="Ch06.html#ch06.355"><i class="fa fa-check"></i><b>6.355</b> ForestsTreesAge_ConiferousOld_r1250</a></li>
<li class="chapter" data-level="6.356" data-path="Ch06.html"><a href="Ch06.html#ch06.356"><i class="fa fa-check"></i><b>6.356</b> ForestsTreesAge_ConiferousOld_r3000</a></li>
<li class="chapter" data-level="6.357" data-path="Ch06.html"><a href="Ch06.html#ch06.357"><i class="fa fa-check"></i><b>6.357</b> ForestsTreesAge_ConiferousOld_r10000</a></li>
<li class="chapter" data-level="6.358" data-path="Ch06.html"><a href="Ch06.html#ch06.358"><i class="fa fa-check"></i><b>6.358</b> ForestsTreesAge_ConiferousYoung_cell</a></li>
<li class="chapter" data-level="6.359" data-path="Ch06.html"><a href="Ch06.html#ch06.359"><i class="fa fa-check"></i><b>6.359</b> ForestsTreesAge_ConiferousYoung_r500</a></li>
<li class="chapter" data-level="6.360" data-path="Ch06.html"><a href="Ch06.html#ch06.360"><i class="fa fa-check"></i><b>6.360</b> ForestsTreesAge_ConiferousYoung_r1250</a></li>
<li class="chapter" data-level="6.361" data-path="Ch06.html"><a href="Ch06.html#ch06.361"><i class="fa fa-check"></i><b>6.361</b> ForestsTreesAge_ConiferousYoung_r3000</a></li>
<li class="chapter" data-level="6.362" data-path="Ch06.html"><a href="Ch06.html#ch06.362"><i class="fa fa-check"></i><b>6.362</b> ForestsTreesAge_ConiferousYoung_r10000</a></li>
<li class="chapter" data-level="6.363" data-path="Ch06.html"><a href="Ch06.html#ch06.363"><i class="fa fa-check"></i><b>6.363</b> ForestsTreesAge_MixedOld_cell</a></li>
<li class="chapter" data-level="6.364" data-path="Ch06.html"><a href="Ch06.html#ch06.364"><i class="fa fa-check"></i><b>6.364</b> ForestsTreesAge_MixedOld_r500</a></li>
<li class="chapter" data-level="6.365" data-path="Ch06.html"><a href="Ch06.html#ch06.365"><i class="fa fa-check"></i><b>6.365</b> ForestsTreesAge_MixedOld_r1250</a></li>
<li class="chapter" data-level="6.366" data-path="Ch06.html"><a href="Ch06.html#ch06.366"><i class="fa fa-check"></i><b>6.366</b> ForestsTreesAge_MixedOld_r3000</a></li>
<li class="chapter" data-level="6.367" data-path="Ch06.html"><a href="Ch06.html#ch06.367"><i class="fa fa-check"></i><b>6.367</b> ForestsTreesAge_MixedOld_r10000</a></li>
<li class="chapter" data-level="6.368" data-path="Ch06.html"><a href="Ch06.html#ch06.368"><i class="fa fa-check"></i><b>6.368</b> ForestsTreesAge_MixedYoung_cell</a></li>
<li class="chapter" data-level="6.369" data-path="Ch06.html"><a href="Ch06.html#ch06.369"><i class="fa fa-check"></i><b>6.369</b> ForestsTreesAge_MixedYoung_r500</a></li>
<li class="chapter" data-level="6.370" data-path="Ch06.html"><a href="Ch06.html#ch06.370"><i class="fa fa-check"></i><b>6.370</b> ForestsTreesAge_MixedYoung_r1250</a></li>
<li class="chapter" data-level="6.371" data-path="Ch06.html"><a href="Ch06.html#ch06.371"><i class="fa fa-check"></i><b>6.371</b> ForestsTreesAge_MixedYoung_r3000</a></li>
<li class="chapter" data-level="6.372" data-path="Ch06.html"><a href="Ch06.html#ch06.372"><i class="fa fa-check"></i><b>6.372</b> ForestsTreesAge_MixedYoung_r10000</a></li>
<li class="chapter" data-level="6.373" data-path="Ch06.html"><a href="Ch06.html#ch06.373"><i class="fa fa-check"></i><b>6.373</b> ForestsTreesAge_TemperateDeciduousOld_cell</a></li>
<li class="chapter" data-level="6.374" data-path="Ch06.html"><a href="Ch06.html#ch06.374"><i class="fa fa-check"></i><b>6.374</b> ForestsTreesAge_TemperateDeciduousOld_r500</a></li>
<li class="chapter" data-level="6.375" data-path="Ch06.html"><a href="Ch06.html#ch06.375"><i class="fa fa-check"></i><b>6.375</b> ForestsTreesAge_TemperateDeciduousOld_r1250</a></li>
<li class="chapter" data-level="6.376" data-path="Ch06.html"><a href="Ch06.html#ch06.376"><i class="fa fa-check"></i><b>6.376</b> ForestsTreesAge_TemperateDeciduousOld_r3000</a></li>
<li class="chapter" data-level="6.377" data-path="Ch06.html"><a href="Ch06.html#ch06.377"><i class="fa fa-check"></i><b>6.377</b> ForestsTreesAge_TemperateDeciduousOld_r10000</a></li>
<li class="chapter" data-level="6.378" data-path="Ch06.html"><a href="Ch06.html#ch06.378"><i class="fa fa-check"></i><b>6.378</b> ForestsTreesAge_TemperateDeciduousYoung_cell</a></li>
<li class="chapter" data-level="6.379" data-path="Ch06.html"><a href="Ch06.html#ch06.379"><i class="fa fa-check"></i><b>6.379</b> ForestsTreesAge_TemperateDeciduousYoung_r500</a></li>
<li class="chapter" data-level="6.380" data-path="Ch06.html"><a href="Ch06.html#ch06.380"><i class="fa fa-check"></i><b>6.380</b> ForestsTreesAge_TemperateDeciduousYoung_r1250</a></li>
<li class="chapter" data-level="6.381" data-path="Ch06.html"><a href="Ch06.html#ch06.381"><i class="fa fa-check"></i><b>6.381</b> ForestsTreesAge_TemperateDeciduousYoung_r3000</a></li>
<li class="chapter" data-level="6.382" data-path="Ch06.html"><a href="Ch06.html#ch06.382"><i class="fa fa-check"></i><b>6.382</b> ForestsTreesAge_TemperateDeciduousYoung_r10000</a></li>
<li class="chapter" data-level="6.383" data-path="Ch06.html"><a href="Ch06.html#ch06.383"><i class="fa fa-check"></i><b>6.383</b> ForestsTrees_BorealDeciduous_cell</a></li>
<li class="chapter" data-level="6.384" data-path="Ch06.html"><a href="Ch06.html#ch06.384"><i class="fa fa-check"></i><b>6.384</b> ForestsTrees_BorealDeciduous_r500</a></li>
<li class="chapter" data-level="6.385" data-path="Ch06.html"><a href="Ch06.html#ch06.385"><i class="fa fa-check"></i><b>6.385</b> ForestsTrees_BorealDeciduous_r1250</a></li>
<li class="chapter" data-level="6.386" data-path="Ch06.html"><a href="Ch06.html#ch06.386"><i class="fa fa-check"></i><b>6.386</b> ForestsTrees_BorealDeciduous_r3000</a></li>
<li class="chapter" data-level="6.387" data-path="Ch06.html"><a href="Ch06.html#ch06.387"><i class="fa fa-check"></i><b>6.387</b> ForestsTrees_BorealDeciduous_r10000</a></li>
<li class="chapter" data-level="6.388" data-path="Ch06.html"><a href="Ch06.html#ch06.388"><i class="fa fa-check"></i><b>6.388</b> ForestsTrees_Coniferous_cell</a></li>
<li class="chapter" data-level="6.389" data-path="Ch06.html"><a href="Ch06.html#ch06.389"><i class="fa fa-check"></i><b>6.389</b> ForestsTrees_Coniferous_r500</a></li>
<li class="chapter" data-level="6.390" data-path="Ch06.html"><a href="Ch06.html#ch06.390"><i class="fa fa-check"></i><b>6.390</b> ForestsTrees_Coniferous_r1250</a></li>
<li class="chapter" data-level="6.391" data-path="Ch06.html"><a href="Ch06.html#ch06.391"><i class="fa fa-check"></i><b>6.391</b> ForestsTrees_Coniferous_r3000</a></li>
<li class="chapter" data-level="6.392" data-path="Ch06.html"><a href="Ch06.html#ch06.392"><i class="fa fa-check"></i><b>6.392</b> ForestsTrees_Coniferous_r10000</a></li>
<li class="chapter" data-level="6.393" data-path="Ch06.html"><a href="Ch06.html#ch06.393"><i class="fa fa-check"></i><b>6.393</b> ForestsTrees_Mixed_cell</a></li>
<li class="chapter" data-level="6.394" data-path="Ch06.html"><a href="Ch06.html#ch06.394"><i class="fa fa-check"></i><b>6.394</b> ForestsTrees_Mixed_r500</a></li>
<li class="chapter" data-level="6.395" data-path="Ch06.html"><a href="Ch06.html#ch06.395"><i class="fa fa-check"></i><b>6.395</b> ForestsTrees_Mixed_r1250</a></li>
<li class="chapter" data-level="6.396" data-path="Ch06.html"><a href="Ch06.html#ch06.396"><i class="fa fa-check"></i><b>6.396</b> ForestsTrees_Mixed_r3000</a></li>
<li class="chapter" data-level="6.397" data-path="Ch06.html"><a href="Ch06.html#ch06.397"><i class="fa fa-check"></i><b>6.397</b> ForestsTrees_Mixed_r10000</a></li>
<li class="chapter" data-level="6.398" data-path="Ch06.html"><a href="Ch06.html#ch06.398"><i class="fa fa-check"></i><b>6.398</b> ForestsTrees_TemperateDeciduous_cell</a></li>
<li class="chapter" data-level="6.399" data-path="Ch06.html"><a href="Ch06.html#ch06.399"><i class="fa fa-check"></i><b>6.399</b> ForestsTrees_TemperateDeciduous_r500</a></li>
<li class="chapter" data-level="6.400" data-path="Ch06.html"><a href="Ch06.html#ch06.400"><i class="fa fa-check"></i><b>6.400</b> ForestsTrees_TemperateDeciduous_r1250</a></li>
<li class="chapter" data-level="6.401" data-path="Ch06.html"><a href="Ch06.html#ch06.401"><i class="fa fa-check"></i><b>6.401</b> ForestsTrees_TemperateDeciduous_r3000</a></li>
<li class="chapter" data-level="6.402" data-path="Ch06.html"><a href="Ch06.html#ch06.402"><i class="fa fa-check"></i><b>6.402</b> ForestsTrees_TemperateDeciduous_r10000</a></li>
<li class="chapter" data-level="6.403" data-path="Ch06.html"><a href="Ch06.html#ch06.403"><i class="fa fa-check"></i><b>6.403</b> General_AllotmentGardens_cell</a></li>
<li class="chapter" data-level="6.404" data-path="Ch06.html"><a href="Ch06.html#ch06.404"><i class="fa fa-check"></i><b>6.404</b> General_AllotmentGardens_r500</a></li>
<li class="chapter" data-level="6.405" data-path="Ch06.html"><a href="Ch06.html#ch06.405"><i class="fa fa-check"></i><b>6.405</b> General_AllotmentGardens_r1250</a></li>
<li class="chapter" data-level="6.406" data-path="Ch06.html"><a href="Ch06.html#ch06.406"><i class="fa fa-check"></i><b>6.406</b> General_AllotmentGardens_r3000</a></li>
<li class="chapter" data-level="6.407" data-path="Ch06.html"><a href="Ch06.html#ch06.407"><i class="fa fa-check"></i><b>6.407</b> General_AllotmentGardens_r10000</a></li>
<li class="chapter" data-level="6.408" data-path="Ch06.html"><a href="Ch06.html#ch06.408"><i class="fa fa-check"></i><b>6.408</b> General_BareSoilQuarry_cell</a></li>
<li class="chapter" data-level="6.409" data-path="Ch06.html"><a href="Ch06.html#ch06.409"><i class="fa fa-check"></i><b>6.409</b> General_BareSoilQuarry_r500</a></li>
<li class="chapter" data-level="6.410" data-path="Ch06.html"><a href="Ch06.html#ch06.410"><i class="fa fa-check"></i><b>6.410</b> General_BareSoilQuarry_r1250</a></li>
<li class="chapter" data-level="6.411" data-path="Ch06.html"><a href="Ch06.html#ch06.411"><i class="fa fa-check"></i><b>6.411</b> General_BareSoilQuarry_r3000</a></li>
<li class="chapter" data-level="6.412" data-path="Ch06.html"><a href="Ch06.html#ch06.412"><i class="fa fa-check"></i><b>6.412</b> General_BareSoilQuarry_r10000</a></li>
<li class="chapter" data-level="6.413" data-path="Ch06.html"><a href="Ch06.html#ch06.413"><i class="fa fa-check"></i><b>6.413</b> General_Builtup_cell</a></li>
<li class="chapter" data-level="6.414" data-path="Ch06.html"><a href="Ch06.html#ch06.414"><i class="fa fa-check"></i><b>6.414</b> General_Builtup_r500</a></li>
<li class="chapter" data-level="6.415" data-path="Ch06.html"><a href="Ch06.html#ch06.415"><i class="fa fa-check"></i><b>6.415</b> General_Builtup_r1250</a></li>
<li class="chapter" data-level="6.416" data-path="Ch06.html"><a href="Ch06.html#ch06.416"><i class="fa fa-check"></i><b>6.416</b> General_Builtup_r3000</a></li>
<li class="chapter" data-level="6.417" data-path="Ch06.html"><a href="Ch06.html#ch06.417"><i class="fa fa-check"></i><b>6.417</b> General_Builtup_r10000</a></li>
<li class="chapter" data-level="6.418" data-path="Ch06.html"><a href="Ch06.html#ch06.418"><i class="fa fa-check"></i><b>6.418</b> General_Farmland_cell</a></li>
<li class="chapter" data-level="6.419" data-path="Ch06.html"><a href="Ch06.html#ch06.419"><i class="fa fa-check"></i><b>6.419</b> General_Farmland_r500</a></li>
<li class="chapter" data-level="6.420" data-path="Ch06.html"><a href="Ch06.html#ch06.420"><i class="fa fa-check"></i><b>6.420</b> General_Farmland_r1250</a></li>
<li class="chapter" data-level="6.421" data-path="Ch06.html"><a href="Ch06.html#ch06.421"><i class="fa fa-check"></i><b>6.421</b> General_Farmland_r3000</a></li>
<li class="chapter" data-level="6.422" data-path="Ch06.html"><a href="Ch06.html#ch06.422"><i class="fa fa-check"></i><b>6.422</b> General_Farmland_r10000</a></li>
<li class="chapter" data-level="6.423" data-path="Ch06.html"><a href="Ch06.html#ch06.423"><i class="fa fa-check"></i><b>6.423</b> General_ForestsWithoutInventory_cell</a></li>
<li class="chapter" data-level="6.424" data-path="Ch06.html"><a href="Ch06.html#ch06.424"><i class="fa fa-check"></i><b>6.424</b> General_ForestsWithoutInventory_r500</a></li>
<li class="chapter" data-level="6.425" data-path="Ch06.html"><a href="Ch06.html#ch06.425"><i class="fa fa-check"></i><b>6.425</b> General_ForestsWithoutInventory_r1250</a></li>
<li class="chapter" data-level="6.426" data-path="Ch06.html"><a href="Ch06.html#ch06.426"><i class="fa fa-check"></i><b>6.426</b> General_ForestsWithoutInventory_r3000</a></li>
<li class="chapter" data-level="6.427" data-path="Ch06.html"><a href="Ch06.html#ch06.427"><i class="fa fa-check"></i><b>6.427</b> General_ForestsWithoutInventory_r10000</a></li>
<li class="chapter" data-level="6.428" data-path="Ch06.html"><a href="Ch06.html#ch06.428"><i class="fa fa-check"></i><b>6.428</b> General_GardensOrchards_cell</a></li>
<li class="chapter" data-level="6.429" data-path="Ch06.html"><a href="Ch06.html#ch06.429"><i class="fa fa-check"></i><b>6.429</b> General_GardensOrchards_r500</a></li>
<li class="chapter" data-level="6.430" data-path="Ch06.html"><a href="Ch06.html#ch06.430"><i class="fa fa-check"></i><b>6.430</b> General_GardensOrchards_r1250</a></li>
<li class="chapter" data-level="6.431" data-path="Ch06.html"><a href="Ch06.html#ch06.431"><i class="fa fa-check"></i><b>6.431</b> General_GardensOrchards_r3000</a></li>
<li class="chapter" data-level="6.432" data-path="Ch06.html"><a href="Ch06.html#ch06.432"><i class="fa fa-check"></i><b>6.432</b> General_GardensOrchards_r10000</a></li>
<li class="chapter" data-level="6.433" data-path="Ch06.html"><a href="Ch06.html#ch06.433"><i class="fa fa-check"></i><b>6.433</b> General_Roads_cell</a></li>
<li class="chapter" data-level="6.434" data-path="Ch06.html"><a href="Ch06.html#ch06.434"><i class="fa fa-check"></i><b>6.434</b> General_ShrubsOrchards_cell</a></li>
<li class="chapter" data-level="6.435" data-path="Ch06.html"><a href="Ch06.html#ch06.435"><i class="fa fa-check"></i><b>6.435</b> General_ShrubsOrchards_r500</a></li>
<li class="chapter" data-level="6.436" data-path="Ch06.html"><a href="Ch06.html#ch06.436"><i class="fa fa-check"></i><b>6.436</b> General_ShrubsOrchards_r1250</a></li>
<li class="chapter" data-level="6.437" data-path="Ch06.html"><a href="Ch06.html#ch06.437"><i class="fa fa-check"></i><b>6.437</b> General_ShrubsOrchards_r3000</a></li>
<li class="chapter" data-level="6.438" data-path="Ch06.html"><a href="Ch06.html#ch06.438"><i class="fa fa-check"></i><b>6.438</b> General_ShrubsOrchards_r10000</a></li>
<li class="chapter" data-level="6.439" data-path="Ch06.html"><a href="Ch06.html#ch06.439"><i class="fa fa-check"></i><b>6.439</b> General_ShrubsOrchardsGardens_cell</a></li>
<li class="chapter" data-level="6.440" data-path="Ch06.html"><a href="Ch06.html#ch06.440"><i class="fa fa-check"></i><b>6.440</b> General_ShrubsOrchardsGardens_r500</a></li>
<li class="chapter" data-level="6.441" data-path="Ch06.html"><a href="Ch06.html#ch06.441"><i class="fa fa-check"></i><b>6.441</b> General_ShrubsOrchardsGardens_r1250</a></li>
<li class="chapter" data-level="6.442" data-path="Ch06.html"><a href="Ch06.html#ch06.442"><i class="fa fa-check"></i><b>6.442</b> General_ShrubsOrchardsGardens_r3000</a></li>
<li class="chapter" data-level="6.443" data-path="Ch06.html"><a href="Ch06.html#ch06.443"><i class="fa fa-check"></i><b>6.443</b> General_ShrubsOrchardsGardens_r10000</a></li>
<li class="chapter" data-level="6.444" data-path="Ch06.html"><a href="Ch06.html#ch06.444"><i class="fa fa-check"></i><b>6.444</b> General_SwampsMiresBogsHelophytes_cell</a></li>
<li class="chapter" data-level="6.445" data-path="Ch06.html"><a href="Ch06.html#ch06.445"><i class="fa fa-check"></i><b>6.445</b> General_SwampsMiresBogsHelophytes_r500</a></li>
<li class="chapter" data-level="6.446" data-path="Ch06.html"><a href="Ch06.html#ch06.446"><i class="fa fa-check"></i><b>6.446</b> General_SwampsMiresBogsHelophytes_r1250</a></li>
<li class="chapter" data-level="6.447" data-path="Ch06.html"><a href="Ch06.html#ch06.447"><i class="fa fa-check"></i><b>6.447</b> General_SwampsMiresBogsHelophytes_r3000</a></li>
<li class="chapter" data-level="6.448" data-path="Ch06.html"><a href="Ch06.html#ch06.448"><i class="fa fa-check"></i><b>6.448</b> General_SwampsMiresBogsHelophytes_r10000</a></li>
<li class="chapter" data-level="6.449" data-path="Ch06.html"><a href="Ch06.html#ch06.449"><i class="fa fa-check"></i><b>6.449</b> General_Trees_cell</a></li>
<li class="chapter" data-level="6.450" data-path="Ch06.html"><a href="Ch06.html#ch06.450"><i class="fa fa-check"></i><b>6.450</b> General_Trees_r500</a></li>
<li class="chapter" data-level="6.451" data-path="Ch06.html"><a href="Ch06.html#ch06.451"><i class="fa fa-check"></i><b>6.451</b> General_Trees_r1250</a></li>
<li class="chapter" data-level="6.452" data-path="Ch06.html"><a href="Ch06.html#ch06.452"><i class="fa fa-check"></i><b>6.452</b> General_Trees_r3000</a></li>
<li class="chapter" data-level="6.453" data-path="Ch06.html"><a href="Ch06.html#ch06.453"><i class="fa fa-check"></i><b>6.453</b> General_Trees_r10000</a></li>
<li class="chapter" data-level="6.454" data-path="Ch06.html"><a href="Ch06.html#ch06.454"><i class="fa fa-check"></i><b>6.454</b> General_TreesOutsideForests_cell</a></li>
<li class="chapter" data-level="6.455" data-path="Ch06.html"><a href="Ch06.html#ch06.455"><i class="fa fa-check"></i><b>6.455</b> General_TreesOutsideForests_r500</a></li>
<li class="chapter" data-level="6.456" data-path="Ch06.html"><a href="Ch06.html#ch06.456"><i class="fa fa-check"></i><b>6.456</b> General_TreesOutsideForests_r1250</a></li>
<li class="chapter" data-level="6.457" data-path="Ch06.html"><a href="Ch06.html#ch06.457"><i class="fa fa-check"></i><b>6.457</b> General_TreesOutsideForests_r3000</a></li>
<li class="chapter" data-level="6.458" data-path="Ch06.html"><a href="Ch06.html#ch06.458"><i class="fa fa-check"></i><b>6.458</b> General_TreesOutsideForests_r10000</a></li>
<li class="chapter" data-level="6.459" data-path="Ch06.html"><a href="Ch06.html#ch06.459"><i class="fa fa-check"></i><b>6.459</b> General_Water_cell</a></li>
<li class="chapter" data-level="6.460" data-path="Ch06.html"><a href="Ch06.html#ch06.460"><i class="fa fa-check"></i><b>6.460</b> General_Water_r500</a></li>
<li class="chapter" data-level="6.461" data-path="Ch06.html"><a href="Ch06.html#ch06.461"><i class="fa fa-check"></i><b>6.461</b> General_Water_r1250</a></li>
<li class="chapter" data-level="6.462" data-path="Ch06.html"><a href="Ch06.html#ch06.462"><i class="fa fa-check"></i><b>6.462</b> General_Water_r3000</a></li>
<li class="chapter" data-level="6.463" data-path="Ch06.html"><a href="Ch06.html#ch06.463"><i class="fa fa-check"></i><b>6.463</b> General_Water_r10000</a></li>
<li class="chapter" data-level="6.464" data-path="Ch06.html"><a href="Ch06.html#ch06.464"><i class="fa fa-check"></i><b>6.464</b> Wetlands_Bogs_cell</a></li>
<li class="chapter" data-level="6.465" data-path="Ch06.html"><a href="Ch06.html#ch06.465"><i class="fa fa-check"></i><b>6.465</b> Wetlands_Bogs_r500</a></li>
<li class="chapter" data-level="6.466" data-path="Ch06.html"><a href="Ch06.html#ch06.466"><i class="fa fa-check"></i><b>6.466</b> Wetlands_Bogs_r1250</a></li>
<li class="chapter" data-level="6.467" data-path="Ch06.html"><a href="Ch06.html#ch06.467"><i class="fa fa-check"></i><b>6.467</b> Wetlands_Bogs_r3000</a></li>
<li class="chapter" data-level="6.468" data-path="Ch06.html"><a href="Ch06.html#ch06.468"><i class="fa fa-check"></i><b>6.468</b> Wetlands_Bogs_r10000</a></li>
<li class="chapter" data-level="6.469" data-path="Ch06.html"><a href="Ch06.html#ch06.469"><i class="fa fa-check"></i><b>6.469</b> Wetlands_Mires_cell</a></li>
<li class="chapter" data-level="6.470" data-path="Ch06.html"><a href="Ch06.html#ch06.470"><i class="fa fa-check"></i><b>6.470</b> Wetlands_Mires_r500</a></li>
<li class="chapter" data-level="6.471" data-path="Ch06.html"><a href="Ch06.html#ch06.471"><i class="fa fa-check"></i><b>6.471</b> Wetlands_Mires_r1250</a></li>
<li class="chapter" data-level="6.472" data-path="Ch06.html"><a href="Ch06.html#ch06.472"><i class="fa fa-check"></i><b>6.472</b> Wetlands_Mires_r3000</a></li>
<li class="chapter" data-level="6.473" data-path="Ch06.html"><a href="Ch06.html#ch06.473"><i class="fa fa-check"></i><b>6.473</b> Wetlands_Mires_r10000</a></li>
<li class="chapter" data-level="6.474" data-path="Ch06.html"><a href="Ch06.html#ch06.474"><i class="fa fa-check"></i><b>6.474</b> Wetlands_ReedSedgeRushBeds_cell</a></li>
<li class="chapter" data-level="6.475" data-path="Ch06.html"><a href="Ch06.html#ch06.475"><i class="fa fa-check"></i><b>6.475</b> Wetlands_ReedSedgeRushBeds_r500</a></li>
<li class="chapter" data-level="6.476" data-path="Ch06.html"><a href="Ch06.html#ch06.476"><i class="fa fa-check"></i><b>6.476</b> Wetlands_ReedSedgeRushBeds_r1250</a></li>
<li class="chapter" data-level="6.477" data-path="Ch06.html"><a href="Ch06.html#ch06.477"><i class="fa fa-check"></i><b>6.477</b> Wetlands_ReedSedgeRushBeds_r3000</a></li>
<li class="chapter" data-level="6.478" data-path="Ch06.html"><a href="Ch06.html#ch06.478"><i class="fa fa-check"></i><b>6.478</b> Wetlands_ReedSedgeRushBeds_r10000</a></li>
<li class="chapter" data-level="6.479" data-path="Ch06.html"><a href="Ch06.html#ch06.479"><i class="fa fa-check"></i><b>6.479</b> EO_NDMI-LYmed-average_cell</a></li>
<li class="chapter" data-level="6.480" data-path="Ch06.html"><a href="Ch06.html#ch06.480"><i class="fa fa-check"></i><b>6.480</b> EO_NDMI-LYmedian-iqr_cell</a></li>
<li class="chapter" data-level="6.481" data-path="Ch06.html"><a href="Ch06.html#ch06.481"><i class="fa fa-check"></i><b>6.481</b> EO_NDMI-STiqr-median_cell</a></li>
<li class="chapter" data-level="6.482" data-path="Ch06.html"><a href="Ch06.html#ch06.482"><i class="fa fa-check"></i><b>6.482</b> EO_NDMI-STmedian-average_cell</a></li>
<li class="chapter" data-level="6.483" data-path="Ch06.html"><a href="Ch06.html#ch06.483"><i class="fa fa-check"></i><b>6.483</b> EO_NDMI-STmedian-iqr_cell</a></li>
<li class="chapter" data-level="6.484" data-path="Ch06.html"><a href="Ch06.html#ch06.484"><i class="fa fa-check"></i><b>6.484</b> EO_NDMI-STp25-min_cell</a></li>
<li class="chapter" data-level="6.485" data-path="Ch06.html"><a href="Ch06.html#ch06.485"><i class="fa fa-check"></i><b>6.485</b> EO_NDMI-STp75-max_cell</a></li>
<li class="chapter" data-level="6.486" data-path="Ch06.html"><a href="Ch06.html#ch06.486"><i class="fa fa-check"></i><b>6.486</b> EO_NDVI-LYmedian-average_cell</a></li>
<li class="chapter" data-level="6.487" data-path="Ch06.html"><a href="Ch06.html#ch06.487"><i class="fa fa-check"></i><b>6.487</b> EO_NDVI-LYmedian-iqr_cell</a></li>
<li class="chapter" data-level="6.488" data-path="Ch06.html"><a href="Ch06.html#ch06.488"><i class="fa fa-check"></i><b>6.488</b> EO_NDVI-STiqr-median_cell</a></li>
<li class="chapter" data-level="6.489" data-path="Ch06.html"><a href="Ch06.html#ch06.489"><i class="fa fa-check"></i><b>6.489</b> EO_NDVI-STmedian-average_cell</a></li>
<li class="chapter" data-level="6.490" data-path="Ch06.html"><a href="Ch06.html#ch06.490"><i class="fa fa-check"></i><b>6.490</b> EO_NDVI-STmedian-iqr_cell</a></li>
<li class="chapter" data-level="6.491" data-path="Ch06.html"><a href="Ch06.html#ch06.491"><i class="fa fa-check"></i><b>6.491</b> EO_NDVI-STp25-min_cell</a></li>
<li class="chapter" data-level="6.492" data-path="Ch06.html"><a href="Ch06.html#ch06.492"><i class="fa fa-check"></i><b>6.492</b> EO_NDVI-STp75-max_cell</a></li>
<li class="chapter" data-level="6.493" data-path="Ch06.html"><a href="Ch06.html#ch06.493"><i class="fa fa-check"></i><b>6.493</b> EO_NDWI-LYmedian-average_cell</a></li>
<li class="chapter" data-level="6.494" data-path="Ch06.html"><a href="Ch06.html#ch06.494"><i class="fa fa-check"></i><b>6.494</b> EO_NDWI-LYmedian-iqr_cell</a></li>
<li class="chapter" data-level="6.495" data-path="Ch06.html"><a href="Ch06.html#ch06.495"><i class="fa fa-check"></i><b>6.495</b> EO_NDWI-STiqr-median_cell</a></li>
<li class="chapter" data-level="6.496" data-path="Ch06.html"><a href="Ch06.html#ch06.496"><i class="fa fa-check"></i><b>6.496</b> EO_NDWI-STmedian-average_cell</a></li>
<li class="chapter" data-level="6.497" data-path="Ch06.html"><a href="Ch06.html#ch06.497"><i class="fa fa-check"></i><b>6.497</b> EO_NDWI-STmedian-iqr_cell</a></li>
<li class="chapter" data-level="6.498" data-path="Ch06.html"><a href="Ch06.html#ch06.498"><i class="fa fa-check"></i><b>6.498</b> EO_NDWI-STp25-min_cell</a></li>
<li class="chapter" data-level="6.499" data-path="Ch06.html"><a href="Ch06.html#ch06.499"><i class="fa fa-check"></i><b>6.499</b> EO_NDWI-STp75-max_cell</a></li>
<li class="chapter" data-level="6.500" data-path="Ch06.html"><a href="Ch06.html#ch06.500"><i class="fa fa-check"></i><b>6.500</b> SoilChemistry_ESDAC-CN_cell</a></li>
<li class="chapter" data-level="6.501" data-path="Ch06.html"><a href="Ch06.html#ch06.501"><i class="fa fa-check"></i><b>6.501</b> SoilChemistry_ESDAC-CaCo3_cell</a></li>
<li class="chapter" data-level="6.502" data-path="Ch06.html"><a href="Ch06.html#ch06.502"><i class="fa fa-check"></i><b>6.502</b> SoilChemistry_ESDAC-K_cell</a></li>
<li class="chapter" data-level="6.503" data-path="Ch06.html"><a href="Ch06.html#ch06.503"><i class="fa fa-check"></i><b>6.503</b> SoilChemistry_ESDAC-N_cell</a></li>
<li class="chapter" data-level="6.504" data-path="Ch06.html"><a href="Ch06.html#ch06.504"><i class="fa fa-check"></i><b>6.504</b> SoilChemistry_ESDAC-P_cell</a></li>
<li class="chapter" data-level="6.505" data-path="Ch06.html"><a href="Ch06.html#ch06.505"><i class="fa fa-check"></i><b>6.505</b> SoilChemistry_ESDAC-phH2O_cell</a></li>
<li class="chapter" data-level="6.506" data-path="Ch06.html"><a href="Ch06.html#ch06.506"><i class="fa fa-check"></i><b>6.506</b> SoilTexture_Clay_cell</a></li>
<li class="chapter" data-level="6.507" data-path="Ch06.html"><a href="Ch06.html#ch06.507"><i class="fa fa-check"></i><b>6.507</b> SoilTexture_Clay_r500</a></li>
<li class="chapter" data-level="6.508" data-path="Ch06.html"><a href="Ch06.html#ch06.508"><i class="fa fa-check"></i><b>6.508</b> SoilTexture_Clay_r1250</a></li>
<li class="chapter" data-level="6.509" data-path="Ch06.html"><a href="Ch06.html#ch06.509"><i class="fa fa-check"></i><b>6.509</b> SoilTexture_Clay_r3000</a></li>
<li class="chapter" data-level="6.510" data-path="Ch06.html"><a href="Ch06.html#ch06.510"><i class="fa fa-check"></i><b>6.510</b> SoilTexture_Clay_r10000</a></li>
<li class="chapter" data-level="6.511" data-path="Ch06.html"><a href="Ch06.html#ch06.511"><i class="fa fa-check"></i><b>6.511</b> SoilTexture_Organic_cell</a></li>
<li class="chapter" data-level="6.512" data-path="Ch06.html"><a href="Ch06.html#ch06.512"><i class="fa fa-check"></i><b>6.512</b> SoilTexture_Organic_r500</a></li>
<li class="chapter" data-level="6.513" data-path="Ch06.html"><a href="Ch06.html#ch06.513"><i class="fa fa-check"></i><b>6.513</b> SoilTexture_Organic_r1250</a></li>
<li class="chapter" data-level="6.514" data-path="Ch06.html"><a href="Ch06.html#ch06.514"><i class="fa fa-check"></i><b>6.514</b> SoilTexture_Organic_r3000</a></li>
<li class="chapter" data-level="6.515" data-path="Ch06.html"><a href="Ch06.html#ch06.515"><i class="fa fa-check"></i><b>6.515</b> SoilTexture_Organic_r10000</a></li>
<li class="chapter" data-level="6.516" data-path="Ch06.html"><a href="Ch06.html#ch06.516"><i class="fa fa-check"></i><b>6.516</b> SoilTexture_Sand_cell</a></li>
<li class="chapter" data-level="6.517" data-path="Ch06.html"><a href="Ch06.html#ch06.517"><i class="fa fa-check"></i><b>6.517</b> SoilTexture_Sand_r500</a></li>
<li class="chapter" data-level="6.518" data-path="Ch06.html"><a href="Ch06.html#ch06.518"><i class="fa fa-check"></i><b>6.518</b> SoilTexture_Sand_r1250</a></li>
<li class="chapter" data-level="6.519" data-path="Ch06.html"><a href="Ch06.html#ch06.519"><i class="fa fa-check"></i><b>6.519</b> SoilTexture_Sand_r3000</a></li>
<li class="chapter" data-level="6.520" data-path="Ch06.html"><a href="Ch06.html#ch06.520"><i class="fa fa-check"></i><b>6.520</b> SoilTexture_Sand_r10000</a></li>
<li class="chapter" data-level="6.521" data-path="Ch06.html"><a href="Ch06.html#ch06.521"><i class="fa fa-check"></i><b>6.521</b> SoilTexture_Silt_cell</a></li>
<li class="chapter" data-level="6.522" data-path="Ch06.html"><a href="Ch06.html#ch06.522"><i class="fa fa-check"></i><b>6.522</b> SoilTexture_Silt_r500</a></li>
<li class="chapter" data-level="6.523" data-path="Ch06.html"><a href="Ch06.html#ch06.523"><i class="fa fa-check"></i><b>6.523</b> SoilTexture_Silt_r1250</a></li>
<li class="chapter" data-level="6.524" data-path="Ch06.html"><a href="Ch06.html#ch06.524"><i class="fa fa-check"></i><b>6.524</b> SoilTexture_Silt_r3000</a></li>
<li class="chapter" data-level="6.525" data-path="Ch06.html"><a href="Ch06.html#ch06.525"><i class="fa fa-check"></i><b>6.525</b> SoilTexture_Silt_r10000</a></li>
<li class="chapter" data-level="6.526" data-path="Ch06.html"><a href="Ch06.html#ch06.526"><i class="fa fa-check"></i><b>6.526</b> Terrain_ASL-average_cell</a></li>
<li class="chapter" data-level="6.527" data-path="Ch06.html"><a href="Ch06.html#ch06.527"><i class="fa fa-check"></i><b>6.527</b> Terrain_Aspect-average_cell</a></li>
<li class="chapter" data-level="6.528" data-path="Ch06.html"><a href="Ch06.html#ch06.528"><i class="fa fa-check"></i><b>6.528</b> Terrain_Aspect-iqr_cell</a></li>
<li class="chapter" data-level="6.529" data-path="Ch06.html"><a href="Ch06.html#ch06.529"><i class="fa fa-check"></i><b>6.529</b> Terrain_DiS-area_cell</a></li>
<li class="chapter" data-level="6.530" data-path="Ch06.html"><a href="Ch06.html#ch06.530"><i class="fa fa-check"></i><b>6.530</b> Terrain_DiS-area_r500</a></li>
<li class="chapter" data-level="6.531" data-path="Ch06.html"><a href="Ch06.html#ch06.531"><i class="fa fa-check"></i><b>6.531</b> Terrain_DiS-area_r1250</a></li>
<li class="chapter" data-level="6.532" data-path="Ch06.html"><a href="Ch06.html#ch06.532"><i class="fa fa-check"></i><b>6.532</b> Terrain_DiS-area_r3000</a></li>
<li class="chapter" data-level="6.533" data-path="Ch06.html"><a href="Ch06.html#ch06.533"><i class="fa fa-check"></i><b>6.533</b> Terrain_DiS-area_r10000</a></li>
<li class="chapter" data-level="6.534" data-path="Ch06.html"><a href="Ch06.html#ch06.534"><i class="fa fa-check"></i><b>6.534</b> Terrain_DiS-max_cell</a></li>
<li class="chapter" data-level="6.535" data-path="Ch06.html"><a href="Ch06.html#ch06.535"><i class="fa fa-check"></i><b>6.535</b> Terrain_DiS-mean_cell</a></li>
<li class="chapter" data-level="6.536" data-path="Ch06.html"><a href="Ch06.html#ch06.536"><i class="fa fa-check"></i><b>6.536</b> Terrain_Slope-average_cell</a></li>
<li class="chapter" data-level="6.537" data-path="Ch06.html"><a href="Ch06.html#ch06.537"><i class="fa fa-check"></i><b>6.537</b> Terrain_Slope-iqr_cell</a></li>
<li class="chapter" data-level="6.538" data-path="Ch06.html"><a href="Ch06.html#ch06.538"><i class="fa fa-check"></i><b>6.538</b> Terrain_TWI-average_cell</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Ch07.html"><a href="Ch07.html"><i class="fa fa-check"></i><b>7</b> Data access</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">High-resolution ecogeographical variables for species distribution modelling describing Latvia, 2024</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Ch04" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Raw geodata<a href="Ch04.html#Ch04" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter describes raw geodata used and the preliminary processing conducted on them.</p>
<div id="Ch04.01" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> State Forest Service’s State Forest Registry<a href="Ch04.html#Ch04.01" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The State Forest Service’s Forest State Register database (ESRI file geodatabase),
which compiles indicators and spatial data characterizing forest compartments
(stand level inventory database), was received by the University of
Latvia on January 7, 2024, to support study and research processes. The structure
of the received database version corresponds to
the <a href="https://www.vmd.gov.lv/lv/meza-valsts-registra-meza-inventarizacijas-failu-struktura">Forest State Register Forest Inventory File Structure</a>, but
lowercase letters are used in field names.</p>
<p>After downloading, the CRS is guarded, geometries are checked and saved in
geoparquet format.</p>
<p>Files are stored at <code>Geodata/2024/MVR/</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="Ch04.html#cb13-1" tabindex="-1"></a><span class="co"># libs</span></span>
<span id="cb13-2"><a href="Ch04.html#cb13-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sf)) {<span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>); <span class="fu">require</span>(sf)}</span>
<span id="cb13-3"><a href="Ch04.html#cb13-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(arrow)) {<span class="fu">install.packages</span>(<span class="st">&quot;arrow&quot;</span>); <span class="fu">require</span>(arrow)}</span>
<span id="cb13-4"><a href="Ch04.html#cb13-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sfarrow)) {<span class="fu">install.packages</span>(<span class="st">&quot;sfarrow&quot;</span>); <span class="fu">require</span>(sfarrow)}</span>
<span id="cb13-5"><a href="Ch04.html#cb13-5" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(gdalUtilities)) {<span class="fu">install.packages</span>(<span class="st">&quot;gdalUtilities&quot;</span>); <span class="fu">require</span>(gdalUtilities)}</span>
<span id="cb13-6"><a href="Ch04.html#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="Ch04.html#cb13-7" tabindex="-1"></a><span class="co"># database</span></span>
<span id="cb13-8"><a href="Ch04.html#cb13-8" tabindex="-1"></a>nog<span class="ot">=</span><span class="fu">read_sf</span>(<span class="st">&quot;./Geodata/2024/MVR/VMD.gdb/&quot;</span>,<span class="at">layer=</span><span class="st">&quot;Nogabali_pilna_datubaze&quot;</span>)</span>
<span id="cb13-9"><a href="Ch04.html#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="Ch04.html#cb13-10" tabindex="-1"></a><span class="co"># ensuring geometries</span></span>
<span id="cb13-11"><a href="Ch04.html#cb13-11" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;./RScripts_final/egvs02.02_UtilityFunctions.R&quot;</span>)</span>
<span id="cb13-12"><a href="Ch04.html#cb13-12" tabindex="-1"></a>nogabali <span class="ot">&lt;-</span> <span class="fu">ensure_multipolygons</span>(nog)</span>
<span id="cb13-13"><a href="Ch04.html#cb13-13" tabindex="-1"></a></span>
<span id="cb13-14"><a href="Ch04.html#cb13-14" tabindex="-1"></a><span class="co"># securing geometries</span></span>
<span id="cb13-15"><a href="Ch04.html#cb13-15" tabindex="-1"></a>nogabali2 <span class="ot">=</span> nogabali[<span class="sc">!</span><span class="fu">st_is_empty</span>(nogabali),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 108 tukšas ģeometrijas</span></span>
<span id="cb13-16"><a href="Ch04.html#cb13-16" tabindex="-1"></a>validity<span class="ot">=</span><span class="fu">st_is_valid</span>(nogabali2) </span>
<span id="cb13-17"><a href="Ch04.html#cb13-17" tabindex="-1"></a><span class="fu">table</span>(validity) <span class="co"># 1733 invalid ģeometrijas</span></span>
<span id="cb13-18"><a href="Ch04.html#cb13-18" tabindex="-1"></a>nogabali3<span class="ot">=</span><span class="fu">st_make_valid</span>(nogabali2)</span>
<span id="cb13-19"><a href="Ch04.html#cb13-19" tabindex="-1"></a></span>
<span id="cb13-20"><a href="Ch04.html#cb13-20" tabindex="-1"></a><span class="co"># transforming CRS</span></span>
<span id="cb13-21"><a href="Ch04.html#cb13-21" tabindex="-1"></a>nogabali4<span class="ot">=</span><span class="fu">st_transform</span>(nogabali3, <span class="at">crs=</span><span class="dv">3059</span>)</span>
<span id="cb13-22"><a href="Ch04.html#cb13-22" tabindex="-1"></a></span>
<span id="cb13-23"><a href="Ch04.html#cb13-23" tabindex="-1"></a><span class="co"># saving</span></span>
<span id="cb13-24"><a href="Ch04.html#cb13-24" tabindex="-1"></a>sfarrow<span class="sc">::</span><span class="fu">st_write_parquet</span>(nogabali4, <span class="st">&quot;./Geodata/2024/MVR/nogabali_2024janv.parquet&quot;</span>)</span></code></pre></div>
</details>
</div>
<div id="Ch04.02" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Rural Support Service’s information on declared fields<a href="Ch04.html#Ch04.02" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Rural Support Service maintains <a href="https://data.gov.lv/dati/lv/organization/lad">regularly updated information on the open
data portal</a>. An archive (since 2015) is
also available there, and the data sets that can be used contain the keyword “deklarētās platības”.</p>
<p>After downloading files to <code>Geodata/2024/LAD/downloads/</code>, they are unzipped and read into R.
it is checked, empty files are deleted and the rest are validated, and all individual
files are combined into one, which is saved in geopackage and geoparquet formats
at <code>Geodata/2024/LAD/</code>. At the end, downloaded files are unlinked.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="Ch04.html#cb14-1" tabindex="-1"></a><span class="co"># libs</span></span>
<span id="cb14-2"><a href="Ch04.html#cb14-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sf)) {<span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>); <span class="fu">require</span>(sf)}</span>
<span id="cb14-3"><a href="Ch04.html#cb14-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(arrow)) {<span class="fu">install.packages</span>(<span class="st">&quot;arrow&quot;</span>); <span class="fu">require</span>(arrow)}</span>
<span id="cb14-4"><a href="Ch04.html#cb14-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sfarrow)) {<span class="fu">install.packages</span>(<span class="st">&quot;sfarrow&quot;</span>); <span class="fu">require</span>(sfarrow)}</span>
<span id="cb14-5"><a href="Ch04.html#cb14-5" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(gdalUtilities)) {<span class="fu">install.packages</span>(<span class="st">&quot;gdalUtilities&quot;</span>); <span class="fu">require</span>(gdalUtilities)}</span>
<span id="cb14-6"><a href="Ch04.html#cb14-6" tabindex="-1"></a></span>
<span id="cb14-7"><a href="Ch04.html#cb14-7" tabindex="-1"></a><span class="co"># reading all files</span></span>
<span id="cb14-8"><a href="Ch04.html#cb14-8" tabindex="-1"></a>faili<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">celi=</span><span class="fu">list.files</span>(<span class="st">&quot;./Geodata/2024/LAD/downloads&quot;</span>,<span class="at">full.names =</span> <span class="cn">TRUE</span>))</span>
<span id="cb14-9"><a href="Ch04.html#cb14-9" tabindex="-1"></a>dati<span class="ot">=</span><span class="fu">st_read</span>(faili<span class="sc">$</span>celi[<span class="dv">1</span>])</span>
<span id="cb14-10"><a href="Ch04.html#cb14-10" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(faili<span class="sc">$</span>celi)){</span>
<span id="cb14-11"><a href="Ch04.html#cb14-11" tabindex="-1"></a>  nakosais<span class="ot">=</span><span class="fu">st_read</span>(faili<span class="sc">$</span>celi[i])</span>
<span id="cb14-12"><a href="Ch04.html#cb14-12" tabindex="-1"></a>  dati<span class="ot">=</span><span class="fu">bind_rows</span>(dati,nakosais)</span>
<span id="cb14-13"><a href="Ch04.html#cb14-13" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">nrow</span>(dati))</span>
<span id="cb14-14"><a href="Ch04.html#cb14-14" tabindex="-1"></a>}</span>
<span id="cb14-15"><a href="Ch04.html#cb14-15" tabindex="-1"></a></span>
<span id="cb14-16"><a href="Ch04.html#cb14-16" tabindex="-1"></a><span class="co"># ensuring geometries</span></span>
<span id="cb14-17"><a href="Ch04.html#cb14-17" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;./RScripts_final/egvs02.02_UtilityFunctions.R&quot;</span>)</span>
<span id="cb14-18"><a href="Ch04.html#cb14-18" tabindex="-1"></a>nogabali <span class="ot">&lt;-</span> <span class="fu">ensure_multipolygons</span>(nog)</span>
<span id="cb14-19"><a href="Ch04.html#cb14-19" tabindex="-1"></a>dati2 <span class="ot">&lt;-</span> <span class="fu">ensure_multipolygons</span>(dati)</span>
<span id="cb14-20"><a href="Ch04.html#cb14-20" tabindex="-1"></a>dati3 <span class="ot">=</span> dati2[<span class="sc">!</span><span class="fu">st_is_empty</span>(dati2),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># viss kārtībā</span></span>
<span id="cb14-21"><a href="Ch04.html#cb14-21" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(dati3)) </span>
<span id="cb14-22"><a href="Ch04.html#cb14-22" tabindex="-1"></a>dati4<span class="ot">=</span><span class="fu">st_make_valid</span>(dati3)</span>
<span id="cb14-23"><a href="Ch04.html#cb14-23" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(dati4))</span>
<span id="cb14-24"><a href="Ch04.html#cb14-24" tabindex="-1"></a>dati5 <span class="ot">&lt;-</span> <span class="fu">ensure_multipolygons</span>(dati4)</span>
<span id="cb14-25"><a href="Ch04.html#cb14-25" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(dati5))</span>
<span id="cb14-26"><a href="Ch04.html#cb14-26" tabindex="-1"></a></span>
<span id="cb14-27"><a href="Ch04.html#cb14-27" tabindex="-1"></a><span class="co"># saving output</span></span>
<span id="cb14-28"><a href="Ch04.html#cb14-28" tabindex="-1"></a><span class="fu">st_write</span>(dati5,<span class="st">&quot;./Geodata/2024/LAD/Lauki_2024.gpkg&quot;</span>,<span class="at">append =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-29"><a href="Ch04.html#cb14-29" tabindex="-1"></a>sfarrow<span class="sc">::</span><span class="fu">st_write_parquet</span>(dati5,<span class="st">&quot;./Geodata/2024/LAD/Lauki_2024.parquet&quot;</span>)</span>
<span id="cb14-30"><a href="Ch04.html#cb14-30" tabindex="-1"></a></span>
<span id="cb14-31"><a href="Ch04.html#cb14-31" tabindex="-1"></a><span class="co"># unlinking downloads</span></span>
<span id="cb14-32"><a href="Ch04.html#cb14-32" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(faili<span class="sc">$</span>celi)){</span>
<span id="cb14-33"><a href="Ch04.html#cb14-33" tabindex="-1"></a>  <span class="fu">unlink</span>(faili<span class="sc">$</span>celi[i])</span>
<span id="cb14-34"><a href="Ch04.html#cb14-34" tabindex="-1"></a>}</span>
<span id="cb14-35"><a href="Ch04.html#cb14-35" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</details>
</div>
<div id="Ch04.03" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Melioration Cadaster<a href="Ch04.html#Ch04.03" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Land Improvement Cadastre Information System database was downloaded layer
by layer from Geoserver. Geometries were tested and validated for each layer, and
layers were all combined into a single geopackage file stored at <code>Geodata/2024/MKIS/</code>.</p>
<p>Initially, no additional processing was performed on this data. It was used to
prepare <a href="Ch05.html#Ch05">Geodata products</a> - both <a href="Ch05.html#Ch05.01">Terrain products</a> and <a href="Ch05.html#Ch05.03">Landscape classification</a>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="Ch04.html#cb15-1" tabindex="-1"></a><span class="co"># libs</span></span>
<span id="cb15-2"><a href="Ch04.html#cb15-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sf)) {<span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>); <span class="fu">require</span>(sf)}</span>
<span id="cb15-3"><a href="Ch04.html#cb15-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {<span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>); <span class="fu">require</span>(tidyverse)}</span>
<span id="cb15-4"><a href="Ch04.html#cb15-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(httr)) {<span class="fu">install.packages</span>(<span class="st">&quot;httr&quot;</span>); <span class="fu">require</span>(httr)}</span>
<span id="cb15-5"><a href="Ch04.html#cb15-5" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(ows4R)) {<span class="fu">install.packages</span>(<span class="st">&quot;ows4R&quot;</span>); <span class="fu">require</span>(ows4R)}</span>
<span id="cb15-6"><a href="Ch04.html#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="Ch04.html#cb15-7" tabindex="-1"></a><span class="co"># basis information ----</span></span>
<span id="cb15-8"><a href="Ch04.html#cb15-8" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-9"><a href="Ch04.html#cb15-9" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-10"><a href="Ch04.html#cb15-10" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-11"><a href="Ch04.html#cb15-11" tabindex="-1"></a>                  <span class="co">#version = &quot;2.0.0&quot;, # facultative</span></span>
<span id="cb15-12"><a href="Ch04.html#cb15-12" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-13"><a href="Ch04.html#cb15-13" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-14"><a href="Ch04.html#cb15-14" tabindex="-1"></a>request</span>
<span id="cb15-15"><a href="Ch04.html#cb15-15" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link, </span>
<span id="cb15-16"><a href="Ch04.html#cb15-16" tabindex="-1"></a>                            <span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-17"><a href="Ch04.html#cb15-17" tabindex="-1"></a>bwk_client</span>
<span id="cb15-18"><a href="Ch04.html#cb15-18" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-19"><a href="Ch04.html#cb15-19" tabindex="-1"></a></span>
<span id="cb15-20"><a href="Ch04.html#cb15-20" tabindex="-1"></a></span>
<span id="cb15-21"><a href="Ch04.html#cb15-21" tabindex="-1"></a><span class="co"># aizsargdambji ----</span></span>
<span id="cb15-22"><a href="Ch04.html#cb15-22" tabindex="-1"></a></span>
<span id="cb15-23"><a href="Ch04.html#cb15-23" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-24"><a href="Ch04.html#cb15-24" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-25"><a href="Ch04.html#cb15-25" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-26"><a href="Ch04.html#cb15-26" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-27"><a href="Ch04.html#cb15-27" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_dam&quot;</span>)</span>
<span id="cb15-28"><a href="Ch04.html#cb15-28" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-29"><a href="Ch04.html#cb15-29" tabindex="-1"></a>aizsargdambji <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-30"><a href="Ch04.html#cb15-30" tabindex="-1"></a>aizsargdambji <span class="ot">=</span> aizsargdambji <span class="sc">%&gt;%</span> <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(<span class="dv">3059</span>))</span>
<span id="cb15-31"><a href="Ch04.html#cb15-31" tabindex="-1"></a>aizsargdambji<span class="ot">=</span><span class="fu">st_cast</span>(aizsargdambji,<span class="st">&quot;MULTILINESTRING&quot;</span>)</span>
<span id="cb15-32"><a href="Ch04.html#cb15-32" tabindex="-1"></a></span>
<span id="cb15-33"><a href="Ch04.html#cb15-33" tabindex="-1"></a><span class="fu">ggplot</span>(aizsargdambji)<span class="sc">+</span><span class="fu">geom_sf</span>()</span>
<span id="cb15-34"><a href="Ch04.html#cb15-34" tabindex="-1"></a></span>
<span id="cb15-35"><a href="Ch04.html#cb15-35" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(aizsargdambji))</span>
<span id="cb15-36"><a href="Ch04.html#cb15-36" tabindex="-1"></a></span>
<span id="cb15-37"><a href="Ch04.html#cb15-37" tabindex="-1"></a><span class="fu">write_sf</span>(aizsargdambji,</span>
<span id="cb15-38"><a href="Ch04.html#cb15-38" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-39"><a href="Ch04.html#cb15-39" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;Aizsargdambji&quot;</span>,</span>
<span id="cb15-40"><a href="Ch04.html#cb15-40" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-41"><a href="Ch04.html#cb15-41" tabindex="-1"></a><span class="fu">rm</span>(aizsargdambji)</span>
<span id="cb15-42"><a href="Ch04.html#cb15-42" tabindex="-1"></a></span>
<span id="cb15-43"><a href="Ch04.html#cb15-43" tabindex="-1"></a><span class="co"># dabiskas udensteces ----</span></span>
<span id="cb15-44"><a href="Ch04.html#cb15-44" tabindex="-1"></a></span>
<span id="cb15-45"><a href="Ch04.html#cb15-45" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-46"><a href="Ch04.html#cb15-46" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-47"><a href="Ch04.html#cb15-47" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-48"><a href="Ch04.html#cb15-48" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-49"><a href="Ch04.html#cb15-49" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_watercourses&quot;</span>)</span>
<span id="cb15-50"><a href="Ch04.html#cb15-50" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-51"><a href="Ch04.html#cb15-51" tabindex="-1"></a></span>
<span id="cb15-52"><a href="Ch04.html#cb15-52" tabindex="-1"></a>DabiskasUdensteces <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-53"><a href="Ch04.html#cb15-53" tabindex="-1"></a>DabiskasUdensteces <span class="ot">=</span> DabiskasUdensteces <span class="sc">%&gt;%</span> <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(<span class="dv">3059</span>))</span>
<span id="cb15-54"><a href="Ch04.html#cb15-54" tabindex="-1"></a>DabiskasUdensteces<span class="ot">=</span><span class="fu">st_cast</span>(DabiskasUdensteces,<span class="st">&quot;MULTILINESTRING&quot;</span>)</span>
<span id="cb15-55"><a href="Ch04.html#cb15-55" tabindex="-1"></a></span>
<span id="cb15-56"><a href="Ch04.html#cb15-56" tabindex="-1"></a><span class="fu">ggplot</span>(DabiskasUdensteces)<span class="sc">+</span><span class="fu">geom_sf</span>()</span>
<span id="cb15-57"><a href="Ch04.html#cb15-57" tabindex="-1"></a></span>
<span id="cb15-58"><a href="Ch04.html#cb15-58" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(DabiskasUdensteces))</span>
<span id="cb15-59"><a href="Ch04.html#cb15-59" tabindex="-1"></a></span>
<span id="cb15-60"><a href="Ch04.html#cb15-60" tabindex="-1"></a><span class="fu">write_sf</span>(DabiskasUdensteces,</span>
<span id="cb15-61"><a href="Ch04.html#cb15-61" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-62"><a href="Ch04.html#cb15-62" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;DabiskasUdensteces&quot;</span>,</span>
<span id="cb15-63"><a href="Ch04.html#cb15-63" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-64"><a href="Ch04.html#cb15-64" tabindex="-1"></a><span class="fu">rm</span>(DabiskasUdensteces)</span>
<span id="cb15-65"><a href="Ch04.html#cb15-65" tabindex="-1"></a></span>
<span id="cb15-66"><a href="Ch04.html#cb15-66" tabindex="-1"></a></span>
<span id="cb15-67"><a href="Ch04.html#cb15-67" tabindex="-1"></a></span>
<span id="cb15-68"><a href="Ch04.html#cb15-68" tabindex="-1"></a><span class="co"># dambju piketi ----</span></span>
<span id="cb15-69"><a href="Ch04.html#cb15-69" tabindex="-1"></a></span>
<span id="cb15-70"><a href="Ch04.html#cb15-70" tabindex="-1"></a></span>
<span id="cb15-71"><a href="Ch04.html#cb15-71" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-72"><a href="Ch04.html#cb15-72" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-73"><a href="Ch04.html#cb15-73" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-74"><a href="Ch04.html#cb15-74" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-75"><a href="Ch04.html#cb15-75" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_dampicket&quot;</span>)</span>
<span id="cb15-76"><a href="Ch04.html#cb15-76" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-77"><a href="Ch04.html#cb15-77" tabindex="-1"></a></span>
<span id="cb15-78"><a href="Ch04.html#cb15-78" tabindex="-1"></a>DambjuPiketi <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-79"><a href="Ch04.html#cb15-79" tabindex="-1"></a>DambjuPiketi <span class="ot">=</span> DambjuPiketi <span class="sc">%&gt;%</span> <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(<span class="dv">3059</span>))</span>
<span id="cb15-80"><a href="Ch04.html#cb15-80" tabindex="-1"></a>DambjuPiketi<span class="ot">=</span><span class="fu">st_cast</span>(DambjuPiketi,<span class="st">&quot;POINT&quot;</span>)</span>
<span id="cb15-81"><a href="Ch04.html#cb15-81" tabindex="-1"></a></span>
<span id="cb15-82"><a href="Ch04.html#cb15-82" tabindex="-1"></a><span class="fu">ggplot</span>(DambjuPiketi)<span class="sc">+</span><span class="fu">geom_sf</span>()</span>
<span id="cb15-83"><a href="Ch04.html#cb15-83" tabindex="-1"></a></span>
<span id="cb15-84"><a href="Ch04.html#cb15-84" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(DambjuPiketi))</span>
<span id="cb15-85"><a href="Ch04.html#cb15-85" tabindex="-1"></a></span>
<span id="cb15-86"><a href="Ch04.html#cb15-86" tabindex="-1"></a><span class="fu">write_sf</span>(DambjuPiketi,</span>
<span id="cb15-87"><a href="Ch04.html#cb15-87" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-88"><a href="Ch04.html#cb15-88" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;DambjuPiketi&quot;</span>,</span>
<span id="cb15-89"><a href="Ch04.html#cb15-89" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-90"><a href="Ch04.html#cb15-90" tabindex="-1"></a><span class="fu">rm</span>(DambjuPiketi)</span>
<span id="cb15-91"><a href="Ch04.html#cb15-91" tabindex="-1"></a></span>
<span id="cb15-92"><a href="Ch04.html#cb15-92" tabindex="-1"></a></span>
<span id="cb15-93"><a href="Ch04.html#cb15-93" tabindex="-1"></a><span class="co"># drenas ----</span></span>
<span id="cb15-94"><a href="Ch04.html#cb15-94" tabindex="-1"></a></span>
<span id="cb15-95"><a href="Ch04.html#cb15-95" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-96"><a href="Ch04.html#cb15-96" tabindex="-1"></a></span>
<span id="cb15-97"><a href="Ch04.html#cb15-97" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-98"><a href="Ch04.html#cb15-98" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_drainpipes&quot;</span></span>
<span id="cb15-99"><a href="Ch04.html#cb15-99" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-100"><a href="Ch04.html#cb15-100" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-101"><a href="Ch04.html#cb15-101" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-102"><a href="Ch04.html#cb15-102" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_Drenas&quot;</span></span>
<span id="cb15-103"><a href="Ch04.html#cb15-103" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-104"><a href="Ch04.html#cb15-104" tabindex="-1"></a></span>
<span id="cb15-105"><a href="Ch04.html#cb15-105" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-106"><a href="Ch04.html#cb15-106" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-107"><a href="Ch04.html#cb15-107" tabindex="-1"></a>  </span>
<span id="cb15-108"><a href="Ch04.html#cb15-108" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-109"><a href="Ch04.html#cb15-109" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-110"><a href="Ch04.html#cb15-110" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-111"><a href="Ch04.html#cb15-111" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-112"><a href="Ch04.html#cb15-112" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-113"><a href="Ch04.html#cb15-113" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-114"><a href="Ch04.html#cb15-114" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-115"><a href="Ch04.html#cb15-115" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-116"><a href="Ch04.html#cb15-116" tabindex="-1"></a>  )</span>
<span id="cb15-117"><a href="Ch04.html#cb15-117" tabindex="-1"></a>  </span>
<span id="cb15-118"><a href="Ch04.html#cb15-118" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-119"><a href="Ch04.html#cb15-119" tabindex="-1"></a>  </span>
<span id="cb15-120"><a href="Ch04.html#cb15-120" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-121"><a href="Ch04.html#cb15-121" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-122"><a href="Ch04.html#cb15-122" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-123"><a href="Ch04.html#cb15-123" tabindex="-1"></a>    </span>
<span id="cb15-124"><a href="Ch04.html#cb15-124" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING</span></span>
<span id="cb15-125"><a href="Ch04.html#cb15-125" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-126"><a href="Ch04.html#cb15-126" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code)) <span class="sc">%&gt;%</span></span>
<span id="cb15-127"><a href="Ch04.html#cb15-127" tabindex="-1"></a>      <span class="fu">st_cast</span>(<span class="st">&quot;MULTILINESTRING&quot;</span>)</span>
<span id="cb15-128"><a href="Ch04.html#cb15-128" tabindex="-1"></a>    </span>
<span id="cb15-129"><a href="Ch04.html#cb15-129" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-130"><a href="Ch04.html#cb15-130" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-131"><a href="Ch04.html#cb15-131" tabindex="-1"></a>      chunk, </span>
<span id="cb15-132"><a href="Ch04.html#cb15-132" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-133"><a href="Ch04.html#cb15-133" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-134"><a href="Ch04.html#cb15-134" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-135"><a href="Ch04.html#cb15-135" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-136"><a href="Ch04.html#cb15-136" tabindex="-1"></a>    )</span>
<span id="cb15-137"><a href="Ch04.html#cb15-137" tabindex="-1"></a>    </span>
<span id="cb15-138"><a href="Ch04.html#cb15-138" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-139"><a href="Ch04.html#cb15-139" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-140"><a href="Ch04.html#cb15-140" tabindex="-1"></a>}</span>
<span id="cb15-141"><a href="Ch04.html#cb15-141" tabindex="-1"></a></span>
<span id="cb15-142"><a href="Ch04.html#cb15-142" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-143"><a href="Ch04.html#cb15-143" tabindex="-1"></a></span>
<span id="cb15-144"><a href="Ch04.html#cb15-144" tabindex="-1"></a>Drenas_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-145"><a href="Ch04.html#cb15-145" tabindex="-1"></a>                   <span class="at">layer=</span><span class="st">&quot;temp_Drenas&quot;</span>)</span>
<span id="cb15-146"><a href="Ch04.html#cb15-146" tabindex="-1"></a>Drenas_all2 <span class="ot">=</span> Drenas_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(Drenas_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 1</span></span>
<span id="cb15-147"><a href="Ch04.html#cb15-147" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(Drenas_all2))</span>
<span id="cb15-148"><a href="Ch04.html#cb15-148" tabindex="-1"></a></span>
<span id="cb15-149"><a href="Ch04.html#cb15-149" tabindex="-1"></a></span>
<span id="cb15-150"><a href="Ch04.html#cb15-150" tabindex="-1"></a><span class="fu">write_sf</span>(Drenas_all2,</span>
<span id="cb15-151"><a href="Ch04.html#cb15-151" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-152"><a href="Ch04.html#cb15-152" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;Drenas&quot;</span>,</span>
<span id="cb15-153"><a href="Ch04.html#cb15-153" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-154"><a href="Ch04.html#cb15-154" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-155"><a href="Ch04.html#cb15-155" tabindex="-1"></a></span>
<span id="cb15-156"><a href="Ch04.html#cb15-156" tabindex="-1"></a></span>
<span id="cb15-157"><a href="Ch04.html#cb15-157" tabindex="-1"></a></span>
<span id="cb15-158"><a href="Ch04.html#cb15-158" tabindex="-1"></a></span>
<span id="cb15-159"><a href="Ch04.html#cb15-159" tabindex="-1"></a><span class="co"># drenu kolektori ----</span></span>
<span id="cb15-160"><a href="Ch04.html#cb15-160" tabindex="-1"></a></span>
<span id="cb15-161"><a href="Ch04.html#cb15-161" tabindex="-1"></a></span>
<span id="cb15-162"><a href="Ch04.html#cb15-162" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-163"><a href="Ch04.html#cb15-163" tabindex="-1"></a></span>
<span id="cb15-164"><a href="Ch04.html#cb15-164" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-165"><a href="Ch04.html#cb15-165" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-166"><a href="Ch04.html#cb15-166" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-167"><a href="Ch04.html#cb15-167" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-168"><a href="Ch04.html#cb15-168" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-169"><a href="Ch04.html#cb15-169" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_draincollectors&quot;</span>,</span>
<span id="cb15-170"><a href="Ch04.html#cb15-170" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">1</span>)</span>
<span id="cb15-171"><a href="Ch04.html#cb15-171" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-172"><a href="Ch04.html#cb15-172" tabindex="-1"></a></span>
<span id="cb15-173"><a href="Ch04.html#cb15-173" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-174"><a href="Ch04.html#cb15-174" tabindex="-1"></a>geometrijam</span>
<span id="cb15-175"><a href="Ch04.html#cb15-175" tabindex="-1"></a></span>
<span id="cb15-176"><a href="Ch04.html#cb15-176" tabindex="-1"></a><span class="co"># skaitam</span></span>
<span id="cb15-177"><a href="Ch04.html#cb15-177" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-178"><a href="Ch04.html#cb15-178" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-179"><a href="Ch04.html#cb15-179" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-180"><a href="Ch04.html#cb15-180" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_draincollectors&quot;</span>,</span>
<span id="cb15-181"><a href="Ch04.html#cb15-181" tabindex="-1"></a>                  <span class="at">resultType=</span><span class="st">&quot;hits&quot;</span>)</span>
<span id="cb15-182"><a href="Ch04.html#cb15-182" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-183"><a href="Ch04.html#cb15-183" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">GET</span>(request)</span>
<span id="cb15-184"><a href="Ch04.html#cb15-184" tabindex="-1"></a>parsed <span class="ot">&lt;-</span> xml2<span class="sc">::</span><span class="fu">as_list</span>(<span class="fu">content</span>(result, <span class="st">&quot;parsed&quot;</span>))</span>
<span id="cb15-185"><a href="Ch04.html#cb15-185" tabindex="-1"></a>n_features <span class="ot">&lt;-</span> <span class="fu">attr</span>(parsed<span class="sc">$</span>FeatureCollection, <span class="st">&quot;numberMatched&quot;</span>)</span>
<span id="cb15-186"><a href="Ch04.html#cb15-186" tabindex="-1"></a>n_features</span>
<span id="cb15-187"><a href="Ch04.html#cb15-187" tabindex="-1"></a></span>
<span id="cb15-188"><a href="Ch04.html#cb15-188" tabindex="-1"></a></span>
<span id="cb15-189"><a href="Ch04.html#cb15-189" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-190"><a href="Ch04.html#cb15-190" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-191"><a href="Ch04.html#cb15-191" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_draincollectors&quot;</span></span>
<span id="cb15-192"><a href="Ch04.html#cb15-192" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-193"><a href="Ch04.html#cb15-193" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-194"><a href="Ch04.html#cb15-194" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-195"><a href="Ch04.html#cb15-195" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_DrenuKolektori&quot;</span></span>
<span id="cb15-196"><a href="Ch04.html#cb15-196" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-197"><a href="Ch04.html#cb15-197" tabindex="-1"></a></span>
<span id="cb15-198"><a href="Ch04.html#cb15-198" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-199"><a href="Ch04.html#cb15-199" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-200"><a href="Ch04.html#cb15-200" tabindex="-1"></a>  </span>
<span id="cb15-201"><a href="Ch04.html#cb15-201" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-202"><a href="Ch04.html#cb15-202" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-203"><a href="Ch04.html#cb15-203" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-204"><a href="Ch04.html#cb15-204" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-205"><a href="Ch04.html#cb15-205" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-206"><a href="Ch04.html#cb15-206" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-207"><a href="Ch04.html#cb15-207" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-208"><a href="Ch04.html#cb15-208" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-209"><a href="Ch04.html#cb15-209" tabindex="-1"></a>  )</span>
<span id="cb15-210"><a href="Ch04.html#cb15-210" tabindex="-1"></a>  </span>
<span id="cb15-211"><a href="Ch04.html#cb15-211" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-212"><a href="Ch04.html#cb15-212" tabindex="-1"></a>  </span>
<span id="cb15-213"><a href="Ch04.html#cb15-213" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-214"><a href="Ch04.html#cb15-214" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-215"><a href="Ch04.html#cb15-215" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-216"><a href="Ch04.html#cb15-216" tabindex="-1"></a>    </span>
<span id="cb15-217"><a href="Ch04.html#cb15-217" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING</span></span>
<span id="cb15-218"><a href="Ch04.html#cb15-218" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-219"><a href="Ch04.html#cb15-219" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code)) <span class="sc">%&gt;%</span></span>
<span id="cb15-220"><a href="Ch04.html#cb15-220" tabindex="-1"></a>      <span class="fu">st_cast</span>(<span class="st">&quot;MULTILINESTRING&quot;</span>)</span>
<span id="cb15-221"><a href="Ch04.html#cb15-221" tabindex="-1"></a>    </span>
<span id="cb15-222"><a href="Ch04.html#cb15-222" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-223"><a href="Ch04.html#cb15-223" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-224"><a href="Ch04.html#cb15-224" tabindex="-1"></a>      chunk, </span>
<span id="cb15-225"><a href="Ch04.html#cb15-225" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-226"><a href="Ch04.html#cb15-226" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-227"><a href="Ch04.html#cb15-227" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-228"><a href="Ch04.html#cb15-228" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-229"><a href="Ch04.html#cb15-229" tabindex="-1"></a>    )</span>
<span id="cb15-230"><a href="Ch04.html#cb15-230" tabindex="-1"></a>    </span>
<span id="cb15-231"><a href="Ch04.html#cb15-231" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-232"><a href="Ch04.html#cb15-232" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-233"><a href="Ch04.html#cb15-233" tabindex="-1"></a>}</span>
<span id="cb15-234"><a href="Ch04.html#cb15-234" tabindex="-1"></a></span>
<span id="cb15-235"><a href="Ch04.html#cb15-235" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-236"><a href="Ch04.html#cb15-236" tabindex="-1"></a></span>
<span id="cb15-237"><a href="Ch04.html#cb15-237" tabindex="-1"></a>DrenuKolektori_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-238"><a href="Ch04.html#cb15-238" tabindex="-1"></a>                           <span class="at">layer=</span><span class="st">&quot;temp_DrenuKolektori&quot;</span>)</span>
<span id="cb15-239"><a href="Ch04.html#cb15-239" tabindex="-1"></a>DrenuKolektori_all2 <span class="ot">=</span> DrenuKolektori_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(DrenuKolektori_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 1</span></span>
<span id="cb15-240"><a href="Ch04.html#cb15-240" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(DrenuKolektori_all2))</span>
<span id="cb15-241"><a href="Ch04.html#cb15-241" tabindex="-1"></a></span>
<span id="cb15-242"><a href="Ch04.html#cb15-242" tabindex="-1"></a></span>
<span id="cb15-243"><a href="Ch04.html#cb15-243" tabindex="-1"></a><span class="fu">write_sf</span>(DrenuKolektori_all2,</span>
<span id="cb15-244"><a href="Ch04.html#cb15-244" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-245"><a href="Ch04.html#cb15-245" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;DrenuKolektori&quot;</span>,</span>
<span id="cb15-246"><a href="Ch04.html#cb15-246" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-247"><a href="Ch04.html#cb15-247" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-248"><a href="Ch04.html#cb15-248" tabindex="-1"></a></span>
<span id="cb15-249"><a href="Ch04.html#cb15-249" tabindex="-1"></a></span>
<span id="cb15-250"><a href="Ch04.html#cb15-250" tabindex="-1"></a></span>
<span id="cb15-251"><a href="Ch04.html#cb15-251" tabindex="-1"></a></span>
<span id="cb15-252"><a href="Ch04.html#cb15-252" tabindex="-1"></a><span class="co"># drenazas tikla būves ----</span></span>
<span id="cb15-253"><a href="Ch04.html#cb15-253" tabindex="-1"></a></span>
<span id="cb15-254"><a href="Ch04.html#cb15-254" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-255"><a href="Ch04.html#cb15-255" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-256"><a href="Ch04.html#cb15-256" tabindex="-1"></a></span>
<span id="cb15-257"><a href="Ch04.html#cb15-257" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-258"><a href="Ch04.html#cb15-258" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-259"><a href="Ch04.html#cb15-259" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-260"><a href="Ch04.html#cb15-260" tabindex="-1"></a></span>
<span id="cb15-261"><a href="Ch04.html#cb15-261" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-262"><a href="Ch04.html#cb15-262" tabindex="-1"></a></span>
<span id="cb15-263"><a href="Ch04.html#cb15-263" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-264"><a href="Ch04.html#cb15-264" tabindex="-1"></a></span>
<span id="cb15-265"><a href="Ch04.html#cb15-265" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-266"><a href="Ch04.html#cb15-266" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-267"><a href="Ch04.html#cb15-267" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-268"><a href="Ch04.html#cb15-268" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_networkstructures&quot;</span>,</span>
<span id="cb15-269"><a href="Ch04.html#cb15-269" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">1</span>)</span>
<span id="cb15-270"><a href="Ch04.html#cb15-270" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-271"><a href="Ch04.html#cb15-271" tabindex="-1"></a></span>
<span id="cb15-272"><a href="Ch04.html#cb15-272" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-273"><a href="Ch04.html#cb15-273" tabindex="-1"></a>geometrijam</span>
<span id="cb15-274"><a href="Ch04.html#cb15-274" tabindex="-1"></a></span>
<span id="cb15-275"><a href="Ch04.html#cb15-275" tabindex="-1"></a></span>
<span id="cb15-276"><a href="Ch04.html#cb15-276" tabindex="-1"></a></span>
<span id="cb15-277"><a href="Ch04.html#cb15-277" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-278"><a href="Ch04.html#cb15-278" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-279"><a href="Ch04.html#cb15-279" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_networkstructures&quot;</span></span>
<span id="cb15-280"><a href="Ch04.html#cb15-280" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-281"><a href="Ch04.html#cb15-281" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-282"><a href="Ch04.html#cb15-282" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-283"><a href="Ch04.html#cb15-283" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_DrenazasTiklaBuves&quot;</span></span>
<span id="cb15-284"><a href="Ch04.html#cb15-284" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-285"><a href="Ch04.html#cb15-285" tabindex="-1"></a></span>
<span id="cb15-286"><a href="Ch04.html#cb15-286" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-287"><a href="Ch04.html#cb15-287" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-288"><a href="Ch04.html#cb15-288" tabindex="-1"></a>  </span>
<span id="cb15-289"><a href="Ch04.html#cb15-289" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-290"><a href="Ch04.html#cb15-290" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-291"><a href="Ch04.html#cb15-291" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-292"><a href="Ch04.html#cb15-292" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-293"><a href="Ch04.html#cb15-293" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-294"><a href="Ch04.html#cb15-294" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-295"><a href="Ch04.html#cb15-295" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-296"><a href="Ch04.html#cb15-296" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-297"><a href="Ch04.html#cb15-297" tabindex="-1"></a>  )</span>
<span id="cb15-298"><a href="Ch04.html#cb15-298" tabindex="-1"></a>  </span>
<span id="cb15-299"><a href="Ch04.html#cb15-299" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-300"><a href="Ch04.html#cb15-300" tabindex="-1"></a>  </span>
<span id="cb15-301"><a href="Ch04.html#cb15-301" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-302"><a href="Ch04.html#cb15-302" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-303"><a href="Ch04.html#cb15-303" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-304"><a href="Ch04.html#cb15-304" tabindex="-1"></a>    </span>
<span id="cb15-305"><a href="Ch04.html#cb15-305" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING</span></span>
<span id="cb15-306"><a href="Ch04.html#cb15-306" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-307"><a href="Ch04.html#cb15-307" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code)) <span class="sc">%&gt;%</span></span>
<span id="cb15-308"><a href="Ch04.html#cb15-308" tabindex="-1"></a>      <span class="fu">st_cast</span>(<span class="st">&quot;POINT&quot;</span>)</span>
<span id="cb15-309"><a href="Ch04.html#cb15-309" tabindex="-1"></a>    </span>
<span id="cb15-310"><a href="Ch04.html#cb15-310" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-311"><a href="Ch04.html#cb15-311" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-312"><a href="Ch04.html#cb15-312" tabindex="-1"></a>      chunk, </span>
<span id="cb15-313"><a href="Ch04.html#cb15-313" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-314"><a href="Ch04.html#cb15-314" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-315"><a href="Ch04.html#cb15-315" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-316"><a href="Ch04.html#cb15-316" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-317"><a href="Ch04.html#cb15-317" tabindex="-1"></a>    )</span>
<span id="cb15-318"><a href="Ch04.html#cb15-318" tabindex="-1"></a>    </span>
<span id="cb15-319"><a href="Ch04.html#cb15-319" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-320"><a href="Ch04.html#cb15-320" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-321"><a href="Ch04.html#cb15-321" tabindex="-1"></a>}</span>
<span id="cb15-322"><a href="Ch04.html#cb15-322" tabindex="-1"></a></span>
<span id="cb15-323"><a href="Ch04.html#cb15-323" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-324"><a href="Ch04.html#cb15-324" tabindex="-1"></a></span>
<span id="cb15-325"><a href="Ch04.html#cb15-325" tabindex="-1"></a>DrenazasTiklaBuves_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-326"><a href="Ch04.html#cb15-326" tabindex="-1"></a>                               <span class="at">layer=</span><span class="st">&quot;temp_DrenazasTiklaBuves&quot;</span>)</span>
<span id="cb15-327"><a href="Ch04.html#cb15-327" tabindex="-1"></a>DrenazasTiklaBuves_all2 <span class="ot">=</span> DrenazasTiklaBuves_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(DrenazasTiklaBuves_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-328"><a href="Ch04.html#cb15-328" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(DrenazasTiklaBuves_all2))</span>
<span id="cb15-329"><a href="Ch04.html#cb15-329" tabindex="-1"></a></span>
<span id="cb15-330"><a href="Ch04.html#cb15-330" tabindex="-1"></a></span>
<span id="cb15-331"><a href="Ch04.html#cb15-331" tabindex="-1"></a><span class="fu">write_sf</span>(DrenazasTiklaBuves_all2,</span>
<span id="cb15-332"><a href="Ch04.html#cb15-332" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-333"><a href="Ch04.html#cb15-333" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;DrenazasTiklaBuves&quot;</span>,</span>
<span id="cb15-334"><a href="Ch04.html#cb15-334" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-335"><a href="Ch04.html#cb15-335" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-336"><a href="Ch04.html#cb15-336" tabindex="-1"></a></span>
<span id="cb15-337"><a href="Ch04.html#cb15-337" tabindex="-1"></a></span>
<span id="cb15-338"><a href="Ch04.html#cb15-338" tabindex="-1"></a></span>
<span id="cb15-339"><a href="Ch04.html#cb15-339" tabindex="-1"></a></span>
<span id="cb15-340"><a href="Ch04.html#cb15-340" tabindex="-1"></a><span class="co"># gravji -----</span></span>
<span id="cb15-341"><a href="Ch04.html#cb15-341" tabindex="-1"></a></span>
<span id="cb15-342"><a href="Ch04.html#cb15-342" tabindex="-1"></a></span>
<span id="cb15-343"><a href="Ch04.html#cb15-343" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-344"><a href="Ch04.html#cb15-344" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-345"><a href="Ch04.html#cb15-345" tabindex="-1"></a></span>
<span id="cb15-346"><a href="Ch04.html#cb15-346" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-347"><a href="Ch04.html#cb15-347" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-348"><a href="Ch04.html#cb15-348" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-349"><a href="Ch04.html#cb15-349" tabindex="-1"></a></span>
<span id="cb15-350"><a href="Ch04.html#cb15-350" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-351"><a href="Ch04.html#cb15-351" tabindex="-1"></a></span>
<span id="cb15-352"><a href="Ch04.html#cb15-352" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-353"><a href="Ch04.html#cb15-353" tabindex="-1"></a></span>
<span id="cb15-354"><a href="Ch04.html#cb15-354" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-355"><a href="Ch04.html#cb15-355" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-356"><a href="Ch04.html#cb15-356" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-357"><a href="Ch04.html#cb15-357" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_ditches&quot;</span>,</span>
<span id="cb15-358"><a href="Ch04.html#cb15-358" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">100</span>)</span>
<span id="cb15-359"><a href="Ch04.html#cb15-359" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-360"><a href="Ch04.html#cb15-360" tabindex="-1"></a></span>
<span id="cb15-361"><a href="Ch04.html#cb15-361" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-362"><a href="Ch04.html#cb15-362" tabindex="-1"></a>geometrijam</span>
<span id="cb15-363"><a href="Ch04.html#cb15-363" tabindex="-1"></a></span>
<span id="cb15-364"><a href="Ch04.html#cb15-364" tabindex="-1"></a></span>
<span id="cb15-365"><a href="Ch04.html#cb15-365" tabindex="-1"></a></span>
<span id="cb15-366"><a href="Ch04.html#cb15-366" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-367"><a href="Ch04.html#cb15-367" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-368"><a href="Ch04.html#cb15-368" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_ditches&quot;</span></span>
<span id="cb15-369"><a href="Ch04.html#cb15-369" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-370"><a href="Ch04.html#cb15-370" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-371"><a href="Ch04.html#cb15-371" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-372"><a href="Ch04.html#cb15-372" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_Gravji&quot;</span></span>
<span id="cb15-373"><a href="Ch04.html#cb15-373" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-374"><a href="Ch04.html#cb15-374" tabindex="-1"></a></span>
<span id="cb15-375"><a href="Ch04.html#cb15-375" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-376"><a href="Ch04.html#cb15-376" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-377"><a href="Ch04.html#cb15-377" tabindex="-1"></a>  </span>
<span id="cb15-378"><a href="Ch04.html#cb15-378" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-379"><a href="Ch04.html#cb15-379" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-380"><a href="Ch04.html#cb15-380" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-381"><a href="Ch04.html#cb15-381" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-382"><a href="Ch04.html#cb15-382" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-383"><a href="Ch04.html#cb15-383" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-384"><a href="Ch04.html#cb15-384" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-385"><a href="Ch04.html#cb15-385" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-386"><a href="Ch04.html#cb15-386" tabindex="-1"></a>  )</span>
<span id="cb15-387"><a href="Ch04.html#cb15-387" tabindex="-1"></a>  </span>
<span id="cb15-388"><a href="Ch04.html#cb15-388" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-389"><a href="Ch04.html#cb15-389" tabindex="-1"></a>  </span>
<span id="cb15-390"><a href="Ch04.html#cb15-390" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-391"><a href="Ch04.html#cb15-391" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-392"><a href="Ch04.html#cb15-392" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-393"><a href="Ch04.html#cb15-393" tabindex="-1"></a>    </span>
<span id="cb15-394"><a href="Ch04.html#cb15-394" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING</span></span>
<span id="cb15-395"><a href="Ch04.html#cb15-395" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-396"><a href="Ch04.html#cb15-396" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code)) <span class="sc">%&gt;%</span></span>
<span id="cb15-397"><a href="Ch04.html#cb15-397" tabindex="-1"></a>      <span class="fu">st_cast</span>(<span class="st">&quot;MULTILINESTRING&quot;</span>)</span>
<span id="cb15-398"><a href="Ch04.html#cb15-398" tabindex="-1"></a>    </span>
<span id="cb15-399"><a href="Ch04.html#cb15-399" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-400"><a href="Ch04.html#cb15-400" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-401"><a href="Ch04.html#cb15-401" tabindex="-1"></a>      chunk, </span>
<span id="cb15-402"><a href="Ch04.html#cb15-402" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-403"><a href="Ch04.html#cb15-403" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-404"><a href="Ch04.html#cb15-404" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-405"><a href="Ch04.html#cb15-405" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-406"><a href="Ch04.html#cb15-406" tabindex="-1"></a>    )</span>
<span id="cb15-407"><a href="Ch04.html#cb15-407" tabindex="-1"></a>    </span>
<span id="cb15-408"><a href="Ch04.html#cb15-408" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-409"><a href="Ch04.html#cb15-409" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-410"><a href="Ch04.html#cb15-410" tabindex="-1"></a>}</span>
<span id="cb15-411"><a href="Ch04.html#cb15-411" tabindex="-1"></a></span>
<span id="cb15-412"><a href="Ch04.html#cb15-412" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-413"><a href="Ch04.html#cb15-413" tabindex="-1"></a></span>
<span id="cb15-414"><a href="Ch04.html#cb15-414" tabindex="-1"></a>Gravji_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-415"><a href="Ch04.html#cb15-415" tabindex="-1"></a>                   <span class="at">layer=</span><span class="st">&quot;temp_Gravji&quot;</span>)</span>
<span id="cb15-416"><a href="Ch04.html#cb15-416" tabindex="-1"></a>Gravji_all2 <span class="ot">=</span> Gravji_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(Gravji_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-417"><a href="Ch04.html#cb15-417" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(Gravji_all2))</span>
<span id="cb15-418"><a href="Ch04.html#cb15-418" tabindex="-1"></a></span>
<span id="cb15-419"><a href="Ch04.html#cb15-419" tabindex="-1"></a></span>
<span id="cb15-420"><a href="Ch04.html#cb15-420" tabindex="-1"></a><span class="fu">write_sf</span>(Gravji_all2,</span>
<span id="cb15-421"><a href="Ch04.html#cb15-421" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-422"><a href="Ch04.html#cb15-422" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;Gravji&quot;</span>,</span>
<span id="cb15-423"><a href="Ch04.html#cb15-423" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-424"><a href="Ch04.html#cb15-424" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-425"><a href="Ch04.html#cb15-425" tabindex="-1"></a></span>
<span id="cb15-426"><a href="Ch04.html#cb15-426" tabindex="-1"></a></span>
<span id="cb15-427"><a href="Ch04.html#cb15-427" tabindex="-1"></a></span>
<span id="cb15-428"><a href="Ch04.html#cb15-428" tabindex="-1"></a></span>
<span id="cb15-429"><a href="Ch04.html#cb15-429" tabindex="-1"></a><span class="co"># hidrometriskie posteni ----</span></span>
<span id="cb15-430"><a href="Ch04.html#cb15-430" tabindex="-1"></a></span>
<span id="cb15-431"><a href="Ch04.html#cb15-431" tabindex="-1"></a></span>
<span id="cb15-432"><a href="Ch04.html#cb15-432" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-433"><a href="Ch04.html#cb15-433" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-434"><a href="Ch04.html#cb15-434" tabindex="-1"></a></span>
<span id="cb15-435"><a href="Ch04.html#cb15-435" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-436"><a href="Ch04.html#cb15-436" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-437"><a href="Ch04.html#cb15-437" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-438"><a href="Ch04.html#cb15-438" tabindex="-1"></a></span>
<span id="cb15-439"><a href="Ch04.html#cb15-439" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-440"><a href="Ch04.html#cb15-440" tabindex="-1"></a></span>
<span id="cb15-441"><a href="Ch04.html#cb15-441" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-442"><a href="Ch04.html#cb15-442" tabindex="-1"></a></span>
<span id="cb15-443"><a href="Ch04.html#cb15-443" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-444"><a href="Ch04.html#cb15-444" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-445"><a href="Ch04.html#cb15-445" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-446"><a href="Ch04.html#cb15-446" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_hydropost&quot;</span>,</span>
<span id="cb15-447"><a href="Ch04.html#cb15-447" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">100</span>)</span>
<span id="cb15-448"><a href="Ch04.html#cb15-448" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-449"><a href="Ch04.html#cb15-449" tabindex="-1"></a></span>
<span id="cb15-450"><a href="Ch04.html#cb15-450" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-451"><a href="Ch04.html#cb15-451" tabindex="-1"></a>geometrijam</span>
<span id="cb15-452"><a href="Ch04.html#cb15-452" tabindex="-1"></a></span>
<span id="cb15-453"><a href="Ch04.html#cb15-453" tabindex="-1"></a></span>
<span id="cb15-454"><a href="Ch04.html#cb15-454" tabindex="-1"></a></span>
<span id="cb15-455"><a href="Ch04.html#cb15-455" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-456"><a href="Ch04.html#cb15-456" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-457"><a href="Ch04.html#cb15-457" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_hydropost&quot;</span></span>
<span id="cb15-458"><a href="Ch04.html#cb15-458" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-459"><a href="Ch04.html#cb15-459" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-460"><a href="Ch04.html#cb15-460" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./IevadesDati/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-461"><a href="Ch04.html#cb15-461" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_HidrometriskiePosteni&quot;</span></span>
<span id="cb15-462"><a href="Ch04.html#cb15-462" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-463"><a href="Ch04.html#cb15-463" tabindex="-1"></a></span>
<span id="cb15-464"><a href="Ch04.html#cb15-464" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-465"><a href="Ch04.html#cb15-465" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-466"><a href="Ch04.html#cb15-466" tabindex="-1"></a>  </span>
<span id="cb15-467"><a href="Ch04.html#cb15-467" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-468"><a href="Ch04.html#cb15-468" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-469"><a href="Ch04.html#cb15-469" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-470"><a href="Ch04.html#cb15-470" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-471"><a href="Ch04.html#cb15-471" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-472"><a href="Ch04.html#cb15-472" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-473"><a href="Ch04.html#cb15-473" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-474"><a href="Ch04.html#cb15-474" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-475"><a href="Ch04.html#cb15-475" tabindex="-1"></a>  )</span>
<span id="cb15-476"><a href="Ch04.html#cb15-476" tabindex="-1"></a>  </span>
<span id="cb15-477"><a href="Ch04.html#cb15-477" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-478"><a href="Ch04.html#cb15-478" tabindex="-1"></a>  </span>
<span id="cb15-479"><a href="Ch04.html#cb15-479" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-480"><a href="Ch04.html#cb15-480" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-481"><a href="Ch04.html#cb15-481" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-482"><a href="Ch04.html#cb15-482" tabindex="-1"></a>    </span>
<span id="cb15-483"><a href="Ch04.html#cb15-483" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING, POINT, MULTIPOLYGON</span></span>
<span id="cb15-484"><a href="Ch04.html#cb15-484" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-485"><a href="Ch04.html#cb15-485" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code)) <span class="sc">%&gt;%</span></span>
<span id="cb15-486"><a href="Ch04.html#cb15-486" tabindex="-1"></a>      <span class="fu">st_cast</span>(<span class="st">&quot;POINT&quot;</span>)</span>
<span id="cb15-487"><a href="Ch04.html#cb15-487" tabindex="-1"></a>    </span>
<span id="cb15-488"><a href="Ch04.html#cb15-488" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-489"><a href="Ch04.html#cb15-489" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-490"><a href="Ch04.html#cb15-490" tabindex="-1"></a>      chunk, </span>
<span id="cb15-491"><a href="Ch04.html#cb15-491" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-492"><a href="Ch04.html#cb15-492" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-493"><a href="Ch04.html#cb15-493" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-494"><a href="Ch04.html#cb15-494" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-495"><a href="Ch04.html#cb15-495" tabindex="-1"></a>    )</span>
<span id="cb15-496"><a href="Ch04.html#cb15-496" tabindex="-1"></a>    </span>
<span id="cb15-497"><a href="Ch04.html#cb15-497" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-498"><a href="Ch04.html#cb15-498" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-499"><a href="Ch04.html#cb15-499" tabindex="-1"></a>}</span>
<span id="cb15-500"><a href="Ch04.html#cb15-500" tabindex="-1"></a></span>
<span id="cb15-501"><a href="Ch04.html#cb15-501" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-502"><a href="Ch04.html#cb15-502" tabindex="-1"></a></span>
<span id="cb15-503"><a href="Ch04.html#cb15-503" tabindex="-1"></a>HidrometriskiePosteni_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-504"><a href="Ch04.html#cb15-504" tabindex="-1"></a>                                  <span class="at">layer=</span><span class="st">&quot;temp_HidrometriskiePosteni&quot;</span>)</span>
<span id="cb15-505"><a href="Ch04.html#cb15-505" tabindex="-1"></a>HidrometriskiePosteni_all2 <span class="ot">=</span> HidrometriskiePosteni_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(HidrometriskiePosteni_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-506"><a href="Ch04.html#cb15-506" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(HidrometriskiePosteni_all2))</span>
<span id="cb15-507"><a href="Ch04.html#cb15-507" tabindex="-1"></a></span>
<span id="cb15-508"><a href="Ch04.html#cb15-508" tabindex="-1"></a></span>
<span id="cb15-509"><a href="Ch04.html#cb15-509" tabindex="-1"></a><span class="fu">write_sf</span>(HidrometriskiePosteni_all2,</span>
<span id="cb15-510"><a href="Ch04.html#cb15-510" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-511"><a href="Ch04.html#cb15-511" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;HidrometriskiePosteni&quot;</span>,</span>
<span id="cb15-512"><a href="Ch04.html#cb15-512" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-513"><a href="Ch04.html#cb15-513" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-514"><a href="Ch04.html#cb15-514" tabindex="-1"></a></span>
<span id="cb15-515"><a href="Ch04.html#cb15-515" tabindex="-1"></a></span>
<span id="cb15-516"><a href="Ch04.html#cb15-516" tabindex="-1"></a><span class="co"># liela diametra kolektori ----</span></span>
<span id="cb15-517"><a href="Ch04.html#cb15-517" tabindex="-1"></a></span>
<span id="cb15-518"><a href="Ch04.html#cb15-518" tabindex="-1"></a></span>
<span id="cb15-519"><a href="Ch04.html#cb15-519" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-520"><a href="Ch04.html#cb15-520" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-521"><a href="Ch04.html#cb15-521" tabindex="-1"></a></span>
<span id="cb15-522"><a href="Ch04.html#cb15-522" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-523"><a href="Ch04.html#cb15-523" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-524"><a href="Ch04.html#cb15-524" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-525"><a href="Ch04.html#cb15-525" tabindex="-1"></a></span>
<span id="cb15-526"><a href="Ch04.html#cb15-526" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-527"><a href="Ch04.html#cb15-527" tabindex="-1"></a></span>
<span id="cb15-528"><a href="Ch04.html#cb15-528" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-529"><a href="Ch04.html#cb15-529" tabindex="-1"></a></span>
<span id="cb15-530"><a href="Ch04.html#cb15-530" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-531"><a href="Ch04.html#cb15-531" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-532"><a href="Ch04.html#cb15-532" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-533"><a href="Ch04.html#cb15-533" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_bigdraincollectors&quot;</span>,</span>
<span id="cb15-534"><a href="Ch04.html#cb15-534" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">100</span>)</span>
<span id="cb15-535"><a href="Ch04.html#cb15-535" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-536"><a href="Ch04.html#cb15-536" tabindex="-1"></a></span>
<span id="cb15-537"><a href="Ch04.html#cb15-537" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-538"><a href="Ch04.html#cb15-538" tabindex="-1"></a>geometrijam</span>
<span id="cb15-539"><a href="Ch04.html#cb15-539" tabindex="-1"></a></span>
<span id="cb15-540"><a href="Ch04.html#cb15-540" tabindex="-1"></a></span>
<span id="cb15-541"><a href="Ch04.html#cb15-541" tabindex="-1"></a></span>
<span id="cb15-542"><a href="Ch04.html#cb15-542" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-543"><a href="Ch04.html#cb15-543" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-544"><a href="Ch04.html#cb15-544" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_bigdraincollectors&quot;</span></span>
<span id="cb15-545"><a href="Ch04.html#cb15-545" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-546"><a href="Ch04.html#cb15-546" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-547"><a href="Ch04.html#cb15-547" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-548"><a href="Ch04.html#cb15-548" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_LielaDiametraKolektori&quot;</span></span>
<span id="cb15-549"><a href="Ch04.html#cb15-549" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-550"><a href="Ch04.html#cb15-550" tabindex="-1"></a></span>
<span id="cb15-551"><a href="Ch04.html#cb15-551" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-552"><a href="Ch04.html#cb15-552" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-553"><a href="Ch04.html#cb15-553" tabindex="-1"></a>  </span>
<span id="cb15-554"><a href="Ch04.html#cb15-554" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-555"><a href="Ch04.html#cb15-555" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-556"><a href="Ch04.html#cb15-556" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-557"><a href="Ch04.html#cb15-557" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-558"><a href="Ch04.html#cb15-558" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-559"><a href="Ch04.html#cb15-559" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-560"><a href="Ch04.html#cb15-560" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-561"><a href="Ch04.html#cb15-561" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-562"><a href="Ch04.html#cb15-562" tabindex="-1"></a>  )</span>
<span id="cb15-563"><a href="Ch04.html#cb15-563" tabindex="-1"></a>  </span>
<span id="cb15-564"><a href="Ch04.html#cb15-564" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-565"><a href="Ch04.html#cb15-565" tabindex="-1"></a>  </span>
<span id="cb15-566"><a href="Ch04.html#cb15-566" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-567"><a href="Ch04.html#cb15-567" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-568"><a href="Ch04.html#cb15-568" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-569"><a href="Ch04.html#cb15-569" tabindex="-1"></a>    </span>
<span id="cb15-570"><a href="Ch04.html#cb15-570" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING, POINT, MULTIPOLYGON</span></span>
<span id="cb15-571"><a href="Ch04.html#cb15-571" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-572"><a href="Ch04.html#cb15-572" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code)) <span class="sc">%&gt;%</span></span>
<span id="cb15-573"><a href="Ch04.html#cb15-573" tabindex="-1"></a>      <span class="fu">st_cast</span>(<span class="st">&quot;MULTILINESTRING&quot;</span>)</span>
<span id="cb15-574"><a href="Ch04.html#cb15-574" tabindex="-1"></a>    </span>
<span id="cb15-575"><a href="Ch04.html#cb15-575" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-576"><a href="Ch04.html#cb15-576" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-577"><a href="Ch04.html#cb15-577" tabindex="-1"></a>      chunk, </span>
<span id="cb15-578"><a href="Ch04.html#cb15-578" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-579"><a href="Ch04.html#cb15-579" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-580"><a href="Ch04.html#cb15-580" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-581"><a href="Ch04.html#cb15-581" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-582"><a href="Ch04.html#cb15-582" tabindex="-1"></a>    )</span>
<span id="cb15-583"><a href="Ch04.html#cb15-583" tabindex="-1"></a>    </span>
<span id="cb15-584"><a href="Ch04.html#cb15-584" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-585"><a href="Ch04.html#cb15-585" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-586"><a href="Ch04.html#cb15-586" tabindex="-1"></a>}</span>
<span id="cb15-587"><a href="Ch04.html#cb15-587" tabindex="-1"></a></span>
<span id="cb15-588"><a href="Ch04.html#cb15-588" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-589"><a href="Ch04.html#cb15-589" tabindex="-1"></a></span>
<span id="cb15-590"><a href="Ch04.html#cb15-590" tabindex="-1"></a>LielaDiametraKolektori_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-591"><a href="Ch04.html#cb15-591" tabindex="-1"></a>                                   <span class="at">layer=</span><span class="st">&quot;temp_LielaDiametraKolektori&quot;</span>)</span>
<span id="cb15-592"><a href="Ch04.html#cb15-592" tabindex="-1"></a>LielaDiametraKolektori_all2 <span class="ot">=</span> LielaDiametraKolektori_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(LielaDiametraKolektori_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-593"><a href="Ch04.html#cb15-593" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(LielaDiametraKolektori_all2))</span>
<span id="cb15-594"><a href="Ch04.html#cb15-594" tabindex="-1"></a></span>
<span id="cb15-595"><a href="Ch04.html#cb15-595" tabindex="-1"></a></span>
<span id="cb15-596"><a href="Ch04.html#cb15-596" tabindex="-1"></a><span class="fu">write_sf</span>(LielaDiametraKolektori_all2,</span>
<span id="cb15-597"><a href="Ch04.html#cb15-597" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-598"><a href="Ch04.html#cb15-598" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;LielaDiametraKolektori&quot;</span>,</span>
<span id="cb15-599"><a href="Ch04.html#cb15-599" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-600"><a href="Ch04.html#cb15-600" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-601"><a href="Ch04.html#cb15-601" tabindex="-1"></a></span>
<span id="cb15-602"><a href="Ch04.html#cb15-602" tabindex="-1"></a></span>
<span id="cb15-603"><a href="Ch04.html#cb15-603" tabindex="-1"></a></span>
<span id="cb15-604"><a href="Ch04.html#cb15-604" tabindex="-1"></a></span>
<span id="cb15-605"><a href="Ch04.html#cb15-605" tabindex="-1"></a><span class="co"># piketi ----</span></span>
<span id="cb15-606"><a href="Ch04.html#cb15-606" tabindex="-1"></a></span>
<span id="cb15-607"><a href="Ch04.html#cb15-607" tabindex="-1"></a></span>
<span id="cb15-608"><a href="Ch04.html#cb15-608" tabindex="-1"></a></span>
<span id="cb15-609"><a href="Ch04.html#cb15-609" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-610"><a href="Ch04.html#cb15-610" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-611"><a href="Ch04.html#cb15-611" tabindex="-1"></a></span>
<span id="cb15-612"><a href="Ch04.html#cb15-612" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-613"><a href="Ch04.html#cb15-613" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-614"><a href="Ch04.html#cb15-614" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-615"><a href="Ch04.html#cb15-615" tabindex="-1"></a></span>
<span id="cb15-616"><a href="Ch04.html#cb15-616" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-617"><a href="Ch04.html#cb15-617" tabindex="-1"></a></span>
<span id="cb15-618"><a href="Ch04.html#cb15-618" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-619"><a href="Ch04.html#cb15-619" tabindex="-1"></a></span>
<span id="cb15-620"><a href="Ch04.html#cb15-620" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-621"><a href="Ch04.html#cb15-621" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-622"><a href="Ch04.html#cb15-622" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-623"><a href="Ch04.html#cb15-623" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_stateriverspickets&quot;</span>,</span>
<span id="cb15-624"><a href="Ch04.html#cb15-624" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">100</span>)</span>
<span id="cb15-625"><a href="Ch04.html#cb15-625" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-626"><a href="Ch04.html#cb15-626" tabindex="-1"></a></span>
<span id="cb15-627"><a href="Ch04.html#cb15-627" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-628"><a href="Ch04.html#cb15-628" tabindex="-1"></a>geometrijam</span>
<span id="cb15-629"><a href="Ch04.html#cb15-629" tabindex="-1"></a></span>
<span id="cb15-630"><a href="Ch04.html#cb15-630" tabindex="-1"></a></span>
<span id="cb15-631"><a href="Ch04.html#cb15-631" tabindex="-1"></a></span>
<span id="cb15-632"><a href="Ch04.html#cb15-632" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-633"><a href="Ch04.html#cb15-633" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-634"><a href="Ch04.html#cb15-634" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_stateriverspickets&quot;</span></span>
<span id="cb15-635"><a href="Ch04.html#cb15-635" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-636"><a href="Ch04.html#cb15-636" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-637"><a href="Ch04.html#cb15-637" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-638"><a href="Ch04.html#cb15-638" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_Piketi&quot;</span></span>
<span id="cb15-639"><a href="Ch04.html#cb15-639" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-640"><a href="Ch04.html#cb15-640" tabindex="-1"></a></span>
<span id="cb15-641"><a href="Ch04.html#cb15-641" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-642"><a href="Ch04.html#cb15-642" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-643"><a href="Ch04.html#cb15-643" tabindex="-1"></a>  </span>
<span id="cb15-644"><a href="Ch04.html#cb15-644" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-645"><a href="Ch04.html#cb15-645" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-646"><a href="Ch04.html#cb15-646" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-647"><a href="Ch04.html#cb15-647" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-648"><a href="Ch04.html#cb15-648" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-649"><a href="Ch04.html#cb15-649" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-650"><a href="Ch04.html#cb15-650" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-651"><a href="Ch04.html#cb15-651" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-652"><a href="Ch04.html#cb15-652" tabindex="-1"></a>  )</span>
<span id="cb15-653"><a href="Ch04.html#cb15-653" tabindex="-1"></a>  </span>
<span id="cb15-654"><a href="Ch04.html#cb15-654" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-655"><a href="Ch04.html#cb15-655" tabindex="-1"></a>  </span>
<span id="cb15-656"><a href="Ch04.html#cb15-656" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-657"><a href="Ch04.html#cb15-657" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-658"><a href="Ch04.html#cb15-658" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-659"><a href="Ch04.html#cb15-659" tabindex="-1"></a>    </span>
<span id="cb15-660"><a href="Ch04.html#cb15-660" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING, POINT, MULTIPOLYGON</span></span>
<span id="cb15-661"><a href="Ch04.html#cb15-661" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-662"><a href="Ch04.html#cb15-662" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code)) <span class="sc">%&gt;%</span></span>
<span id="cb15-663"><a href="Ch04.html#cb15-663" tabindex="-1"></a>      <span class="fu">st_cast</span>(<span class="st">&quot;POINT&quot;</span>)</span>
<span id="cb15-664"><a href="Ch04.html#cb15-664" tabindex="-1"></a>    </span>
<span id="cb15-665"><a href="Ch04.html#cb15-665" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-666"><a href="Ch04.html#cb15-666" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-667"><a href="Ch04.html#cb15-667" tabindex="-1"></a>      chunk, </span>
<span id="cb15-668"><a href="Ch04.html#cb15-668" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-669"><a href="Ch04.html#cb15-669" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-670"><a href="Ch04.html#cb15-670" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-671"><a href="Ch04.html#cb15-671" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-672"><a href="Ch04.html#cb15-672" tabindex="-1"></a>    )</span>
<span id="cb15-673"><a href="Ch04.html#cb15-673" tabindex="-1"></a>    </span>
<span id="cb15-674"><a href="Ch04.html#cb15-674" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-675"><a href="Ch04.html#cb15-675" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-676"><a href="Ch04.html#cb15-676" tabindex="-1"></a>}</span>
<span id="cb15-677"><a href="Ch04.html#cb15-677" tabindex="-1"></a></span>
<span id="cb15-678"><a href="Ch04.html#cb15-678" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-679"><a href="Ch04.html#cb15-679" tabindex="-1"></a></span>
<span id="cb15-680"><a href="Ch04.html#cb15-680" tabindex="-1"></a>Piketi_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-681"><a href="Ch04.html#cb15-681" tabindex="-1"></a>                   <span class="at">layer=</span><span class="st">&quot;temp_Piketi&quot;</span>)</span>
<span id="cb15-682"><a href="Ch04.html#cb15-682" tabindex="-1"></a>Piketi_all2 <span class="ot">=</span> Piketi_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(Piketi_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-683"><a href="Ch04.html#cb15-683" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(Piketi_all2))</span>
<span id="cb15-684"><a href="Ch04.html#cb15-684" tabindex="-1"></a></span>
<span id="cb15-685"><a href="Ch04.html#cb15-685" tabindex="-1"></a></span>
<span id="cb15-686"><a href="Ch04.html#cb15-686" tabindex="-1"></a><span class="fu">write_sf</span>(Piketi_all2,</span>
<span id="cb15-687"><a href="Ch04.html#cb15-687" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-688"><a href="Ch04.html#cb15-688" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;Piketi&quot;</span>,</span>
<span id="cb15-689"><a href="Ch04.html#cb15-689" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-690"><a href="Ch04.html#cb15-690" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-691"><a href="Ch04.html#cb15-691" tabindex="-1"></a></span>
<span id="cb15-692"><a href="Ch04.html#cb15-692" tabindex="-1"></a></span>
<span id="cb15-693"><a href="Ch04.html#cb15-693" tabindex="-1"></a><span class="co"># polderu suknu stacijas -----</span></span>
<span id="cb15-694"><a href="Ch04.html#cb15-694" tabindex="-1"></a></span>
<span id="cb15-695"><a href="Ch04.html#cb15-695" tabindex="-1"></a></span>
<span id="cb15-696"><a href="Ch04.html#cb15-696" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-697"><a href="Ch04.html#cb15-697" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-698"><a href="Ch04.html#cb15-698" tabindex="-1"></a></span>
<span id="cb15-699"><a href="Ch04.html#cb15-699" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-700"><a href="Ch04.html#cb15-700" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-701"><a href="Ch04.html#cb15-701" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-702"><a href="Ch04.html#cb15-702" tabindex="-1"></a></span>
<span id="cb15-703"><a href="Ch04.html#cb15-703" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-704"><a href="Ch04.html#cb15-704" tabindex="-1"></a></span>
<span id="cb15-705"><a href="Ch04.html#cb15-705" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-706"><a href="Ch04.html#cb15-706" tabindex="-1"></a></span>
<span id="cb15-707"><a href="Ch04.html#cb15-707" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-708"><a href="Ch04.html#cb15-708" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-709"><a href="Ch04.html#cb15-709" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-710"><a href="Ch04.html#cb15-710" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_polderpumpingstation&quot;</span>,</span>
<span id="cb15-711"><a href="Ch04.html#cb15-711" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">100</span>)</span>
<span id="cb15-712"><a href="Ch04.html#cb15-712" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-713"><a href="Ch04.html#cb15-713" tabindex="-1"></a></span>
<span id="cb15-714"><a href="Ch04.html#cb15-714" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-715"><a href="Ch04.html#cb15-715" tabindex="-1"></a>geometrijam</span>
<span id="cb15-716"><a href="Ch04.html#cb15-716" tabindex="-1"></a></span>
<span id="cb15-717"><a href="Ch04.html#cb15-717" tabindex="-1"></a></span>
<span id="cb15-718"><a href="Ch04.html#cb15-718" tabindex="-1"></a></span>
<span id="cb15-719"><a href="Ch04.html#cb15-719" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-720"><a href="Ch04.html#cb15-720" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-721"><a href="Ch04.html#cb15-721" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_polderpumpingstation&quot;</span></span>
<span id="cb15-722"><a href="Ch04.html#cb15-722" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-723"><a href="Ch04.html#cb15-723" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-724"><a href="Ch04.html#cb15-724" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-725"><a href="Ch04.html#cb15-725" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_PolderuSuknuStacijas&quot;</span></span>
<span id="cb15-726"><a href="Ch04.html#cb15-726" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-727"><a href="Ch04.html#cb15-727" tabindex="-1"></a></span>
<span id="cb15-728"><a href="Ch04.html#cb15-728" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-729"><a href="Ch04.html#cb15-729" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-730"><a href="Ch04.html#cb15-730" tabindex="-1"></a>  </span>
<span id="cb15-731"><a href="Ch04.html#cb15-731" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-732"><a href="Ch04.html#cb15-732" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-733"><a href="Ch04.html#cb15-733" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-734"><a href="Ch04.html#cb15-734" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-735"><a href="Ch04.html#cb15-735" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-736"><a href="Ch04.html#cb15-736" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-737"><a href="Ch04.html#cb15-737" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-738"><a href="Ch04.html#cb15-738" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-739"><a href="Ch04.html#cb15-739" tabindex="-1"></a>  )</span>
<span id="cb15-740"><a href="Ch04.html#cb15-740" tabindex="-1"></a>  </span>
<span id="cb15-741"><a href="Ch04.html#cb15-741" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-742"><a href="Ch04.html#cb15-742" tabindex="-1"></a>  </span>
<span id="cb15-743"><a href="Ch04.html#cb15-743" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-744"><a href="Ch04.html#cb15-744" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-745"><a href="Ch04.html#cb15-745" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-746"><a href="Ch04.html#cb15-746" tabindex="-1"></a>    </span>
<span id="cb15-747"><a href="Ch04.html#cb15-747" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING, POINT, MULTIPOLYGON</span></span>
<span id="cb15-748"><a href="Ch04.html#cb15-748" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-749"><a href="Ch04.html#cb15-749" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code)) <span class="sc">%&gt;%</span></span>
<span id="cb15-750"><a href="Ch04.html#cb15-750" tabindex="-1"></a>      <span class="fu">st_cast</span>(<span class="st">&quot;POINT&quot;</span>)</span>
<span id="cb15-751"><a href="Ch04.html#cb15-751" tabindex="-1"></a>    </span>
<span id="cb15-752"><a href="Ch04.html#cb15-752" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-753"><a href="Ch04.html#cb15-753" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-754"><a href="Ch04.html#cb15-754" tabindex="-1"></a>      chunk, </span>
<span id="cb15-755"><a href="Ch04.html#cb15-755" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-756"><a href="Ch04.html#cb15-756" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-757"><a href="Ch04.html#cb15-757" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-758"><a href="Ch04.html#cb15-758" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-759"><a href="Ch04.html#cb15-759" tabindex="-1"></a>    )</span>
<span id="cb15-760"><a href="Ch04.html#cb15-760" tabindex="-1"></a>    </span>
<span id="cb15-761"><a href="Ch04.html#cb15-761" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-762"><a href="Ch04.html#cb15-762" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-763"><a href="Ch04.html#cb15-763" tabindex="-1"></a>}</span>
<span id="cb15-764"><a href="Ch04.html#cb15-764" tabindex="-1"></a></span>
<span id="cb15-765"><a href="Ch04.html#cb15-765" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-766"><a href="Ch04.html#cb15-766" tabindex="-1"></a></span>
<span id="cb15-767"><a href="Ch04.html#cb15-767" tabindex="-1"></a>PolderuSuknuStacijas_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-768"><a href="Ch04.html#cb15-768" tabindex="-1"></a>                                 <span class="at">layer=</span><span class="st">&quot;temp_PolderuSuknuStacijas&quot;</span>)</span>
<span id="cb15-769"><a href="Ch04.html#cb15-769" tabindex="-1"></a>PolderuSuknuStacijas_all2 <span class="ot">=</span> PolderuSuknuStacijas_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(PolderuSuknuStacijas_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-770"><a href="Ch04.html#cb15-770" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(PolderuSuknuStacijas_all2))</span>
<span id="cb15-771"><a href="Ch04.html#cb15-771" tabindex="-1"></a></span>
<span id="cb15-772"><a href="Ch04.html#cb15-772" tabindex="-1"></a></span>
<span id="cb15-773"><a href="Ch04.html#cb15-773" tabindex="-1"></a><span class="fu">write_sf</span>(PolderuSuknuStacijas_all2,</span>
<span id="cb15-774"><a href="Ch04.html#cb15-774" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-775"><a href="Ch04.html#cb15-775" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;PolderuSuknuStacijas&quot;</span>,</span>
<span id="cb15-776"><a href="Ch04.html#cb15-776" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-777"><a href="Ch04.html#cb15-777" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-778"><a href="Ch04.html#cb15-778" tabindex="-1"></a></span>
<span id="cb15-779"><a href="Ch04.html#cb15-779" tabindex="-1"></a></span>
<span id="cb15-780"><a href="Ch04.html#cb15-780" tabindex="-1"></a></span>
<span id="cb15-781"><a href="Ch04.html#cb15-781" tabindex="-1"></a><span class="co"># polderu teritorijas -----</span></span>
<span id="cb15-782"><a href="Ch04.html#cb15-782" tabindex="-1"></a></span>
<span id="cb15-783"><a href="Ch04.html#cb15-783" tabindex="-1"></a></span>
<span id="cb15-784"><a href="Ch04.html#cb15-784" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-785"><a href="Ch04.html#cb15-785" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-786"><a href="Ch04.html#cb15-786" tabindex="-1"></a></span>
<span id="cb15-787"><a href="Ch04.html#cb15-787" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-788"><a href="Ch04.html#cb15-788" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-789"><a href="Ch04.html#cb15-789" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-790"><a href="Ch04.html#cb15-790" tabindex="-1"></a></span>
<span id="cb15-791"><a href="Ch04.html#cb15-791" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-792"><a href="Ch04.html#cb15-792" tabindex="-1"></a></span>
<span id="cb15-793"><a href="Ch04.html#cb15-793" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-794"><a href="Ch04.html#cb15-794" tabindex="-1"></a></span>
<span id="cb15-795"><a href="Ch04.html#cb15-795" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-796"><a href="Ch04.html#cb15-796" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-797"><a href="Ch04.html#cb15-797" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-798"><a href="Ch04.html#cb15-798" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_polderterritory&quot;</span>,</span>
<span id="cb15-799"><a href="Ch04.html#cb15-799" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">100</span>)</span>
<span id="cb15-800"><a href="Ch04.html#cb15-800" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-801"><a href="Ch04.html#cb15-801" tabindex="-1"></a></span>
<span id="cb15-802"><a href="Ch04.html#cb15-802" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-803"><a href="Ch04.html#cb15-803" tabindex="-1"></a>geometrijam</span>
<span id="cb15-804"><a href="Ch04.html#cb15-804" tabindex="-1"></a></span>
<span id="cb15-805"><a href="Ch04.html#cb15-805" tabindex="-1"></a>geometrijas<span class="ot">=</span><span class="fu">st_set_crs</span>(geometrijam,<span class="fu">st_crs</span>(<span class="dv">3059</span>))</span>
<span id="cb15-806"><a href="Ch04.html#cb15-806" tabindex="-1"></a></span>
<span id="cb15-807"><a href="Ch04.html#cb15-807" tabindex="-1"></a><span class="fu">library</span>(gdalUtilities)</span>
<span id="cb15-808"><a href="Ch04.html#cb15-808" tabindex="-1"></a>ensure_multipolygons <span class="ot">&lt;-</span> <span class="cf">function</span>(X) {</span>
<span id="cb15-809"><a href="Ch04.html#cb15-809" tabindex="-1"></a>  tmp1 <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.gpkg&quot;</span>)</span>
<span id="cb15-810"><a href="Ch04.html#cb15-810" tabindex="-1"></a>  tmp2 <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.gpkg&quot;</span>)</span>
<span id="cb15-811"><a href="Ch04.html#cb15-811" tabindex="-1"></a>  <span class="fu">st_write</span>(X, tmp1)</span>
<span id="cb15-812"><a href="Ch04.html#cb15-812" tabindex="-1"></a>  <span class="fu">ogr2ogr</span>(tmp1, tmp2, <span class="at">f =</span> <span class="st">&quot;GPKG&quot;</span>, <span class="at">nlt =</span> <span class="st">&quot;MULTIPOLYGON&quot;</span>)</span>
<span id="cb15-813"><a href="Ch04.html#cb15-813" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">st_read</span>(tmp2)</span>
<span id="cb15-814"><a href="Ch04.html#cb15-814" tabindex="-1"></a>  <span class="fu">st_sf</span>(<span class="fu">st_drop_geometry</span>(X), <span class="at">geom =</span> <span class="fu">st_geometry</span>(Y))</span>
<span id="cb15-815"><a href="Ch04.html#cb15-815" tabindex="-1"></a>}</span>
<span id="cb15-816"><a href="Ch04.html#cb15-816" tabindex="-1"></a>poligoni <span class="ot">&lt;-</span> <span class="fu">ensure_multipolygons</span>(geometrijas)</span>
<span id="cb15-817"><a href="Ch04.html#cb15-817" tabindex="-1"></a>PolderuTeritorijas_all2 <span class="ot">=</span> poligoni[<span class="sc">!</span><span class="fu">st_is_empty</span>(poligoni),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-818"><a href="Ch04.html#cb15-818" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(PolderuTeritorijas_all2))</span>
<span id="cb15-819"><a href="Ch04.html#cb15-819" tabindex="-1"></a></span>
<span id="cb15-820"><a href="Ch04.html#cb15-820" tabindex="-1"></a></span>
<span id="cb15-821"><a href="Ch04.html#cb15-821" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-822"><a href="Ch04.html#cb15-822" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-823"><a href="Ch04.html#cb15-823" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_polderterritory&quot;</span></span>
<span id="cb15-824"><a href="Ch04.html#cb15-824" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-825"><a href="Ch04.html#cb15-825" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-826"><a href="Ch04.html#cb15-826" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-827"><a href="Ch04.html#cb15-827" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_PolderuTeritorijas&quot;</span></span>
<span id="cb15-828"><a href="Ch04.html#cb15-828" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-829"><a href="Ch04.html#cb15-829" tabindex="-1"></a></span>
<span id="cb15-830"><a href="Ch04.html#cb15-830" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-831"><a href="Ch04.html#cb15-831" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-832"><a href="Ch04.html#cb15-832" tabindex="-1"></a>  </span>
<span id="cb15-833"><a href="Ch04.html#cb15-833" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-834"><a href="Ch04.html#cb15-834" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-835"><a href="Ch04.html#cb15-835" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-836"><a href="Ch04.html#cb15-836" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-837"><a href="Ch04.html#cb15-837" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-838"><a href="Ch04.html#cb15-838" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-839"><a href="Ch04.html#cb15-839" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-840"><a href="Ch04.html#cb15-840" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-841"><a href="Ch04.html#cb15-841" tabindex="-1"></a>  )</span>
<span id="cb15-842"><a href="Ch04.html#cb15-842" tabindex="-1"></a>  </span>
<span id="cb15-843"><a href="Ch04.html#cb15-843" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-844"><a href="Ch04.html#cb15-844" tabindex="-1"></a>  </span>
<span id="cb15-845"><a href="Ch04.html#cb15-845" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-846"><a href="Ch04.html#cb15-846" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-847"><a href="Ch04.html#cb15-847" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-848"><a href="Ch04.html#cb15-848" tabindex="-1"></a>    </span>
<span id="cb15-849"><a href="Ch04.html#cb15-849" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING, POINT, MULTIPOLYGON</span></span>
<span id="cb15-850"><a href="Ch04.html#cb15-850" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-851"><a href="Ch04.html#cb15-851" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code)) <span class="sc">%&gt;%</span></span>
<span id="cb15-852"><a href="Ch04.html#cb15-852" tabindex="-1"></a>      <span class="fu">st_cast</span>(<span class="st">&quot;MULTIPOLYGON&quot;</span>)</span>
<span id="cb15-853"><a href="Ch04.html#cb15-853" tabindex="-1"></a>    </span>
<span id="cb15-854"><a href="Ch04.html#cb15-854" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-855"><a href="Ch04.html#cb15-855" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-856"><a href="Ch04.html#cb15-856" tabindex="-1"></a>      chunk, </span>
<span id="cb15-857"><a href="Ch04.html#cb15-857" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-858"><a href="Ch04.html#cb15-858" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-859"><a href="Ch04.html#cb15-859" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-860"><a href="Ch04.html#cb15-860" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-861"><a href="Ch04.html#cb15-861" tabindex="-1"></a>    )</span>
<span id="cb15-862"><a href="Ch04.html#cb15-862" tabindex="-1"></a>    </span>
<span id="cb15-863"><a href="Ch04.html#cb15-863" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-864"><a href="Ch04.html#cb15-864" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-865"><a href="Ch04.html#cb15-865" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.5</span>)</span>
<span id="cb15-866"><a href="Ch04.html#cb15-866" tabindex="-1"></a>}</span>
<span id="cb15-867"><a href="Ch04.html#cb15-867" tabindex="-1"></a></span>
<span id="cb15-868"><a href="Ch04.html#cb15-868" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-869"><a href="Ch04.html#cb15-869" tabindex="-1"></a></span>
<span id="cb15-870"><a href="Ch04.html#cb15-870" tabindex="-1"></a></span>
<span id="cb15-871"><a href="Ch04.html#cb15-871" tabindex="-1"></a>PolderuTeritorijas_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-872"><a href="Ch04.html#cb15-872" tabindex="-1"></a>                               <span class="at">layer=</span><span class="st">&quot;temp_PolderuTeritorijas&quot;</span>)</span>
<span id="cb15-873"><a href="Ch04.html#cb15-873" tabindex="-1"></a>PolderuTeritorijas_all2 <span class="ot">=</span> PolderuTeritorijas_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(PolderuTeritorijas_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-874"><a href="Ch04.html#cb15-874" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(PolderuTeritorijas_all2))</span>
<span id="cb15-875"><a href="Ch04.html#cb15-875" tabindex="-1"></a></span>
<span id="cb15-876"><a href="Ch04.html#cb15-876" tabindex="-1"></a></span>
<span id="cb15-877"><a href="Ch04.html#cb15-877" tabindex="-1"></a><span class="fu">write_sf</span>(PolderuTeritorijas_all2,</span>
<span id="cb15-878"><a href="Ch04.html#cb15-878" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-879"><a href="Ch04.html#cb15-879" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;PolderuTeritorijas&quot;</span>,</span>
<span id="cb15-880"><a href="Ch04.html#cb15-880" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-881"><a href="Ch04.html#cb15-881" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-882"><a href="Ch04.html#cb15-882" tabindex="-1"></a></span>
<span id="cb15-883"><a href="Ch04.html#cb15-883" tabindex="-1"></a></span>
<span id="cb15-884"><a href="Ch04.html#cb15-884" tabindex="-1"></a><span class="co"># sateces baseini ----</span></span>
<span id="cb15-885"><a href="Ch04.html#cb15-885" tabindex="-1"></a></span>
<span id="cb15-886"><a href="Ch04.html#cb15-886" tabindex="-1"></a></span>
<span id="cb15-887"><a href="Ch04.html#cb15-887" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-888"><a href="Ch04.html#cb15-888" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-889"><a href="Ch04.html#cb15-889" tabindex="-1"></a></span>
<span id="cb15-890"><a href="Ch04.html#cb15-890" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-891"><a href="Ch04.html#cb15-891" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-892"><a href="Ch04.html#cb15-892" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-893"><a href="Ch04.html#cb15-893" tabindex="-1"></a></span>
<span id="cb15-894"><a href="Ch04.html#cb15-894" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-895"><a href="Ch04.html#cb15-895" tabindex="-1"></a></span>
<span id="cb15-896"><a href="Ch04.html#cb15-896" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-897"><a href="Ch04.html#cb15-897" tabindex="-1"></a></span>
<span id="cb15-898"><a href="Ch04.html#cb15-898" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-899"><a href="Ch04.html#cb15-899" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-900"><a href="Ch04.html#cb15-900" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-901"><a href="Ch04.html#cb15-901" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_catchment&quot;</span>,</span>
<span id="cb15-902"><a href="Ch04.html#cb15-902" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">100</span>)</span>
<span id="cb15-903"><a href="Ch04.html#cb15-903" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-904"><a href="Ch04.html#cb15-904" tabindex="-1"></a></span>
<span id="cb15-905"><a href="Ch04.html#cb15-905" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-906"><a href="Ch04.html#cb15-906" tabindex="-1"></a>geometrijam</span>
<span id="cb15-907"><a href="Ch04.html#cb15-907" tabindex="-1"></a></span>
<span id="cb15-908"><a href="Ch04.html#cb15-908" tabindex="-1"></a></span>
<span id="cb15-909"><a href="Ch04.html#cb15-909" tabindex="-1"></a></span>
<span id="cb15-910"><a href="Ch04.html#cb15-910" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-911"><a href="Ch04.html#cb15-911" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-912"><a href="Ch04.html#cb15-912" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_catchment&quot;</span></span>
<span id="cb15-913"><a href="Ch04.html#cb15-913" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-914"><a href="Ch04.html#cb15-914" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-915"><a href="Ch04.html#cb15-915" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-916"><a href="Ch04.html#cb15-916" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_SatecesBaseini&quot;</span></span>
<span id="cb15-917"><a href="Ch04.html#cb15-917" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-918"><a href="Ch04.html#cb15-918" tabindex="-1"></a></span>
<span id="cb15-919"><a href="Ch04.html#cb15-919" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-920"><a href="Ch04.html#cb15-920" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-921"><a href="Ch04.html#cb15-921" tabindex="-1"></a>  </span>
<span id="cb15-922"><a href="Ch04.html#cb15-922" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-923"><a href="Ch04.html#cb15-923" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-924"><a href="Ch04.html#cb15-924" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-925"><a href="Ch04.html#cb15-925" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-926"><a href="Ch04.html#cb15-926" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-927"><a href="Ch04.html#cb15-927" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-928"><a href="Ch04.html#cb15-928" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-929"><a href="Ch04.html#cb15-929" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-930"><a href="Ch04.html#cb15-930" tabindex="-1"></a>  )</span>
<span id="cb15-931"><a href="Ch04.html#cb15-931" tabindex="-1"></a>  </span>
<span id="cb15-932"><a href="Ch04.html#cb15-932" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-933"><a href="Ch04.html#cb15-933" tabindex="-1"></a>  </span>
<span id="cb15-934"><a href="Ch04.html#cb15-934" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-935"><a href="Ch04.html#cb15-935" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-936"><a href="Ch04.html#cb15-936" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-937"><a href="Ch04.html#cb15-937" tabindex="-1"></a>    </span>
<span id="cb15-938"><a href="Ch04.html#cb15-938" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING, POINT, MULTIPOLYGON</span></span>
<span id="cb15-939"><a href="Ch04.html#cb15-939" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-940"><a href="Ch04.html#cb15-940" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code))</span>
<span id="cb15-941"><a href="Ch04.html#cb15-941" tabindex="-1"></a>    </span>
<span id="cb15-942"><a href="Ch04.html#cb15-942" tabindex="-1"></a>    ensure_multipolygons <span class="ot">&lt;-</span> <span class="cf">function</span>(X) {</span>
<span id="cb15-943"><a href="Ch04.html#cb15-943" tabindex="-1"></a>      tmp1 <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.gpkg&quot;</span>)</span>
<span id="cb15-944"><a href="Ch04.html#cb15-944" tabindex="-1"></a>      tmp2 <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.gpkg&quot;</span>)</span>
<span id="cb15-945"><a href="Ch04.html#cb15-945" tabindex="-1"></a>      <span class="fu">st_write</span>(X, tmp1)</span>
<span id="cb15-946"><a href="Ch04.html#cb15-946" tabindex="-1"></a>      <span class="fu">ogr2ogr</span>(tmp1, tmp2, <span class="at">f =</span> <span class="st">&quot;GPKG&quot;</span>, <span class="at">nlt =</span> <span class="st">&quot;MULTIPOLYGON&quot;</span>)</span>
<span id="cb15-947"><a href="Ch04.html#cb15-947" tabindex="-1"></a>      Y <span class="ot">&lt;-</span> <span class="fu">st_read</span>(tmp2)</span>
<span id="cb15-948"><a href="Ch04.html#cb15-948" tabindex="-1"></a>      <span class="fu">st_sf</span>(<span class="fu">st_drop_geometry</span>(X), <span class="at">geom =</span> <span class="fu">st_geometry</span>(Y))</span>
<span id="cb15-949"><a href="Ch04.html#cb15-949" tabindex="-1"></a>    }</span>
<span id="cb15-950"><a href="Ch04.html#cb15-950" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">ensure_multipolygons</span>(chunk)</span>
<span id="cb15-951"><a href="Ch04.html#cb15-951" tabindex="-1"></a>    </span>
<span id="cb15-952"><a href="Ch04.html#cb15-952" tabindex="-1"></a>    </span>
<span id="cb15-953"><a href="Ch04.html#cb15-953" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-954"><a href="Ch04.html#cb15-954" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-955"><a href="Ch04.html#cb15-955" tabindex="-1"></a>      chunk, </span>
<span id="cb15-956"><a href="Ch04.html#cb15-956" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-957"><a href="Ch04.html#cb15-957" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-958"><a href="Ch04.html#cb15-958" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-959"><a href="Ch04.html#cb15-959" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-960"><a href="Ch04.html#cb15-960" tabindex="-1"></a>    )</span>
<span id="cb15-961"><a href="Ch04.html#cb15-961" tabindex="-1"></a>    </span>
<span id="cb15-962"><a href="Ch04.html#cb15-962" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-963"><a href="Ch04.html#cb15-963" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-964"><a href="Ch04.html#cb15-964" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.5</span>)</span>
<span id="cb15-965"><a href="Ch04.html#cb15-965" tabindex="-1"></a>}</span>
<span id="cb15-966"><a href="Ch04.html#cb15-966" tabindex="-1"></a></span>
<span id="cb15-967"><a href="Ch04.html#cb15-967" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-968"><a href="Ch04.html#cb15-968" tabindex="-1"></a></span>
<span id="cb15-969"><a href="Ch04.html#cb15-969" tabindex="-1"></a></span>
<span id="cb15-970"><a href="Ch04.html#cb15-970" tabindex="-1"></a>SatecesBaseini_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-971"><a href="Ch04.html#cb15-971" tabindex="-1"></a>                           <span class="at">layer=</span><span class="st">&quot;temp_SatecesBaseini&quot;</span>)</span>
<span id="cb15-972"><a href="Ch04.html#cb15-972" tabindex="-1"></a>SatecesBaseini_all2 <span class="ot">=</span> SatecesBaseini_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(SatecesBaseini_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-973"><a href="Ch04.html#cb15-973" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(SatecesBaseini_all2))</span>
<span id="cb15-974"><a href="Ch04.html#cb15-974" tabindex="-1"></a></span>
<span id="cb15-975"><a href="Ch04.html#cb15-975" tabindex="-1"></a>SatecesBaseini_all3<span class="ot">=</span><span class="fu">st_make_valid</span>(SatecesBaseini_all2)</span>
<span id="cb15-976"><a href="Ch04.html#cb15-976" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(SatecesBaseini_all3))</span>
<span id="cb15-977"><a href="Ch04.html#cb15-977" tabindex="-1"></a>SatecesBaseini_all3</span>
<span id="cb15-978"><a href="Ch04.html#cb15-978" tabindex="-1"></a></span>
<span id="cb15-979"><a href="Ch04.html#cb15-979" tabindex="-1"></a><span class="fu">write_sf</span>(SatecesBaseini_all3,</span>
<span id="cb15-980"><a href="Ch04.html#cb15-980" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-981"><a href="Ch04.html#cb15-981" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;SatecesBaseini&quot;</span>,</span>
<span id="cb15-982"><a href="Ch04.html#cb15-982" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-983"><a href="Ch04.html#cb15-983" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-984"><a href="Ch04.html#cb15-984" tabindex="-1"></a></span>
<span id="cb15-985"><a href="Ch04.html#cb15-985" tabindex="-1"></a></span>
<span id="cb15-986"><a href="Ch04.html#cb15-986" tabindex="-1"></a><span class="co"># savienojumi ----</span></span>
<span id="cb15-987"><a href="Ch04.html#cb15-987" tabindex="-1"></a></span>
<span id="cb15-988"><a href="Ch04.html#cb15-988" tabindex="-1"></a></span>
<span id="cb15-989"><a href="Ch04.html#cb15-989" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-990"><a href="Ch04.html#cb15-990" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-991"><a href="Ch04.html#cb15-991" tabindex="-1"></a></span>
<span id="cb15-992"><a href="Ch04.html#cb15-992" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-993"><a href="Ch04.html#cb15-993" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-994"><a href="Ch04.html#cb15-994" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-995"><a href="Ch04.html#cb15-995" tabindex="-1"></a></span>
<span id="cb15-996"><a href="Ch04.html#cb15-996" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-997"><a href="Ch04.html#cb15-997" tabindex="-1"></a></span>
<span id="cb15-998"><a href="Ch04.html#cb15-998" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-999"><a href="Ch04.html#cb15-999" tabindex="-1"></a></span>
<span id="cb15-1000"><a href="Ch04.html#cb15-1000" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-1001"><a href="Ch04.html#cb15-1001" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-1002"><a href="Ch04.html#cb15-1002" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-1003"><a href="Ch04.html#cb15-1003" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_connectionpoints&quot;</span>,</span>
<span id="cb15-1004"><a href="Ch04.html#cb15-1004" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">100</span>)</span>
<span id="cb15-1005"><a href="Ch04.html#cb15-1005" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-1006"><a href="Ch04.html#cb15-1006" tabindex="-1"></a></span>
<span id="cb15-1007"><a href="Ch04.html#cb15-1007" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-1008"><a href="Ch04.html#cb15-1008" tabindex="-1"></a>geometrijam</span>
<span id="cb15-1009"><a href="Ch04.html#cb15-1009" tabindex="-1"></a></span>
<span id="cb15-1010"><a href="Ch04.html#cb15-1010" tabindex="-1"></a></span>
<span id="cb15-1011"><a href="Ch04.html#cb15-1011" tabindex="-1"></a></span>
<span id="cb15-1012"><a href="Ch04.html#cb15-1012" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-1013"><a href="Ch04.html#cb15-1013" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-1014"><a href="Ch04.html#cb15-1014" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_connectionpoints&quot;</span></span>
<span id="cb15-1015"><a href="Ch04.html#cb15-1015" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-1016"><a href="Ch04.html#cb15-1016" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-1017"><a href="Ch04.html#cb15-1017" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-1018"><a href="Ch04.html#cb15-1018" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_Savienojumi&quot;</span></span>
<span id="cb15-1019"><a href="Ch04.html#cb15-1019" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-1020"><a href="Ch04.html#cb15-1020" tabindex="-1"></a></span>
<span id="cb15-1021"><a href="Ch04.html#cb15-1021" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-1022"><a href="Ch04.html#cb15-1022" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-1023"><a href="Ch04.html#cb15-1023" tabindex="-1"></a>  </span>
<span id="cb15-1024"><a href="Ch04.html#cb15-1024" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-1025"><a href="Ch04.html#cb15-1025" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-1026"><a href="Ch04.html#cb15-1026" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-1027"><a href="Ch04.html#cb15-1027" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-1028"><a href="Ch04.html#cb15-1028" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-1029"><a href="Ch04.html#cb15-1029" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-1030"><a href="Ch04.html#cb15-1030" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-1031"><a href="Ch04.html#cb15-1031" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-1032"><a href="Ch04.html#cb15-1032" tabindex="-1"></a>  )</span>
<span id="cb15-1033"><a href="Ch04.html#cb15-1033" tabindex="-1"></a>  </span>
<span id="cb15-1034"><a href="Ch04.html#cb15-1034" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-1035"><a href="Ch04.html#cb15-1035" tabindex="-1"></a>  </span>
<span id="cb15-1036"><a href="Ch04.html#cb15-1036" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-1037"><a href="Ch04.html#cb15-1037" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-1038"><a href="Ch04.html#cb15-1038" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-1039"><a href="Ch04.html#cb15-1039" tabindex="-1"></a>    </span>
<span id="cb15-1040"><a href="Ch04.html#cb15-1040" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING, POINT, MULTIPOLYGON</span></span>
<span id="cb15-1041"><a href="Ch04.html#cb15-1041" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-1042"><a href="Ch04.html#cb15-1042" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code))</span>
<span id="cb15-1043"><a href="Ch04.html#cb15-1043" tabindex="-1"></a>    </span>
<span id="cb15-1044"><a href="Ch04.html#cb15-1044" tabindex="-1"></a>    chunk<span class="ot">=</span><span class="fu">st_cast</span>(chunk,<span class="st">&quot;POINT&quot;</span>)</span>
<span id="cb15-1045"><a href="Ch04.html#cb15-1045" tabindex="-1"></a>    </span>
<span id="cb15-1046"><a href="Ch04.html#cb15-1046" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-1047"><a href="Ch04.html#cb15-1047" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-1048"><a href="Ch04.html#cb15-1048" tabindex="-1"></a>      chunk, </span>
<span id="cb15-1049"><a href="Ch04.html#cb15-1049" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-1050"><a href="Ch04.html#cb15-1050" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-1051"><a href="Ch04.html#cb15-1051" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-1052"><a href="Ch04.html#cb15-1052" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-1053"><a href="Ch04.html#cb15-1053" tabindex="-1"></a>    )</span>
<span id="cb15-1054"><a href="Ch04.html#cb15-1054" tabindex="-1"></a>    </span>
<span id="cb15-1055"><a href="Ch04.html#cb15-1055" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-1056"><a href="Ch04.html#cb15-1056" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-1057"><a href="Ch04.html#cb15-1057" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.5</span>)</span>
<span id="cb15-1058"><a href="Ch04.html#cb15-1058" tabindex="-1"></a>}</span>
<span id="cb15-1059"><a href="Ch04.html#cb15-1059" tabindex="-1"></a></span>
<span id="cb15-1060"><a href="Ch04.html#cb15-1060" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-1061"><a href="Ch04.html#cb15-1061" tabindex="-1"></a></span>
<span id="cb15-1062"><a href="Ch04.html#cb15-1062" tabindex="-1"></a></span>
<span id="cb15-1063"><a href="Ch04.html#cb15-1063" tabindex="-1"></a>Savienojumi_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-1064"><a href="Ch04.html#cb15-1064" tabindex="-1"></a>                        <span class="at">layer=</span><span class="st">&quot;temp_Savienojumi&quot;</span>)</span>
<span id="cb15-1065"><a href="Ch04.html#cb15-1065" tabindex="-1"></a>Savienojumi_all2 <span class="ot">=</span> Savienojumi_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(Savienojumi_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-1066"><a href="Ch04.html#cb15-1066" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(Savienojumi_all2))</span>
<span id="cb15-1067"><a href="Ch04.html#cb15-1067" tabindex="-1"></a></span>
<span id="cb15-1068"><a href="Ch04.html#cb15-1068" tabindex="-1"></a></span>
<span id="cb15-1069"><a href="Ch04.html#cb15-1069" tabindex="-1"></a><span class="fu">write_sf</span>(Savienojumi_all2,</span>
<span id="cb15-1070"><a href="Ch04.html#cb15-1070" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-1071"><a href="Ch04.html#cb15-1071" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;Savienojumi&quot;</span>,</span>
<span id="cb15-1072"><a href="Ch04.html#cb15-1072" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-1073"><a href="Ch04.html#cb15-1073" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-1074"><a href="Ch04.html#cb15-1074" tabindex="-1"></a></span>
<span id="cb15-1075"><a href="Ch04.html#cb15-1075" tabindex="-1"></a></span>
<span id="cb15-1076"><a href="Ch04.html#cb15-1076" tabindex="-1"></a><span class="co"># valsts nozimes ūdensnotekas -----</span></span>
<span id="cb15-1077"><a href="Ch04.html#cb15-1077" tabindex="-1"></a></span>
<span id="cb15-1078"><a href="Ch04.html#cb15-1078" tabindex="-1"></a></span>
<span id="cb15-1079"><a href="Ch04.html#cb15-1079" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-1080"><a href="Ch04.html#cb15-1080" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-1081"><a href="Ch04.html#cb15-1081" tabindex="-1"></a></span>
<span id="cb15-1082"><a href="Ch04.html#cb15-1082" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-1083"><a href="Ch04.html#cb15-1083" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-1084"><a href="Ch04.html#cb15-1084" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-1085"><a href="Ch04.html#cb15-1085" tabindex="-1"></a></span>
<span id="cb15-1086"><a href="Ch04.html#cb15-1086" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-1087"><a href="Ch04.html#cb15-1087" tabindex="-1"></a></span>
<span id="cb15-1088"><a href="Ch04.html#cb15-1088" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-1089"><a href="Ch04.html#cb15-1089" tabindex="-1"></a></span>
<span id="cb15-1090"><a href="Ch04.html#cb15-1090" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-1091"><a href="Ch04.html#cb15-1091" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-1092"><a href="Ch04.html#cb15-1092" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-1093"><a href="Ch04.html#cb15-1093" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_statecontrolledrivers&quot;</span>,</span>
<span id="cb15-1094"><a href="Ch04.html#cb15-1094" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">100</span>)</span>
<span id="cb15-1095"><a href="Ch04.html#cb15-1095" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-1096"><a href="Ch04.html#cb15-1096" tabindex="-1"></a></span>
<span id="cb15-1097"><a href="Ch04.html#cb15-1097" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-1098"><a href="Ch04.html#cb15-1098" tabindex="-1"></a>geometrijam</span>
<span id="cb15-1099"><a href="Ch04.html#cb15-1099" tabindex="-1"></a></span>
<span id="cb15-1100"><a href="Ch04.html#cb15-1100" tabindex="-1"></a></span>
<span id="cb15-1101"><a href="Ch04.html#cb15-1101" tabindex="-1"></a></span>
<span id="cb15-1102"><a href="Ch04.html#cb15-1102" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-1103"><a href="Ch04.html#cb15-1103" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-1104"><a href="Ch04.html#cb15-1104" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_statecontrolledrivers&quot;</span></span>
<span id="cb15-1105"><a href="Ch04.html#cb15-1105" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-1106"><a href="Ch04.html#cb15-1106" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-1107"><a href="Ch04.html#cb15-1107" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-1108"><a href="Ch04.html#cb15-1108" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_ValstsNozimesUdensnotekas&quot;</span></span>
<span id="cb15-1109"><a href="Ch04.html#cb15-1109" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-1110"><a href="Ch04.html#cb15-1110" tabindex="-1"></a></span>
<span id="cb15-1111"><a href="Ch04.html#cb15-1111" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-1112"><a href="Ch04.html#cb15-1112" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-1113"><a href="Ch04.html#cb15-1113" tabindex="-1"></a>  </span>
<span id="cb15-1114"><a href="Ch04.html#cb15-1114" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-1115"><a href="Ch04.html#cb15-1115" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-1116"><a href="Ch04.html#cb15-1116" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-1117"><a href="Ch04.html#cb15-1117" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-1118"><a href="Ch04.html#cb15-1118" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-1119"><a href="Ch04.html#cb15-1119" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-1120"><a href="Ch04.html#cb15-1120" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-1121"><a href="Ch04.html#cb15-1121" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-1122"><a href="Ch04.html#cb15-1122" tabindex="-1"></a>  )</span>
<span id="cb15-1123"><a href="Ch04.html#cb15-1123" tabindex="-1"></a>  </span>
<span id="cb15-1124"><a href="Ch04.html#cb15-1124" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-1125"><a href="Ch04.html#cb15-1125" tabindex="-1"></a>  </span>
<span id="cb15-1126"><a href="Ch04.html#cb15-1126" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-1127"><a href="Ch04.html#cb15-1127" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-1128"><a href="Ch04.html#cb15-1128" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-1129"><a href="Ch04.html#cb15-1129" tabindex="-1"></a>    </span>
<span id="cb15-1130"><a href="Ch04.html#cb15-1130" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING, POINT, MULTIPOLYGON</span></span>
<span id="cb15-1131"><a href="Ch04.html#cb15-1131" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-1132"><a href="Ch04.html#cb15-1132" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code))</span>
<span id="cb15-1133"><a href="Ch04.html#cb15-1133" tabindex="-1"></a>    </span>
<span id="cb15-1134"><a href="Ch04.html#cb15-1134" tabindex="-1"></a>    chunk<span class="ot">=</span><span class="fu">st_cast</span>(chunk,<span class="st">&quot;MULTILINESTRING&quot;</span>)</span>
<span id="cb15-1135"><a href="Ch04.html#cb15-1135" tabindex="-1"></a>    </span>
<span id="cb15-1136"><a href="Ch04.html#cb15-1136" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-1137"><a href="Ch04.html#cb15-1137" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-1138"><a href="Ch04.html#cb15-1138" tabindex="-1"></a>      chunk, </span>
<span id="cb15-1139"><a href="Ch04.html#cb15-1139" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-1140"><a href="Ch04.html#cb15-1140" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-1141"><a href="Ch04.html#cb15-1141" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-1142"><a href="Ch04.html#cb15-1142" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-1143"><a href="Ch04.html#cb15-1143" tabindex="-1"></a>    )</span>
<span id="cb15-1144"><a href="Ch04.html#cb15-1144" tabindex="-1"></a>    </span>
<span id="cb15-1145"><a href="Ch04.html#cb15-1145" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-1146"><a href="Ch04.html#cb15-1146" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-1147"><a href="Ch04.html#cb15-1147" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.5</span>)</span>
<span id="cb15-1148"><a href="Ch04.html#cb15-1148" tabindex="-1"></a>}</span>
<span id="cb15-1149"><a href="Ch04.html#cb15-1149" tabindex="-1"></a></span>
<span id="cb15-1150"><a href="Ch04.html#cb15-1150" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-1151"><a href="Ch04.html#cb15-1151" tabindex="-1"></a></span>
<span id="cb15-1152"><a href="Ch04.html#cb15-1152" tabindex="-1"></a></span>
<span id="cb15-1153"><a href="Ch04.html#cb15-1153" tabindex="-1"></a>ValstsNozimesUdensnotekas_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-1154"><a href="Ch04.html#cb15-1154" tabindex="-1"></a>                                      <span class="at">layer=</span><span class="st">&quot;temp_ValstsNozimesUdensnotekas&quot;</span>)</span>
<span id="cb15-1155"><a href="Ch04.html#cb15-1155" tabindex="-1"></a>ValstsNozimesUdensnotekas_all2 <span class="ot">=</span> ValstsNozimesUdensnotekas_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(ValstsNozimesUdensnotekas_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-1156"><a href="Ch04.html#cb15-1156" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(ValstsNozimesUdensnotekas_all2))</span>
<span id="cb15-1157"><a href="Ch04.html#cb15-1157" tabindex="-1"></a></span>
<span id="cb15-1158"><a href="Ch04.html#cb15-1158" tabindex="-1"></a></span>
<span id="cb15-1159"><a href="Ch04.html#cb15-1159" tabindex="-1"></a><span class="fu">write_sf</span>(ValstsNozimesUdensnotekas_all2,</span>
<span id="cb15-1160"><a href="Ch04.html#cb15-1160" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-1161"><a href="Ch04.html#cb15-1161" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;ValstsNozimesUdensnotekas&quot;</span>,</span>
<span id="cb15-1162"><a href="Ch04.html#cb15-1162" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-1163"><a href="Ch04.html#cb15-1163" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-1164"><a href="Ch04.html#cb15-1164" tabindex="-1"></a></span>
<span id="cb15-1165"><a href="Ch04.html#cb15-1165" tabindex="-1"></a></span>
<span id="cb15-1166"><a href="Ch04.html#cb15-1166" tabindex="-1"></a><span class="co"># zmni regions ----</span></span>
<span id="cb15-1167"><a href="Ch04.html#cb15-1167" tabindex="-1"></a></span>
<span id="cb15-1168"><a href="Ch04.html#cb15-1168" tabindex="-1"></a></span>
<span id="cb15-1169"><a href="Ch04.html#cb15-1169" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-1170"><a href="Ch04.html#cb15-1170" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-1171"><a href="Ch04.html#cb15-1171" tabindex="-1"></a></span>
<span id="cb15-1172"><a href="Ch04.html#cb15-1172" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-1173"><a href="Ch04.html#cb15-1173" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-1174"><a href="Ch04.html#cb15-1174" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-1175"><a href="Ch04.html#cb15-1175" tabindex="-1"></a></span>
<span id="cb15-1176"><a href="Ch04.html#cb15-1176" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-1177"><a href="Ch04.html#cb15-1177" tabindex="-1"></a></span>
<span id="cb15-1178"><a href="Ch04.html#cb15-1178" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-1179"><a href="Ch04.html#cb15-1179" tabindex="-1"></a></span>
<span id="cb15-1180"><a href="Ch04.html#cb15-1180" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-1181"><a href="Ch04.html#cb15-1181" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-1182"><a href="Ch04.html#cb15-1182" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-1183"><a href="Ch04.html#cb15-1183" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_zmniregion&quot;</span>,</span>
<span id="cb15-1184"><a href="Ch04.html#cb15-1184" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">100</span>)</span>
<span id="cb15-1185"><a href="Ch04.html#cb15-1185" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-1186"><a href="Ch04.html#cb15-1186" tabindex="-1"></a></span>
<span id="cb15-1187"><a href="Ch04.html#cb15-1187" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-1188"><a href="Ch04.html#cb15-1188" tabindex="-1"></a>geometrijam</span>
<span id="cb15-1189"><a href="Ch04.html#cb15-1189" tabindex="-1"></a></span>
<span id="cb15-1190"><a href="Ch04.html#cb15-1190" tabindex="-1"></a></span>
<span id="cb15-1191"><a href="Ch04.html#cb15-1191" tabindex="-1"></a><span class="fu">library</span>(gdalUtilities)</span>
<span id="cb15-1192"><a href="Ch04.html#cb15-1192" tabindex="-1"></a></span>
<span id="cb15-1193"><a href="Ch04.html#cb15-1193" tabindex="-1"></a></span>
<span id="cb15-1194"><a href="Ch04.html#cb15-1194" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-1195"><a href="Ch04.html#cb15-1195" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-1196"><a href="Ch04.html#cb15-1196" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_zmniregion&quot;</span></span>
<span id="cb15-1197"><a href="Ch04.html#cb15-1197" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-1198"><a href="Ch04.html#cb15-1198" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-1199"><a href="Ch04.html#cb15-1199" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-1200"><a href="Ch04.html#cb15-1200" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_ZMNIRegions&quot;</span></span>
<span id="cb15-1201"><a href="Ch04.html#cb15-1201" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-1202"><a href="Ch04.html#cb15-1202" tabindex="-1"></a></span>
<span id="cb15-1203"><a href="Ch04.html#cb15-1203" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-1204"><a href="Ch04.html#cb15-1204" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-1205"><a href="Ch04.html#cb15-1205" tabindex="-1"></a>  </span>
<span id="cb15-1206"><a href="Ch04.html#cb15-1206" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-1207"><a href="Ch04.html#cb15-1207" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-1208"><a href="Ch04.html#cb15-1208" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-1209"><a href="Ch04.html#cb15-1209" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-1210"><a href="Ch04.html#cb15-1210" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-1211"><a href="Ch04.html#cb15-1211" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-1212"><a href="Ch04.html#cb15-1212" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-1213"><a href="Ch04.html#cb15-1213" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-1214"><a href="Ch04.html#cb15-1214" tabindex="-1"></a>  )</span>
<span id="cb15-1215"><a href="Ch04.html#cb15-1215" tabindex="-1"></a>  </span>
<span id="cb15-1216"><a href="Ch04.html#cb15-1216" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-1217"><a href="Ch04.html#cb15-1217" tabindex="-1"></a>  </span>
<span id="cb15-1218"><a href="Ch04.html#cb15-1218" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-1219"><a href="Ch04.html#cb15-1219" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-1220"><a href="Ch04.html#cb15-1220" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-1221"><a href="Ch04.html#cb15-1221" tabindex="-1"></a>    </span>
<span id="cb15-1222"><a href="Ch04.html#cb15-1222" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING, POINT, MULTIPOLYGON</span></span>
<span id="cb15-1223"><a href="Ch04.html#cb15-1223" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-1224"><a href="Ch04.html#cb15-1224" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code))</span>
<span id="cb15-1225"><a href="Ch04.html#cb15-1225" tabindex="-1"></a>    </span>
<span id="cb15-1226"><a href="Ch04.html#cb15-1226" tabindex="-1"></a>    ensure_multipolygons <span class="ot">&lt;-</span> <span class="cf">function</span>(X) {</span>
<span id="cb15-1227"><a href="Ch04.html#cb15-1227" tabindex="-1"></a>      tmp1 <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.gpkg&quot;</span>)</span>
<span id="cb15-1228"><a href="Ch04.html#cb15-1228" tabindex="-1"></a>      tmp2 <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.gpkg&quot;</span>)</span>
<span id="cb15-1229"><a href="Ch04.html#cb15-1229" tabindex="-1"></a>      <span class="fu">st_write</span>(X, tmp1)</span>
<span id="cb15-1230"><a href="Ch04.html#cb15-1230" tabindex="-1"></a>      <span class="fu">ogr2ogr</span>(tmp1, tmp2, <span class="at">f =</span> <span class="st">&quot;GPKG&quot;</span>, <span class="at">nlt =</span> <span class="st">&quot;MULTIPOLYGON&quot;</span>)</span>
<span id="cb15-1231"><a href="Ch04.html#cb15-1231" tabindex="-1"></a>      Y <span class="ot">&lt;-</span> <span class="fu">st_read</span>(tmp2)</span>
<span id="cb15-1232"><a href="Ch04.html#cb15-1232" tabindex="-1"></a>      <span class="fu">st_sf</span>(<span class="fu">st_drop_geometry</span>(X), <span class="at">geom =</span> <span class="fu">st_geometry</span>(Y))</span>
<span id="cb15-1233"><a href="Ch04.html#cb15-1233" tabindex="-1"></a>    }</span>
<span id="cb15-1234"><a href="Ch04.html#cb15-1234" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">ensure_multipolygons</span>(chunk)</span>
<span id="cb15-1235"><a href="Ch04.html#cb15-1235" tabindex="-1"></a>    </span>
<span id="cb15-1236"><a href="Ch04.html#cb15-1236" tabindex="-1"></a>    </span>
<span id="cb15-1237"><a href="Ch04.html#cb15-1237" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-1238"><a href="Ch04.html#cb15-1238" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-1239"><a href="Ch04.html#cb15-1239" tabindex="-1"></a>      chunk, </span>
<span id="cb15-1240"><a href="Ch04.html#cb15-1240" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-1241"><a href="Ch04.html#cb15-1241" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-1242"><a href="Ch04.html#cb15-1242" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-1243"><a href="Ch04.html#cb15-1243" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-1244"><a href="Ch04.html#cb15-1244" tabindex="-1"></a>    )</span>
<span id="cb15-1245"><a href="Ch04.html#cb15-1245" tabindex="-1"></a>    </span>
<span id="cb15-1246"><a href="Ch04.html#cb15-1246" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-1247"><a href="Ch04.html#cb15-1247" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-1248"><a href="Ch04.html#cb15-1248" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.5</span>)</span>
<span id="cb15-1249"><a href="Ch04.html#cb15-1249" tabindex="-1"></a>}</span>
<span id="cb15-1250"><a href="Ch04.html#cb15-1250" tabindex="-1"></a></span>
<span id="cb15-1251"><a href="Ch04.html#cb15-1251" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-1252"><a href="Ch04.html#cb15-1252" tabindex="-1"></a></span>
<span id="cb15-1253"><a href="Ch04.html#cb15-1253" tabindex="-1"></a></span>
<span id="cb15-1254"><a href="Ch04.html#cb15-1254" tabindex="-1"></a>ZMNIRegions_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-1255"><a href="Ch04.html#cb15-1255" tabindex="-1"></a>                        <span class="at">layer=</span><span class="st">&quot;temp_ZMNIRegions&quot;</span>)</span>
<span id="cb15-1256"><a href="Ch04.html#cb15-1256" tabindex="-1"></a>ZMNIRegions_all2 <span class="ot">=</span> ZMNIRegions_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(ZMNIRegions_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-1257"><a href="Ch04.html#cb15-1257" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(ZMNIRegions_all2))</span>
<span id="cb15-1258"><a href="Ch04.html#cb15-1258" tabindex="-1"></a></span>
<span id="cb15-1259"><a href="Ch04.html#cb15-1259" tabindex="-1"></a></span>
<span id="cb15-1260"><a href="Ch04.html#cb15-1260" tabindex="-1"></a><span class="fu">write_sf</span>(ZMNIRegions_all2,</span>
<span id="cb15-1261"><a href="Ch04.html#cb15-1261" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-1262"><a href="Ch04.html#cb15-1262" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;ZMNIRegions&quot;</span>,</span>
<span id="cb15-1263"><a href="Ch04.html#cb15-1263" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-1264"><a href="Ch04.html#cb15-1264" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-1265"><a href="Ch04.html#cb15-1265" tabindex="-1"></a></span>
<span id="cb15-1266"><a href="Ch04.html#cb15-1266" tabindex="-1"></a></span>
<span id="cb15-1267"><a href="Ch04.html#cb15-1267" tabindex="-1"></a></span>
<span id="cb15-1268"><a href="Ch04.html#cb15-1268" tabindex="-1"></a></span>
<span id="cb15-1269"><a href="Ch04.html#cb15-1269" tabindex="-1"></a><span class="co"># udensnotekas (novadgravji) -----</span></span>
<span id="cb15-1270"><a href="Ch04.html#cb15-1270" tabindex="-1"></a></span>
<span id="cb15-1271"><a href="Ch04.html#cb15-1271" tabindex="-1"></a></span>
<span id="cb15-1272"><a href="Ch04.html#cb15-1272" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-1273"><a href="Ch04.html#cb15-1273" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-1274"><a href="Ch04.html#cb15-1274" tabindex="-1"></a></span>
<span id="cb15-1275"><a href="Ch04.html#cb15-1275" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-1276"><a href="Ch04.html#cb15-1276" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-1277"><a href="Ch04.html#cb15-1277" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-1278"><a href="Ch04.html#cb15-1278" tabindex="-1"></a></span>
<span id="cb15-1279"><a href="Ch04.html#cb15-1279" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-1280"><a href="Ch04.html#cb15-1280" tabindex="-1"></a></span>
<span id="cb15-1281"><a href="Ch04.html#cb15-1281" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-1282"><a href="Ch04.html#cb15-1282" tabindex="-1"></a></span>
<span id="cb15-1283"><a href="Ch04.html#cb15-1283" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-1284"><a href="Ch04.html#cb15-1284" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-1285"><a href="Ch04.html#cb15-1285" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-1286"><a href="Ch04.html#cb15-1286" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_waterdrainditches&quot;</span>,</span>
<span id="cb15-1287"><a href="Ch04.html#cb15-1287" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">100</span>)</span>
<span id="cb15-1288"><a href="Ch04.html#cb15-1288" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-1289"><a href="Ch04.html#cb15-1289" tabindex="-1"></a></span>
<span id="cb15-1290"><a href="Ch04.html#cb15-1290" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-1291"><a href="Ch04.html#cb15-1291" tabindex="-1"></a>geometrijam</span>
<span id="cb15-1292"><a href="Ch04.html#cb15-1292" tabindex="-1"></a></span>
<span id="cb15-1293"><a href="Ch04.html#cb15-1293" tabindex="-1"></a></span>
<span id="cb15-1294"><a href="Ch04.html#cb15-1294" tabindex="-1"></a></span>
<span id="cb15-1295"><a href="Ch04.html#cb15-1295" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-1296"><a href="Ch04.html#cb15-1296" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-1297"><a href="Ch04.html#cb15-1297" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_waterdrainditches&quot;</span></span>
<span id="cb15-1298"><a href="Ch04.html#cb15-1298" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-1299"><a href="Ch04.html#cb15-1299" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-1300"><a href="Ch04.html#cb15-1300" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-1301"><a href="Ch04.html#cb15-1301" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_UdensnotekasNovadgravji&quot;</span></span>
<span id="cb15-1302"><a href="Ch04.html#cb15-1302" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-1303"><a href="Ch04.html#cb15-1303" tabindex="-1"></a></span>
<span id="cb15-1304"><a href="Ch04.html#cb15-1304" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-1305"><a href="Ch04.html#cb15-1305" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-1306"><a href="Ch04.html#cb15-1306" tabindex="-1"></a>  </span>
<span id="cb15-1307"><a href="Ch04.html#cb15-1307" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-1308"><a href="Ch04.html#cb15-1308" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-1309"><a href="Ch04.html#cb15-1309" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-1310"><a href="Ch04.html#cb15-1310" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-1311"><a href="Ch04.html#cb15-1311" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-1312"><a href="Ch04.html#cb15-1312" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-1313"><a href="Ch04.html#cb15-1313" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-1314"><a href="Ch04.html#cb15-1314" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-1315"><a href="Ch04.html#cb15-1315" tabindex="-1"></a>  )</span>
<span id="cb15-1316"><a href="Ch04.html#cb15-1316" tabindex="-1"></a>  </span>
<span id="cb15-1317"><a href="Ch04.html#cb15-1317" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-1318"><a href="Ch04.html#cb15-1318" tabindex="-1"></a>  </span>
<span id="cb15-1319"><a href="Ch04.html#cb15-1319" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-1320"><a href="Ch04.html#cb15-1320" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-1321"><a href="Ch04.html#cb15-1321" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-1322"><a href="Ch04.html#cb15-1322" tabindex="-1"></a>    </span>
<span id="cb15-1323"><a href="Ch04.html#cb15-1323" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING, POINT, MULTIPOLYGON</span></span>
<span id="cb15-1324"><a href="Ch04.html#cb15-1324" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-1325"><a href="Ch04.html#cb15-1325" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code))</span>
<span id="cb15-1326"><a href="Ch04.html#cb15-1326" tabindex="-1"></a>    </span>
<span id="cb15-1327"><a href="Ch04.html#cb15-1327" tabindex="-1"></a>    chunk<span class="ot">=</span><span class="fu">st_cast</span>(chunk,<span class="st">&quot;MULTILINESTRING&quot;</span>)</span>
<span id="cb15-1328"><a href="Ch04.html#cb15-1328" tabindex="-1"></a>    </span>
<span id="cb15-1329"><a href="Ch04.html#cb15-1329" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-1330"><a href="Ch04.html#cb15-1330" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-1331"><a href="Ch04.html#cb15-1331" tabindex="-1"></a>      chunk, </span>
<span id="cb15-1332"><a href="Ch04.html#cb15-1332" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-1333"><a href="Ch04.html#cb15-1333" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-1334"><a href="Ch04.html#cb15-1334" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-1335"><a href="Ch04.html#cb15-1335" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-1336"><a href="Ch04.html#cb15-1336" tabindex="-1"></a>    )</span>
<span id="cb15-1337"><a href="Ch04.html#cb15-1337" tabindex="-1"></a>    </span>
<span id="cb15-1338"><a href="Ch04.html#cb15-1338" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-1339"><a href="Ch04.html#cb15-1339" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-1340"><a href="Ch04.html#cb15-1340" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.5</span>)</span>
<span id="cb15-1341"><a href="Ch04.html#cb15-1341" tabindex="-1"></a>}</span>
<span id="cb15-1342"><a href="Ch04.html#cb15-1342" tabindex="-1"></a></span>
<span id="cb15-1343"><a href="Ch04.html#cb15-1343" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-1344"><a href="Ch04.html#cb15-1344" tabindex="-1"></a></span>
<span id="cb15-1345"><a href="Ch04.html#cb15-1345" tabindex="-1"></a></span>
<span id="cb15-1346"><a href="Ch04.html#cb15-1346" tabindex="-1"></a>UdensnotekasNovadgravji_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-1347"><a href="Ch04.html#cb15-1347" tabindex="-1"></a>                                    <span class="at">layer=</span><span class="st">&quot;temp_UdensnotekasNovadgravji&quot;</span>)</span>
<span id="cb15-1348"><a href="Ch04.html#cb15-1348" tabindex="-1"></a>UdensnotekasNovadgravji_all2 <span class="ot">=</span> UdensnotekasNovadgravji_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(UdensnotekasNovadgravji_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-1349"><a href="Ch04.html#cb15-1349" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(UdensnotekasNovadgravji_all2))</span>
<span id="cb15-1350"><a href="Ch04.html#cb15-1350" tabindex="-1"></a></span>
<span id="cb15-1351"><a href="Ch04.html#cb15-1351" tabindex="-1"></a></span>
<span id="cb15-1352"><a href="Ch04.html#cb15-1352" tabindex="-1"></a><span class="fu">write_sf</span>(UdensnotekasNovadgravji_all2,</span>
<span id="cb15-1353"><a href="Ch04.html#cb15-1353" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-1354"><a href="Ch04.html#cb15-1354" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;UdensnotekasNovadgravji&quot;</span>,</span>
<span id="cb15-1355"><a href="Ch04.html#cb15-1355" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-1356"><a href="Ch04.html#cb15-1356" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-1357"><a href="Ch04.html#cb15-1357" tabindex="-1"></a></span>
<span id="cb15-1358"><a href="Ch04.html#cb15-1358" tabindex="-1"></a></span>
<span id="cb15-1359"><a href="Ch04.html#cb15-1359" tabindex="-1"></a></span>
<span id="cb15-1360"><a href="Ch04.html#cb15-1360" tabindex="-1"></a></span>
<span id="cb15-1361"><a href="Ch04.html#cb15-1361" tabindex="-1"></a><span class="co"># udensnoteku un gravju piketi ----</span></span>
<span id="cb15-1362"><a href="Ch04.html#cb15-1362" tabindex="-1"></a></span>
<span id="cb15-1363"><a href="Ch04.html#cb15-1363" tabindex="-1"></a></span>
<span id="cb15-1364"><a href="Ch04.html#cb15-1364" tabindex="-1"></a></span>
<span id="cb15-1365"><a href="Ch04.html#cb15-1365" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-1366"><a href="Ch04.html#cb15-1366" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-1367"><a href="Ch04.html#cb15-1367" tabindex="-1"></a></span>
<span id="cb15-1368"><a href="Ch04.html#cb15-1368" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-1369"><a href="Ch04.html#cb15-1369" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-1370"><a href="Ch04.html#cb15-1370" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-1371"><a href="Ch04.html#cb15-1371" tabindex="-1"></a></span>
<span id="cb15-1372"><a href="Ch04.html#cb15-1372" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-1373"><a href="Ch04.html#cb15-1373" tabindex="-1"></a></span>
<span id="cb15-1374"><a href="Ch04.html#cb15-1374" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-1375"><a href="Ch04.html#cb15-1375" tabindex="-1"></a></span>
<span id="cb15-1376"><a href="Ch04.html#cb15-1376" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-1377"><a href="Ch04.html#cb15-1377" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-1378"><a href="Ch04.html#cb15-1378" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-1379"><a href="Ch04.html#cb15-1379" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_ditchpicket&quot;</span>,</span>
<span id="cb15-1380"><a href="Ch04.html#cb15-1380" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">100</span>)</span>
<span id="cb15-1381"><a href="Ch04.html#cb15-1381" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-1382"><a href="Ch04.html#cb15-1382" tabindex="-1"></a></span>
<span id="cb15-1383"><a href="Ch04.html#cb15-1383" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-1384"><a href="Ch04.html#cb15-1384" tabindex="-1"></a>geometrijam</span>
<span id="cb15-1385"><a href="Ch04.html#cb15-1385" tabindex="-1"></a></span>
<span id="cb15-1386"><a href="Ch04.html#cb15-1386" tabindex="-1"></a></span>
<span id="cb15-1387"><a href="Ch04.html#cb15-1387" tabindex="-1"></a></span>
<span id="cb15-1388"><a href="Ch04.html#cb15-1388" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-1389"><a href="Ch04.html#cb15-1389" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-1390"><a href="Ch04.html#cb15-1390" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_ditchpicket&quot;</span></span>
<span id="cb15-1391"><a href="Ch04.html#cb15-1391" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-1392"><a href="Ch04.html#cb15-1392" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-1393"><a href="Ch04.html#cb15-1393" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-1394"><a href="Ch04.html#cb15-1394" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_UdensnotekuNovadgravjuPiketi&quot;</span></span>
<span id="cb15-1395"><a href="Ch04.html#cb15-1395" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-1396"><a href="Ch04.html#cb15-1396" tabindex="-1"></a></span>
<span id="cb15-1397"><a href="Ch04.html#cb15-1397" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-1398"><a href="Ch04.html#cb15-1398" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-1399"><a href="Ch04.html#cb15-1399" tabindex="-1"></a>  </span>
<span id="cb15-1400"><a href="Ch04.html#cb15-1400" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-1401"><a href="Ch04.html#cb15-1401" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-1402"><a href="Ch04.html#cb15-1402" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-1403"><a href="Ch04.html#cb15-1403" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-1404"><a href="Ch04.html#cb15-1404" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-1405"><a href="Ch04.html#cb15-1405" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-1406"><a href="Ch04.html#cb15-1406" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-1407"><a href="Ch04.html#cb15-1407" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-1408"><a href="Ch04.html#cb15-1408" tabindex="-1"></a>  )</span>
<span id="cb15-1409"><a href="Ch04.html#cb15-1409" tabindex="-1"></a>  </span>
<span id="cb15-1410"><a href="Ch04.html#cb15-1410" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-1411"><a href="Ch04.html#cb15-1411" tabindex="-1"></a>  </span>
<span id="cb15-1412"><a href="Ch04.html#cb15-1412" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-1413"><a href="Ch04.html#cb15-1413" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-1414"><a href="Ch04.html#cb15-1414" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-1415"><a href="Ch04.html#cb15-1415" tabindex="-1"></a>    </span>
<span id="cb15-1416"><a href="Ch04.html#cb15-1416" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING, POINT, MULTIPOLYGON</span></span>
<span id="cb15-1417"><a href="Ch04.html#cb15-1417" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-1418"><a href="Ch04.html#cb15-1418" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code)) <span class="sc">%&gt;%</span></span>
<span id="cb15-1419"><a href="Ch04.html#cb15-1419" tabindex="-1"></a>      <span class="fu">st_cast</span>(<span class="st">&quot;POINT&quot;</span>)</span>
<span id="cb15-1420"><a href="Ch04.html#cb15-1420" tabindex="-1"></a>    </span>
<span id="cb15-1421"><a href="Ch04.html#cb15-1421" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-1422"><a href="Ch04.html#cb15-1422" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-1423"><a href="Ch04.html#cb15-1423" tabindex="-1"></a>      chunk, </span>
<span id="cb15-1424"><a href="Ch04.html#cb15-1424" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-1425"><a href="Ch04.html#cb15-1425" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-1426"><a href="Ch04.html#cb15-1426" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-1427"><a href="Ch04.html#cb15-1427" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-1428"><a href="Ch04.html#cb15-1428" tabindex="-1"></a>    )</span>
<span id="cb15-1429"><a href="Ch04.html#cb15-1429" tabindex="-1"></a>    </span>
<span id="cb15-1430"><a href="Ch04.html#cb15-1430" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-1431"><a href="Ch04.html#cb15-1431" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-1432"><a href="Ch04.html#cb15-1432" tabindex="-1"></a>}</span>
<span id="cb15-1433"><a href="Ch04.html#cb15-1433" tabindex="-1"></a></span>
<span id="cb15-1434"><a href="Ch04.html#cb15-1434" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-1435"><a href="Ch04.html#cb15-1435" tabindex="-1"></a></span>
<span id="cb15-1436"><a href="Ch04.html#cb15-1436" tabindex="-1"></a>UdensnotekuNovadgravjuPiketi_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-1437"><a href="Ch04.html#cb15-1437" tabindex="-1"></a>                                         <span class="at">layer=</span><span class="st">&quot;temp_UdensnotekuNovadgravjuPiketi&quot;</span>)</span>
<span id="cb15-1438"><a href="Ch04.html#cb15-1438" tabindex="-1"></a>UdensnotekuNovadgravjuPiketi_all2 <span class="ot">=</span> UdensnotekuNovadgravjuPiketi_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(UdensnotekuNovadgravjuPiketi_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-1439"><a href="Ch04.html#cb15-1439" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(UdensnotekuNovadgravjuPiketi_all2))</span>
<span id="cb15-1440"><a href="Ch04.html#cb15-1440" tabindex="-1"></a></span>
<span id="cb15-1441"><a href="Ch04.html#cb15-1441" tabindex="-1"></a></span>
<span id="cb15-1442"><a href="Ch04.html#cb15-1442" tabindex="-1"></a><span class="fu">write_sf</span>(UdensnotekuNovadgravjuPiketi_all2,</span>
<span id="cb15-1443"><a href="Ch04.html#cb15-1443" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-1444"><a href="Ch04.html#cb15-1444" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;UdensnotekuNovadgravjuPiketi&quot;</span>,</span>
<span id="cb15-1445"><a href="Ch04.html#cb15-1445" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-1446"><a href="Ch04.html#cb15-1446" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-1447"><a href="Ch04.html#cb15-1447" tabindex="-1"></a></span>
<span id="cb15-1448"><a href="Ch04.html#cb15-1448" tabindex="-1"></a></span>
<span id="cb15-1449"><a href="Ch04.html#cb15-1449" tabindex="-1"></a></span>
<span id="cb15-1450"><a href="Ch04.html#cb15-1450" tabindex="-1"></a><span class="co"># udenstecu asis ----</span></span>
<span id="cb15-1451"><a href="Ch04.html#cb15-1451" tabindex="-1"></a></span>
<span id="cb15-1452"><a href="Ch04.html#cb15-1452" tabindex="-1"></a></span>
<span id="cb15-1453"><a href="Ch04.html#cb15-1453" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-1454"><a href="Ch04.html#cb15-1454" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-1455"><a href="Ch04.html#cb15-1455" tabindex="-1"></a></span>
<span id="cb15-1456"><a href="Ch04.html#cb15-1456" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-1457"><a href="Ch04.html#cb15-1457" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-1458"><a href="Ch04.html#cb15-1458" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-1459"><a href="Ch04.html#cb15-1459" tabindex="-1"></a></span>
<span id="cb15-1460"><a href="Ch04.html#cb15-1460" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-1461"><a href="Ch04.html#cb15-1461" tabindex="-1"></a></span>
<span id="cb15-1462"><a href="Ch04.html#cb15-1462" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-1463"><a href="Ch04.html#cb15-1463" tabindex="-1"></a></span>
<span id="cb15-1464"><a href="Ch04.html#cb15-1464" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-1465"><a href="Ch04.html#cb15-1465" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-1466"><a href="Ch04.html#cb15-1466" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-1467"><a href="Ch04.html#cb15-1467" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_stateriversline&quot;</span>,</span>
<span id="cb15-1468"><a href="Ch04.html#cb15-1468" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">100</span>)</span>
<span id="cb15-1469"><a href="Ch04.html#cb15-1469" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-1470"><a href="Ch04.html#cb15-1470" tabindex="-1"></a></span>
<span id="cb15-1471"><a href="Ch04.html#cb15-1471" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-1472"><a href="Ch04.html#cb15-1472" tabindex="-1"></a>geometrijam</span>
<span id="cb15-1473"><a href="Ch04.html#cb15-1473" tabindex="-1"></a></span>
<span id="cb15-1474"><a href="Ch04.html#cb15-1474" tabindex="-1"></a></span>
<span id="cb15-1475"><a href="Ch04.html#cb15-1475" tabindex="-1"></a></span>
<span id="cb15-1476"><a href="Ch04.html#cb15-1476" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-1477"><a href="Ch04.html#cb15-1477" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-1478"><a href="Ch04.html#cb15-1478" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_stateriversline&quot;</span></span>
<span id="cb15-1479"><a href="Ch04.html#cb15-1479" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-1480"><a href="Ch04.html#cb15-1480" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-1481"><a href="Ch04.html#cb15-1481" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-1482"><a href="Ch04.html#cb15-1482" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_UdenstecuAsis&quot;</span></span>
<span id="cb15-1483"><a href="Ch04.html#cb15-1483" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-1484"><a href="Ch04.html#cb15-1484" tabindex="-1"></a></span>
<span id="cb15-1485"><a href="Ch04.html#cb15-1485" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-1486"><a href="Ch04.html#cb15-1486" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-1487"><a href="Ch04.html#cb15-1487" tabindex="-1"></a>  </span>
<span id="cb15-1488"><a href="Ch04.html#cb15-1488" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-1489"><a href="Ch04.html#cb15-1489" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-1490"><a href="Ch04.html#cb15-1490" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-1491"><a href="Ch04.html#cb15-1491" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-1492"><a href="Ch04.html#cb15-1492" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-1493"><a href="Ch04.html#cb15-1493" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-1494"><a href="Ch04.html#cb15-1494" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-1495"><a href="Ch04.html#cb15-1495" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-1496"><a href="Ch04.html#cb15-1496" tabindex="-1"></a>  )</span>
<span id="cb15-1497"><a href="Ch04.html#cb15-1497" tabindex="-1"></a>  </span>
<span id="cb15-1498"><a href="Ch04.html#cb15-1498" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-1499"><a href="Ch04.html#cb15-1499" tabindex="-1"></a>  </span>
<span id="cb15-1500"><a href="Ch04.html#cb15-1500" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-1501"><a href="Ch04.html#cb15-1501" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-1502"><a href="Ch04.html#cb15-1502" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-1503"><a href="Ch04.html#cb15-1503" tabindex="-1"></a>    </span>
<span id="cb15-1504"><a href="Ch04.html#cb15-1504" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING, POINT, MULTIPOLYGON</span></span>
<span id="cb15-1505"><a href="Ch04.html#cb15-1505" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-1506"><a href="Ch04.html#cb15-1506" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code))</span>
<span id="cb15-1507"><a href="Ch04.html#cb15-1507" tabindex="-1"></a>    </span>
<span id="cb15-1508"><a href="Ch04.html#cb15-1508" tabindex="-1"></a>    chunk<span class="ot">=</span><span class="fu">st_cast</span>(chunk,<span class="st">&quot;MULTILINESTRING&quot;</span>)</span>
<span id="cb15-1509"><a href="Ch04.html#cb15-1509" tabindex="-1"></a>    </span>
<span id="cb15-1510"><a href="Ch04.html#cb15-1510" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-1511"><a href="Ch04.html#cb15-1511" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-1512"><a href="Ch04.html#cb15-1512" tabindex="-1"></a>      chunk, </span>
<span id="cb15-1513"><a href="Ch04.html#cb15-1513" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-1514"><a href="Ch04.html#cb15-1514" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-1515"><a href="Ch04.html#cb15-1515" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-1516"><a href="Ch04.html#cb15-1516" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-1517"><a href="Ch04.html#cb15-1517" tabindex="-1"></a>    )</span>
<span id="cb15-1518"><a href="Ch04.html#cb15-1518" tabindex="-1"></a>    </span>
<span id="cb15-1519"><a href="Ch04.html#cb15-1519" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-1520"><a href="Ch04.html#cb15-1520" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-1521"><a href="Ch04.html#cb15-1521" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.5</span>)</span>
<span id="cb15-1522"><a href="Ch04.html#cb15-1522" tabindex="-1"></a>}</span>
<span id="cb15-1523"><a href="Ch04.html#cb15-1523" tabindex="-1"></a></span>
<span id="cb15-1524"><a href="Ch04.html#cb15-1524" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-1525"><a href="Ch04.html#cb15-1525" tabindex="-1"></a></span>
<span id="cb15-1526"><a href="Ch04.html#cb15-1526" tabindex="-1"></a></span>
<span id="cb15-1527"><a href="Ch04.html#cb15-1527" tabindex="-1"></a>UdenstecuAsis_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-1528"><a href="Ch04.html#cb15-1528" tabindex="-1"></a>                          <span class="at">layer=</span><span class="st">&quot;temp_UdenstecuAsis&quot;</span>)</span>
<span id="cb15-1529"><a href="Ch04.html#cb15-1529" tabindex="-1"></a>UdenstecuAsis_all2 <span class="ot">=</span> UdenstecuAsis_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(UdenstecuAsis_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-1530"><a href="Ch04.html#cb15-1530" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(UdenstecuAsis_all2))</span>
<span id="cb15-1531"><a href="Ch04.html#cb15-1531" tabindex="-1"></a></span>
<span id="cb15-1532"><a href="Ch04.html#cb15-1532" tabindex="-1"></a></span>
<span id="cb15-1533"><a href="Ch04.html#cb15-1533" tabindex="-1"></a><span class="fu">write_sf</span>(UdenstecuAsis_all2,</span>
<span id="cb15-1534"><a href="Ch04.html#cb15-1534" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-1535"><a href="Ch04.html#cb15-1535" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;UdenstecuAsis&quot;</span>,</span>
<span id="cb15-1536"><a href="Ch04.html#cb15-1536" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-1537"><a href="Ch04.html#cb15-1537" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb15-1538"><a href="Ch04.html#cb15-1538" tabindex="-1"></a></span>
<span id="cb15-1539"><a href="Ch04.html#cb15-1539" tabindex="-1"></a></span>
<span id="cb15-1540"><a href="Ch04.html#cb15-1540" tabindex="-1"></a></span>
<span id="cb15-1541"><a href="Ch04.html#cb15-1541" tabindex="-1"></a><span class="co"># udens virsmas laukumi ----</span></span>
<span id="cb15-1542"><a href="Ch04.html#cb15-1542" tabindex="-1"></a></span>
<span id="cb15-1543"><a href="Ch04.html#cb15-1543" tabindex="-1"></a></span>
<span id="cb15-1544"><a href="Ch04.html#cb15-1544" tabindex="-1"></a>link<span class="ot">=</span><span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-1545"><a href="Ch04.html#cb15-1545" tabindex="-1"></a>url<span class="ot">=</span><span class="fu">parse_url</span>(link)</span>
<span id="cb15-1546"><a href="Ch04.html#cb15-1546" tabindex="-1"></a></span>
<span id="cb15-1547"><a href="Ch04.html#cb15-1547" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,<span class="at">request =</span> <span class="st">&quot;GetCapabilities&quot;</span>)</span>
<span id="cb15-1548"><a href="Ch04.html#cb15-1548" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-1549"><a href="Ch04.html#cb15-1549" tabindex="-1"></a>bwk_client <span class="ot">&lt;-</span> WFSClient<span class="sc">$</span><span class="fu">new</span>(link,<span class="at">serviceVersion =</span> <span class="st">&quot;2.0.0&quot;</span>)</span>
<span id="cb15-1550"><a href="Ch04.html#cb15-1550" tabindex="-1"></a></span>
<span id="cb15-1551"><a href="Ch04.html#cb15-1551" tabindex="-1"></a>bwk_client<span class="sc">$</span><span class="fu">getFeatureTypes</span>(<span class="at">pretty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-1552"><a href="Ch04.html#cb15-1552" tabindex="-1"></a></span>
<span id="cb15-1553"><a href="Ch04.html#cb15-1553" tabindex="-1"></a><span class="co"># geometrijam</span></span>
<span id="cb15-1554"><a href="Ch04.html#cb15-1554" tabindex="-1"></a></span>
<span id="cb15-1555"><a href="Ch04.html#cb15-1555" tabindex="-1"></a>url<span class="sc">$</span>query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">service =</span> <span class="st">&quot;wfs&quot;</span>,</span>
<span id="cb15-1556"><a href="Ch04.html#cb15-1556" tabindex="-1"></a>                  <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-1557"><a href="Ch04.html#cb15-1557" tabindex="-1"></a>                  <span class="at">srsName=</span><span class="st">&quot;EPSG:3059&quot;</span>,</span>
<span id="cb15-1558"><a href="Ch04.html#cb15-1558" tabindex="-1"></a>                  <span class="at">typename =</span> <span class="st">&quot;zmni:zmni_stateriverspolygon&quot;</span>,</span>
<span id="cb15-1559"><a href="Ch04.html#cb15-1559" tabindex="-1"></a>                  <span class="at">count=</span><span class="dv">100</span>)</span>
<span id="cb15-1560"><a href="Ch04.html#cb15-1560" tabindex="-1"></a>request <span class="ot">&lt;-</span> <span class="fu">build_url</span>(url)</span>
<span id="cb15-1561"><a href="Ch04.html#cb15-1561" tabindex="-1"></a></span>
<span id="cb15-1562"><a href="Ch04.html#cb15-1562" tabindex="-1"></a>geometrijam <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(request)</span>
<span id="cb15-1563"><a href="Ch04.html#cb15-1563" tabindex="-1"></a>geometrijam</span>
<span id="cb15-1564"><a href="Ch04.html#cb15-1564" tabindex="-1"></a></span>
<span id="cb15-1565"><a href="Ch04.html#cb15-1565" tabindex="-1"></a></span>
<span id="cb15-1566"><a href="Ch04.html#cb15-1566" tabindex="-1"></a><span class="co"># download</span></span>
<span id="cb15-1567"><a href="Ch04.html#cb15-1567" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">&quot;https://lvmgeoserver.lvm.lv/geoserver/zmni/ows?&quot;</span></span>
<span id="cb15-1568"><a href="Ch04.html#cb15-1568" tabindex="-1"></a>type_name <span class="ot">&lt;-</span> <span class="st">&quot;zmni:zmni_stateriverspolygon&quot;</span></span>
<span id="cb15-1569"><a href="Ch04.html#cb15-1569" tabindex="-1"></a>crs_code <span class="ot">&lt;-</span> <span class="dv">3059</span></span>
<span id="cb15-1570"><a href="Ch04.html#cb15-1570" tabindex="-1"></a>chunk_size <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb15-1571"><a href="Ch04.html#cb15-1571" tabindex="-1"></a>gpkg_path <span class="ot">&lt;-</span> <span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span></span>
<span id="cb15-1572"><a href="Ch04.html#cb15-1572" tabindex="-1"></a>layer_name <span class="ot">&lt;-</span> <span class="st">&quot;temp_UdenstecuVirsmasLaukumi&quot;</span></span>
<span id="cb15-1573"><a href="Ch04.html#cb15-1573" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-1574"><a href="Ch04.html#cb15-1574" tabindex="-1"></a></span>
<span id="cb15-1575"><a href="Ch04.html#cb15-1575" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb15-1576"><a href="Ch04.html#cb15-1576" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Fetching features &quot;</span>, i <span class="sc">*</span> chunk_size <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot; to &quot;</span>, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> chunk_size, <span class="st">&quot;...&quot;</span>)</span>
<span id="cb15-1577"><a href="Ch04.html#cb15-1577" tabindex="-1"></a>  </span>
<span id="cb15-1578"><a href="Ch04.html#cb15-1578" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb15-1579"><a href="Ch04.html#cb15-1579" tabindex="-1"></a>    <span class="at">service =</span> <span class="st">&quot;WFS&quot;</span>,</span>
<span id="cb15-1580"><a href="Ch04.html#cb15-1580" tabindex="-1"></a>    <span class="at">version =</span> <span class="st">&quot;2.0.0&quot;</span>,</span>
<span id="cb15-1581"><a href="Ch04.html#cb15-1581" tabindex="-1"></a>    <span class="at">request =</span> <span class="st">&quot;GetFeature&quot;</span>,</span>
<span id="cb15-1582"><a href="Ch04.html#cb15-1582" tabindex="-1"></a>    <span class="at">typename =</span> type_name,</span>
<span id="cb15-1583"><a href="Ch04.html#cb15-1583" tabindex="-1"></a>    <span class="at">srsName =</span> <span class="fu">paste0</span>(<span class="st">&quot;EPSG:&quot;</span>, crs_code),</span>
<span id="cb15-1584"><a href="Ch04.html#cb15-1584" tabindex="-1"></a>    <span class="at">count =</span> chunk_size,</span>
<span id="cb15-1585"><a href="Ch04.html#cb15-1585" tabindex="-1"></a>    <span class="at">startIndex =</span> i <span class="sc">*</span> chunk_size</span>
<span id="cb15-1586"><a href="Ch04.html#cb15-1586" tabindex="-1"></a>  )</span>
<span id="cb15-1587"><a href="Ch04.html#cb15-1587" tabindex="-1"></a>  </span>
<span id="cb15-1588"><a href="Ch04.html#cb15-1588" tabindex="-1"></a>  req_url <span class="ot">&lt;-</span> <span class="fu">modify_url</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb15-1589"><a href="Ch04.html#cb15-1589" tabindex="-1"></a>  </span>
<span id="cb15-1590"><a href="Ch04.html#cb15-1590" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb15-1591"><a href="Ch04.html#cb15-1591" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(req_url)</span>
<span id="cb15-1592"><a href="Ch04.html#cb15-1592" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(chunk) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb15-1593"><a href="Ch04.html#cb15-1593" tabindex="-1"></a>    </span>
<span id="cb15-1594"><a href="Ch04.html#cb15-1594" tabindex="-1"></a>    <span class="co"># Set CRS and cast to MULTILINESTRING, POINT, MULTIPOLYGON</span></span>
<span id="cb15-1595"><a href="Ch04.html#cb15-1595" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> chunk <span class="sc">%&gt;%</span></span>
<span id="cb15-1596"><a href="Ch04.html#cb15-1596" tabindex="-1"></a>      <span class="fu">st_set_crs</span>(<span class="fu">st_crs</span>(crs_code))</span>
<span id="cb15-1597"><a href="Ch04.html#cb15-1597" tabindex="-1"></a>    </span>
<span id="cb15-1598"><a href="Ch04.html#cb15-1598" tabindex="-1"></a>    ensure_multipolygons <span class="ot">&lt;-</span> <span class="cf">function</span>(X) {</span>
<span id="cb15-1599"><a href="Ch04.html#cb15-1599" tabindex="-1"></a>      tmp1 <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.gpkg&quot;</span>)</span>
<span id="cb15-1600"><a href="Ch04.html#cb15-1600" tabindex="-1"></a>      tmp2 <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.gpkg&quot;</span>)</span>
<span id="cb15-1601"><a href="Ch04.html#cb15-1601" tabindex="-1"></a>      <span class="fu">st_write</span>(X, tmp1)</span>
<span id="cb15-1602"><a href="Ch04.html#cb15-1602" tabindex="-1"></a>      <span class="fu">ogr2ogr</span>(tmp1, tmp2, <span class="at">f =</span> <span class="st">&quot;GPKG&quot;</span>, <span class="at">nlt =</span> <span class="st">&quot;MULTIPOLYGON&quot;</span>)</span>
<span id="cb15-1603"><a href="Ch04.html#cb15-1603" tabindex="-1"></a>      Y <span class="ot">&lt;-</span> <span class="fu">st_read</span>(tmp2)</span>
<span id="cb15-1604"><a href="Ch04.html#cb15-1604" tabindex="-1"></a>      <span class="fu">st_sf</span>(<span class="fu">st_drop_geometry</span>(X), <span class="at">geom =</span> <span class="fu">st_geometry</span>(Y))</span>
<span id="cb15-1605"><a href="Ch04.html#cb15-1605" tabindex="-1"></a>    }</span>
<span id="cb15-1606"><a href="Ch04.html#cb15-1606" tabindex="-1"></a>    chunk <span class="ot">&lt;-</span> <span class="fu">ensure_multipolygons</span>(chunk)</span>
<span id="cb15-1607"><a href="Ch04.html#cb15-1607" tabindex="-1"></a>    </span>
<span id="cb15-1608"><a href="Ch04.html#cb15-1608" tabindex="-1"></a>    </span>
<span id="cb15-1609"><a href="Ch04.html#cb15-1609" tabindex="-1"></a>    <span class="co"># Write chunk to GeoPackage (append mode after first)</span></span>
<span id="cb15-1610"><a href="Ch04.html#cb15-1610" tabindex="-1"></a>    <span class="fu">st_write</span>(</span>
<span id="cb15-1611"><a href="Ch04.html#cb15-1611" tabindex="-1"></a>      chunk, </span>
<span id="cb15-1612"><a href="Ch04.html#cb15-1612" tabindex="-1"></a>      <span class="at">dsn =</span> gpkg_path,</span>
<span id="cb15-1613"><a href="Ch04.html#cb15-1613" tabindex="-1"></a>      <span class="at">layer =</span> layer_name,</span>
<span id="cb15-1614"><a href="Ch04.html#cb15-1614" tabindex="-1"></a>      <span class="at">append =</span> i <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb15-1615"><a href="Ch04.html#cb15-1615" tabindex="-1"></a>      <span class="at">quiet =</span> <span class="cn">FALSE</span></span>
<span id="cb15-1616"><a href="Ch04.html#cb15-1616" tabindex="-1"></a>    )</span>
<span id="cb15-1617"><a href="Ch04.html#cb15-1617" tabindex="-1"></a>    </span>
<span id="cb15-1618"><a href="Ch04.html#cb15-1618" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-1619"><a href="Ch04.html#cb15-1619" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-1620"><a href="Ch04.html#cb15-1620" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.5</span>)</span>
<span id="cb15-1621"><a href="Ch04.html#cb15-1621" tabindex="-1"></a>}</span>
<span id="cb15-1622"><a href="Ch04.html#cb15-1622" tabindex="-1"></a></span>
<span id="cb15-1623"><a href="Ch04.html#cb15-1623" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;All chunks written to &quot;</span>, gpkg_path, <span class="st">&quot; in layer &quot;</span>, layer_name)</span>
<span id="cb15-1624"><a href="Ch04.html#cb15-1624" tabindex="-1"></a></span>
<span id="cb15-1625"><a href="Ch04.html#cb15-1625" tabindex="-1"></a></span>
<span id="cb15-1626"><a href="Ch04.html#cb15-1626" tabindex="-1"></a>UdenstecuVirsmasLaukumi_all<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/MKIS/temp_MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-1627"><a href="Ch04.html#cb15-1627" tabindex="-1"></a>                                    <span class="at">layer=</span><span class="st">&quot;temp_UdenstecuVirsmasLaukumi&quot;</span>)</span>
<span id="cb15-1628"><a href="Ch04.html#cb15-1628" tabindex="-1"></a>UdenstecuVirsmasLaukumi_all2 <span class="ot">=</span> UdenstecuVirsmasLaukumi_all[<span class="sc">!</span><span class="fu">st_is_empty</span>(UdenstecuVirsmasLaukumi_all),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># 0</span></span>
<span id="cb15-1629"><a href="Ch04.html#cb15-1629" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(UdenstecuVirsmasLaukumi_all2))</span>
<span id="cb15-1630"><a href="Ch04.html#cb15-1630" tabindex="-1"></a></span>
<span id="cb15-1631"><a href="Ch04.html#cb15-1631" tabindex="-1"></a>UdenstecuVirsmasLaukumi_all3<span class="ot">=</span><span class="fu">st_make_valid</span>(UdenstecuVirsmasLaukumi_all2)</span>
<span id="cb15-1632"><a href="Ch04.html#cb15-1632" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">st_is_valid</span>(UdenstecuVirsmasLaukumi_all3))</span>
<span id="cb15-1633"><a href="Ch04.html#cb15-1633" tabindex="-1"></a></span>
<span id="cb15-1634"><a href="Ch04.html#cb15-1634" tabindex="-1"></a><span class="fu">write_sf</span>(UdenstecuVirsmasLaukumi_all3,</span>
<span id="cb15-1635"><a href="Ch04.html#cb15-1635" tabindex="-1"></a>         <span class="st">&quot;./Geodata/2024/MKIS/MKIS_2025.gpkg&quot;</span>,</span>
<span id="cb15-1636"><a href="Ch04.html#cb15-1636" tabindex="-1"></a>         <span class="at">layer=</span><span class="st">&quot;UdenstecuVirsmasLaukumi&quot;</span>,</span>
<span id="cb15-1637"><a href="Ch04.html#cb15-1637" tabindex="-1"></a>         <span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb15-1638"><a href="Ch04.html#cb15-1638" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</details>
</div>
<div id="Ch04.04" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> TopographicMap<a href="Ch04.html#Ch04.04" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To ensure the research process at the University of Latvia, the third (completed
by January 1, 2018) and fourth (unfinished) versions of the Latvian Geospatial
Information Agency’s topographic map M:10000 vector geodatabase were received.
The most recent version is available for <a href="https://kartes.lgia.gov.lv/karte/?x=311986.74&amp;y=506887.35&amp;zoom=3&amp;basemap=topokarte">public viewing</a>,
but access to vector data is restricted.</p>
<p>For the purposes of this project, the ESRI geodatabase has been converted to a
geopackage file. As part of the file format change, geometries (empty, their
validity checked and corrected where necessary) and coordinate system have
been checked.</p>
<p>Files were stored at <code>Geodata/2024/TopographicMap/</code>.</p>
<p>After dealing with each database seperately, layers used in this project were
combined, preffering the most timely per mapping page. These layers are:</p>
<ul>
<li><p><code>bride_L</code>, describing bridges as lines;</p></li>
<li><p><code>bridge_P</code>, describing bridges as points;</p></li>
<li><p><code>hidro_A</code>, describing waterbodies as polygons;</p></li>
<li><p><code>hidro_L</code>, describing ditches and small rivers as lines;</p></li>
<li><p><code>landus_A</code>, describing LULC as polygons;</p></li>
<li><p><code>road_A</code>, describing larger roads as polygons;</p></li>
<li><p><code>road_L</code>, describing different including very small and unused roads as lines;</p></li>
<li><p><code>swamp_A</code>, describing bogs as polygons;</p></li>
<li><p><code>flora_L</code>, describing linear tree and shrub formations;</p></li>
<li><p><code>build_A</code>, describing types of builtup areas. Version 4 available at the
University of Latvia does not have all the classes as version 3, therefore version 3 is used.</p></li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="Ch04.html#cb16-1" tabindex="-1"></a><span class="co"># libs ----</span></span>
<span id="cb16-2"><a href="Ch04.html#cb16-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sf)) {<span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>); <span class="fu">require</span>(sf)}</span>
<span id="cb16-3"><a href="Ch04.html#cb16-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(openxlsx)) {<span class="fu">install.packages</span>(<span class="st">&quot;openxlsx&quot;</span>); <span class="fu">require</span>(openxlsx)}</span>
<span id="cb16-4"><a href="Ch04.html#cb16-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {<span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>); <span class="fu">require</span>(tidyverse)}</span>
<span id="cb16-5"><a href="Ch04.html#cb16-5" tabindex="-1"></a></span>
<span id="cb16-6"><a href="Ch04.html#cb16-6" tabindex="-1"></a><span class="co"># v4 ----</span></span>
<span id="cb16-7"><a href="Ch04.html#cb16-7" tabindex="-1"></a>slani_v4<span class="ot">=</span><span class="fu">st_layers</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/Latvija_LKS92_v4_20250703.gdb/&quot;</span>)</span>
<span id="cb16-8"><a href="Ch04.html#cb16-8" tabindex="-1"></a><span class="fu">write.xlsx</span>(slani_v4,<span class="st">&quot;./Geodata/2024/TopographicMap/slani_v4partial.xlsx&quot;</span>)</span>
<span id="cb16-9"><a href="Ch04.html#cb16-9" tabindex="-1"></a></span>
<span id="cb16-10"><a href="Ch04.html#cb16-10" tabindex="-1"></a>slani_v4<span class="sc">$</span>geometrijai<span class="ot">=</span><span class="fu">as.character</span>(slani_v4<span class="sc">$</span>geomtype)</span>
<span id="cb16-11"><a href="Ch04.html#cb16-11" tabindex="-1"></a><span class="fu">table</span>(slani_v4<span class="sc">$</span>geometrijai)</span>
<span id="cb16-12"><a href="Ch04.html#cb16-12" tabindex="-1"></a></span>
<span id="cb16-13"><a href="Ch04.html#cb16-13" tabindex="-1"></a>slani_v4<span class="sc">$</span>geometrijai2<span class="ot">=</span><span class="fu">ifelse</span>(slani_v4<span class="sc">$</span>geometrijai<span class="sc">==</span><span class="st">&quot;3D Point&quot;</span>,<span class="st">&quot;POINT&quot;</span>,</span>
<span id="cb16-14"><a href="Ch04.html#cb16-14" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(slani_v4<span class="sc">$</span>geometrijai<span class="sc">==</span><span class="st">&quot;Multi Polygon&quot;</span>,<span class="st">&quot;MULTIPOLYGON&quot;</span>,</span>
<span id="cb16-15"><a href="Ch04.html#cb16-15" tabindex="-1"></a>                                          <span class="fu">ifelse</span>(slani_v4<span class="sc">$</span>geometrijai<span class="sc">==</span><span class="st">&quot;3D Multi Line String&quot;</span>,<span class="st">&quot;MULTILINESTRING&quot;</span>,</span>
<span id="cb16-16"><a href="Ch04.html#cb16-16" tabindex="-1"></a>                                                 <span class="fu">ifelse</span>(slani_v4<span class="sc">$</span>geometrijai<span class="sc">==</span><span class="st">&quot;3D Multi Polygon&quot;</span>,<span class="st">&quot;MULTIPOLYGON&quot;</span>,<span class="cn">NA</span>))))</span>
<span id="cb16-17"><a href="Ch04.html#cb16-17" tabindex="-1"></a></span>
<span id="cb16-18"><a href="Ch04.html#cb16-18" tabindex="-1"></a>slani4x<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">name=</span>slani_v4<span class="sc">$</span>name,</span>
<span id="cb16-19"><a href="Ch04.html#cb16-19" tabindex="-1"></a>                   <span class="at">geometrija=</span>slani_v4<span class="sc">$</span>geometrijai2)</span>
<span id="cb16-20"><a href="Ch04.html#cb16-20" tabindex="-1"></a></span>
<span id="cb16-21"><a href="Ch04.html#cb16-21" tabindex="-1"></a>ciklam4x<span class="ot">=</span><span class="fu">levels</span>(<span class="fu">factor</span>(slani4x<span class="sc">$</span>name))</span>
<span id="cb16-22"><a href="Ch04.html#cb16-22" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(ciklam4x)){</span>
<span id="cb16-23"><a href="Ch04.html#cb16-23" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb16-24"><a href="Ch04.html#cb16-24" tabindex="-1"></a>  sakums<span class="ot">=</span><span class="fu">Sys.time</span>()</span>
<span id="cb16-25"><a href="Ch04.html#cb16-25" tabindex="-1"></a>  nosaukums<span class="ot">=</span>ciklam4x[i]</span>
<span id="cb16-26"><a href="Ch04.html#cb16-26" tabindex="-1"></a>  objekts<span class="ot">=</span>slani4x <span class="sc">%&gt;%</span> </span>
<span id="cb16-27"><a href="Ch04.html#cb16-27" tabindex="-1"></a>    <span class="fu">filter</span>(name<span class="sc">==</span>nosaukums)</span>
<span id="cb16-28"><a href="Ch04.html#cb16-28" tabindex="-1"></a>  <span class="fu">print</span>(nosaukums)</span>
<span id="cb16-29"><a href="Ch04.html#cb16-29" tabindex="-1"></a>  slanis<span class="ot">=</span><span class="fu">read_sf</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/topo10v4/Latvija_LKS92_v4_20250703.gdb/&quot;</span>,<span class="at">layer=</span>nosaukums)</span>
<span id="cb16-30"><a href="Ch04.html#cb16-30" tabindex="-1"></a>  slanisZM<span class="ot">=</span><span class="fu">st_zm</span>(slanis)</span>
<span id="cb16-31"><a href="Ch04.html#cb16-31" tabindex="-1"></a>  slanis2<span class="ot">=</span><span class="fu">st_cast</span>(slanisZM,<span class="at">to=</span>objekts<span class="sc">$</span>geometrija)</span>
<span id="cb16-32"><a href="Ch04.html#cb16-32" tabindex="-1"></a>  <span class="fu">write_sf</span>(slanis2,<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v4partial.gpkg&quot;</span>,<span class="at">layer=</span>nosaukums,<span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb16-33"><a href="Ch04.html#cb16-33" tabindex="-1"></a>  ilgums<span class="ot">=</span><span class="fu">Sys.time</span>()<span class="sc">-</span>sakums</span>
<span id="cb16-34"><a href="Ch04.html#cb16-34" tabindex="-1"></a>  <span class="fu">print</span>(ilgums)</span>
<span id="cb16-35"><a href="Ch04.html#cb16-35" tabindex="-1"></a>}</span>
<span id="cb16-36"><a href="Ch04.html#cb16-36" tabindex="-1"></a></span>
<span id="cb16-37"><a href="Ch04.html#cb16-37" tabindex="-1"></a></span>
<span id="cb16-38"><a href="Ch04.html#cb16-38" tabindex="-1"></a></span>
<span id="cb16-39"><a href="Ch04.html#cb16-39" tabindex="-1"></a><span class="co"># v3 ----</span></span>
<span id="cb16-40"><a href="Ch04.html#cb16-40" tabindex="-1"></a>slani_v3<span class="ot">=</span><span class="fu">st_layers</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/Latvija_LKS92_v3_pilnais.gdb/&quot;</span>)</span>
<span id="cb16-41"><a href="Ch04.html#cb16-41" tabindex="-1"></a><span class="fu">write.xlsx</span>(slani_v3,<span class="st">&quot;./Geodata/2024/TopographicMap/slani_v3.xlsx&quot;</span>)</span>
<span id="cb16-42"><a href="Ch04.html#cb16-42" tabindex="-1"></a></span>
<span id="cb16-43"><a href="Ch04.html#cb16-43" tabindex="-1"></a>slani_v3<span class="sc">$</span>geometrijai<span class="ot">=</span><span class="fu">as.character</span>(slani_v3<span class="sc">$</span>geomtype)</span>
<span id="cb16-44"><a href="Ch04.html#cb16-44" tabindex="-1"></a><span class="fu">table</span>(slani_v3<span class="sc">$</span>geometrijai)</span>
<span id="cb16-45"><a href="Ch04.html#cb16-45" tabindex="-1"></a></span>
<span id="cb16-46"><a href="Ch04.html#cb16-46" tabindex="-1"></a>slani_v3<span class="sc">$</span>geometrijai2<span class="ot">=</span><span class="fu">ifelse</span>(slani_v3<span class="sc">$</span>geometrijai<span class="sc">==</span><span class="st">&quot;3D Point&quot;</span>,<span class="st">&quot;POINT&quot;</span>,</span>
<span id="cb16-47"><a href="Ch04.html#cb16-47" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(slani_v3<span class="sc">$</span>geometrijai<span class="sc">==</span><span class="st">&quot;Multi Polygon&quot;</span>,<span class="st">&quot;MULTIPOLYGON&quot;</span>,</span>
<span id="cb16-48"><a href="Ch04.html#cb16-48" tabindex="-1"></a>                                          <span class="fu">ifelse</span>(slani_v3<span class="sc">$</span>geometrijai<span class="sc">==</span><span class="st">&quot;3D Multi Line String&quot;</span>,<span class="st">&quot;MULTILINESTRING&quot;</span>,</span>
<span id="cb16-49"><a href="Ch04.html#cb16-49" tabindex="-1"></a>                                                 <span class="fu">ifelse</span>(slani_v3<span class="sc">$</span>geometrijai<span class="sc">==</span><span class="st">&quot;3D Multi Polygon&quot;</span>,<span class="st">&quot;MULTIPOLYGON&quot;</span>,</span>
<span id="cb16-50"><a href="Ch04.html#cb16-50" tabindex="-1"></a>                                                        <span class="fu">ifelse</span>(slani_v3<span class="sc">$</span>geometrijai<span class="sc">==</span><span class="st">&quot;Point&quot;</span>,<span class="st">&quot;POINT&quot;</span>,</span>
<span id="cb16-51"><a href="Ch04.html#cb16-51" tabindex="-1"></a>                                                               <span class="fu">ifelse</span>(slani_v3<span class="sc">$</span>geometrijai<span class="sc">==</span><span class="st">&quot;Multi Line String&quot;</span>,<span class="st">&quot;MULTILINESTRING&quot;</span>,</span>
<span id="cb16-52"><a href="Ch04.html#cb16-52" tabindex="-1"></a>                                                                      <span class="fu">ifelse</span>(slani_v3<span class="sc">$</span>geometrijai<span class="sc">==</span><span class="st">&quot;3D Measured Point&quot;</span>,<span class="st">&quot;POINT&quot;</span>,<span class="cn">NA</span>)))))))</span>
<span id="cb16-53"><a href="Ch04.html#cb16-53" tabindex="-1"></a></span>
<span id="cb16-54"><a href="Ch04.html#cb16-54" tabindex="-1"></a>slani3x<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">name=</span>slani_v3<span class="sc">$</span>name,</span>
<span id="cb16-55"><a href="Ch04.html#cb16-55" tabindex="-1"></a>                   <span class="at">geometrija=</span>slani_v3<span class="sc">$</span>geometrijai2)</span>
<span id="cb16-56"><a href="Ch04.html#cb16-56" tabindex="-1"></a></span>
<span id="cb16-57"><a href="Ch04.html#cb16-57" tabindex="-1"></a>ciklam3x<span class="ot">=</span><span class="fu">levels</span>(<span class="fu">factor</span>(slani3x<span class="sc">$</span>name))</span>
<span id="cb16-58"><a href="Ch04.html#cb16-58" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(ciklam3x)){</span>
<span id="cb16-59"><a href="Ch04.html#cb16-59" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb16-60"><a href="Ch04.html#cb16-60" tabindex="-1"></a>  sakums<span class="ot">=</span><span class="fu">Sys.time</span>()</span>
<span id="cb16-61"><a href="Ch04.html#cb16-61" tabindex="-1"></a>  nosaukums<span class="ot">=</span>ciklam3x[i]</span>
<span id="cb16-62"><a href="Ch04.html#cb16-62" tabindex="-1"></a>  objekts<span class="ot">=</span>slani3x <span class="sc">%&gt;%</span> </span>
<span id="cb16-63"><a href="Ch04.html#cb16-63" tabindex="-1"></a>    <span class="fu">filter</span>(name<span class="sc">==</span>nosaukums)</span>
<span id="cb16-64"><a href="Ch04.html#cb16-64" tabindex="-1"></a>  <span class="fu">print</span>(nosaukums)</span>
<span id="cb16-65"><a href="Ch04.html#cb16-65" tabindex="-1"></a>  slanis<span class="ot">=</span><span class="fu">read_sf</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/Latvija_LKS92_v3_pilnais.gdb/&quot;</span>,<span class="at">layer=</span>nosaukums)</span>
<span id="cb16-66"><a href="Ch04.html#cb16-66" tabindex="-1"></a>  slanisZM<span class="ot">=</span><span class="fu">st_zm</span>(slanis)</span>
<span id="cb16-67"><a href="Ch04.html#cb16-67" tabindex="-1"></a>  slanis2<span class="ot">=</span><span class="fu">st_cast</span>(slanisZM,<span class="at">to=</span>objekts<span class="sc">$</span>geometrija)</span>
<span id="cb16-68"><a href="Ch04.html#cb16-68" tabindex="-1"></a>  <span class="fu">write_sf</span>(slanis2,<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v3.gpkg&quot;</span>,<span class="at">layer=</span>nosaukums,<span class="at">append=</span><span class="cn">FALSE</span>)</span>
<span id="cb16-69"><a href="Ch04.html#cb16-69" tabindex="-1"></a>  ilgums<span class="ot">=</span><span class="fu">Sys.time</span>()<span class="sc">-</span>sakums</span>
<span id="cb16-70"><a href="Ch04.html#cb16-70" tabindex="-1"></a>  <span class="fu">print</span>(ilgums)</span>
<span id="cb16-71"><a href="Ch04.html#cb16-71" tabindex="-1"></a>}</span>
<span id="cb16-72"><a href="Ch04.html#cb16-72" tabindex="-1"></a></span>
<span id="cb16-73"><a href="Ch04.html#cb16-73" tabindex="-1"></a></span>
<span id="cb16-74"><a href="Ch04.html#cb16-74" tabindex="-1"></a><span class="co"># combination ----</span></span>
<span id="cb16-75"><a href="Ch04.html#cb16-75" tabindex="-1"></a><span class="fu">st_layers</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v3.gpkg&quot;</span>)</span>
<span id="cb16-76"><a href="Ch04.html#cb16-76" tabindex="-1"></a></span>
<span id="cb16-77"><a href="Ch04.html#cb16-77" tabindex="-1"></a>pages4<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v4partial.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;Topo10_lapas&quot;</span>)</span>
<span id="cb16-78"><a href="Ch04.html#cb16-78" tabindex="-1"></a>pages4_united<span class="ot">=</span><span class="fu">st_union</span>(pages4)</span>
<span id="cb16-79"><a href="Ch04.html#cb16-79" tabindex="-1"></a><span class="fu">ggplot</span>(pages4_united)<span class="sc">+</span><span class="fu">geom_sf</span>()</span>
<span id="cb16-80"><a href="Ch04.html#cb16-80" tabindex="-1"></a></span>
<span id="cb16-81"><a href="Ch04.html#cb16-81" tabindex="-1"></a><span class="co"># landus_A</span></span>
<span id="cb16-82"><a href="Ch04.html#cb16-82" tabindex="-1"></a>landus_3<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v3.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;landus_A&quot;</span>)</span>
<span id="cb16-83"><a href="Ch04.html#cb16-83" tabindex="-1"></a>landus_not4<span class="ot">=</span><span class="fu">st_difference</span>(landus_3,pages4_united)</span>
<span id="cb16-84"><a href="Ch04.html#cb16-84" tabindex="-1"></a>landus_not4<span class="ot">=</span>landus_not4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-85"><a href="Ch04.html#cb16-85" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-86"><a href="Ch04.html#cb16-86" tabindex="-1"></a>landus_4<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v4partial.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;landus_A&quot;</span>)</span>
<span id="cb16-87"><a href="Ch04.html#cb16-87" tabindex="-1"></a>landus_4<span class="ot">=</span>landus_4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-88"><a href="Ch04.html#cb16-88" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-89"><a href="Ch04.html#cb16-89" tabindex="-1"></a></span>
<span id="cb16-90"><a href="Ch04.html#cb16-90" tabindex="-1"></a>landus_new<span class="ot">=</span><span class="fu">rbind</span>(landus_not4,landus_4)</span>
<span id="cb16-91"><a href="Ch04.html#cb16-91" tabindex="-1"></a>sfarrow<span class="sc">::</span><span class="fu">st_write_parquet</span>(landus_new,<span class="st">&quot;./Geodata/2024/TopographicMap/LandusA_COMB.parquet&quot;</span>)</span>
<span id="cb16-92"><a href="Ch04.html#cb16-92" tabindex="-1"></a></span>
<span id="cb16-93"><a href="Ch04.html#cb16-93" tabindex="-1"></a><span class="co"># bridge_L</span></span>
<span id="cb16-94"><a href="Ch04.html#cb16-94" tabindex="-1"></a>data_3<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v3.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;bridge_L&quot;</span>)</span>
<span id="cb16-95"><a href="Ch04.html#cb16-95" tabindex="-1"></a>data_not4<span class="ot">=</span><span class="fu">st_difference</span>(data_3,pages4_united)</span>
<span id="cb16-96"><a href="Ch04.html#cb16-96" tabindex="-1"></a>data_not4<span class="ot">=</span>data_not4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-97"><a href="Ch04.html#cb16-97" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-98"><a href="Ch04.html#cb16-98" tabindex="-1"></a>data_4<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v4partial.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;bridge_L&quot;</span>)</span>
<span id="cb16-99"><a href="Ch04.html#cb16-99" tabindex="-1"></a>data_4<span class="ot">=</span>data_4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-100"><a href="Ch04.html#cb16-100" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-101"><a href="Ch04.html#cb16-101" tabindex="-1"></a></span>
<span id="cb16-102"><a href="Ch04.html#cb16-102" tabindex="-1"></a>data_new<span class="ot">=</span><span class="fu">rbind</span>(data_not4,data_4)</span>
<span id="cb16-103"><a href="Ch04.html#cb16-103" tabindex="-1"></a>sfarrow<span class="sc">::</span><span class="fu">st_write_parquet</span>(data_new,<span class="st">&quot;./Geodata/2024/TopographicMap/BridgeL_COMB.parquet&quot;</span>)</span>
<span id="cb16-104"><a href="Ch04.html#cb16-104" tabindex="-1"></a></span>
<span id="cb16-105"><a href="Ch04.html#cb16-105" tabindex="-1"></a><span class="co"># bridge_P</span></span>
<span id="cb16-106"><a href="Ch04.html#cb16-106" tabindex="-1"></a>data_3<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v3.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;bridge_P&quot;</span>)</span>
<span id="cb16-107"><a href="Ch04.html#cb16-107" tabindex="-1"></a>data_not4<span class="ot">=</span><span class="fu">st_difference</span>(data_3,pages4_united)</span>
<span id="cb16-108"><a href="Ch04.html#cb16-108" tabindex="-1"></a>data_not4<span class="ot">=</span>data_not4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-109"><a href="Ch04.html#cb16-109" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-110"><a href="Ch04.html#cb16-110" tabindex="-1"></a>data_4<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v4partial.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;bridge_P&quot;</span>)</span>
<span id="cb16-111"><a href="Ch04.html#cb16-111" tabindex="-1"></a>data_4<span class="ot">=</span>data_4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-112"><a href="Ch04.html#cb16-112" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-113"><a href="Ch04.html#cb16-113" tabindex="-1"></a></span>
<span id="cb16-114"><a href="Ch04.html#cb16-114" tabindex="-1"></a>data_new<span class="ot">=</span><span class="fu">rbind</span>(data_not4,data_4)</span>
<span id="cb16-115"><a href="Ch04.html#cb16-115" tabindex="-1"></a>sfarrow<span class="sc">::</span><span class="fu">st_write_parquet</span>(data_new,<span class="st">&quot;./Geodata/2024/TopographicMap/BridgeP_COMB.parquet&quot;</span>)</span>
<span id="cb16-116"><a href="Ch04.html#cb16-116" tabindex="-1"></a></span>
<span id="cb16-117"><a href="Ch04.html#cb16-117" tabindex="-1"></a><span class="co"># hidro_A</span></span>
<span id="cb16-118"><a href="Ch04.html#cb16-118" tabindex="-1"></a>data_3<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v3.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;hidro_A&quot;</span>)</span>
<span id="cb16-119"><a href="Ch04.html#cb16-119" tabindex="-1"></a>data_not4<span class="ot">=</span><span class="fu">st_difference</span>(data_3,pages4_united)</span>
<span id="cb16-120"><a href="Ch04.html#cb16-120" tabindex="-1"></a>data_not4<span class="ot">=</span>data_not4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-121"><a href="Ch04.html#cb16-121" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-122"><a href="Ch04.html#cb16-122" tabindex="-1"></a>data_4<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v4partial.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;hidro_A&quot;</span>)</span>
<span id="cb16-123"><a href="Ch04.html#cb16-123" tabindex="-1"></a>data_4<span class="ot">=</span>data_4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-124"><a href="Ch04.html#cb16-124" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-125"><a href="Ch04.html#cb16-125" tabindex="-1"></a></span>
<span id="cb16-126"><a href="Ch04.html#cb16-126" tabindex="-1"></a>data_new<span class="ot">=</span><span class="fu">rbind</span>(data_not4,data_4)</span>
<span id="cb16-127"><a href="Ch04.html#cb16-127" tabindex="-1"></a>sfarrow<span class="sc">::</span><span class="fu">st_write_parquet</span>(data_new,<span class="st">&quot;./Geodata/2024/TopographicMap/HidroA_COMB.parquet&quot;</span>)</span>
<span id="cb16-128"><a href="Ch04.html#cb16-128" tabindex="-1"></a></span>
<span id="cb16-129"><a href="Ch04.html#cb16-129" tabindex="-1"></a><span class="co"># hidro_L</span></span>
<span id="cb16-130"><a href="Ch04.html#cb16-130" tabindex="-1"></a>data_3<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v3.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;hidro_L&quot;</span>)</span>
<span id="cb16-131"><a href="Ch04.html#cb16-131" tabindex="-1"></a>data_not4<span class="ot">=</span><span class="fu">st_difference</span>(data_3,pages4_united)</span>
<span id="cb16-132"><a href="Ch04.html#cb16-132" tabindex="-1"></a>data_not4<span class="ot">=</span>data_not4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-133"><a href="Ch04.html#cb16-133" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-134"><a href="Ch04.html#cb16-134" tabindex="-1"></a>data_4<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v4partial.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;hidro_L&quot;</span>)</span>
<span id="cb16-135"><a href="Ch04.html#cb16-135" tabindex="-1"></a>data_4<span class="ot">=</span>data_4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-136"><a href="Ch04.html#cb16-136" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-137"><a href="Ch04.html#cb16-137" tabindex="-1"></a></span>
<span id="cb16-138"><a href="Ch04.html#cb16-138" tabindex="-1"></a>data_new<span class="ot">=</span><span class="fu">rbind</span>(data_not4,data_4)</span>
<span id="cb16-139"><a href="Ch04.html#cb16-139" tabindex="-1"></a>sfarrow<span class="sc">::</span><span class="fu">st_write_parquet</span>(data_new,<span class="st">&quot;./Geodata/2024/TopographicMap/HidroL_COMB.parquet&quot;</span>)</span>
<span id="cb16-140"><a href="Ch04.html#cb16-140" tabindex="-1"></a></span>
<span id="cb16-141"><a href="Ch04.html#cb16-141" tabindex="-1"></a></span>
<span id="cb16-142"><a href="Ch04.html#cb16-142" tabindex="-1"></a><span class="co"># road_A</span></span>
<span id="cb16-143"><a href="Ch04.html#cb16-143" tabindex="-1"></a>data_3<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v3.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;road_A&quot;</span>)</span>
<span id="cb16-144"><a href="Ch04.html#cb16-144" tabindex="-1"></a>data_not4<span class="ot">=</span><span class="fu">st_difference</span>(data_3,pages4_united)</span>
<span id="cb16-145"><a href="Ch04.html#cb16-145" tabindex="-1"></a>data_not4<span class="ot">=</span>data_not4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-146"><a href="Ch04.html#cb16-146" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-147"><a href="Ch04.html#cb16-147" tabindex="-1"></a>data_4<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v4partial.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;road_A&quot;</span>)</span>
<span id="cb16-148"><a href="Ch04.html#cb16-148" tabindex="-1"></a>data_4<span class="ot">=</span>data_4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-149"><a href="Ch04.html#cb16-149" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-150"><a href="Ch04.html#cb16-150" tabindex="-1"></a></span>
<span id="cb16-151"><a href="Ch04.html#cb16-151" tabindex="-1"></a>data_new<span class="ot">=</span><span class="fu">rbind</span>(data_not4,data_4)</span>
<span id="cb16-152"><a href="Ch04.html#cb16-152" tabindex="-1"></a>sfarrow<span class="sc">::</span><span class="fu">st_write_parquet</span>(data_new,<span class="st">&quot;./Geodata/2024/TopographicMap/RoadA_COMB.parquet&quot;</span>)</span>
<span id="cb16-153"><a href="Ch04.html#cb16-153" tabindex="-1"></a></span>
<span id="cb16-154"><a href="Ch04.html#cb16-154" tabindex="-1"></a></span>
<span id="cb16-155"><a href="Ch04.html#cb16-155" tabindex="-1"></a></span>
<span id="cb16-156"><a href="Ch04.html#cb16-156" tabindex="-1"></a><span class="co"># road_L</span></span>
<span id="cb16-157"><a href="Ch04.html#cb16-157" tabindex="-1"></a>data_3<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v3.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;road_L&quot;</span>)</span>
<span id="cb16-158"><a href="Ch04.html#cb16-158" tabindex="-1"></a>data_not4<span class="ot">=</span><span class="fu">st_difference</span>(data_3,pages4_united)</span>
<span id="cb16-159"><a href="Ch04.html#cb16-159" tabindex="-1"></a>data_not4<span class="ot">=</span>data_not4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-160"><a href="Ch04.html#cb16-160" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-161"><a href="Ch04.html#cb16-161" tabindex="-1"></a>data_4<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v4partial.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;road_L&quot;</span>)</span>
<span id="cb16-162"><a href="Ch04.html#cb16-162" tabindex="-1"></a>data_4<span class="ot">=</span>data_4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-163"><a href="Ch04.html#cb16-163" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-164"><a href="Ch04.html#cb16-164" tabindex="-1"></a></span>
<span id="cb16-165"><a href="Ch04.html#cb16-165" tabindex="-1"></a>data_new<span class="ot">=</span><span class="fu">rbind</span>(data_not4,data_4)</span>
<span id="cb16-166"><a href="Ch04.html#cb16-166" tabindex="-1"></a>sfarrow<span class="sc">::</span><span class="fu">st_write_parquet</span>(data_new,<span class="st">&quot;./Geodata/2024/TopographicMap/RoadL_COMB.parquet&quot;</span>)</span>
<span id="cb16-167"><a href="Ch04.html#cb16-167" tabindex="-1"></a></span>
<span id="cb16-168"><a href="Ch04.html#cb16-168" tabindex="-1"></a></span>
<span id="cb16-169"><a href="Ch04.html#cb16-169" tabindex="-1"></a></span>
<span id="cb16-170"><a href="Ch04.html#cb16-170" tabindex="-1"></a><span class="co"># swamp_A</span></span>
<span id="cb16-171"><a href="Ch04.html#cb16-171" tabindex="-1"></a>data_3<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v3.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;swamp_A&quot;</span>)</span>
<span id="cb16-172"><a href="Ch04.html#cb16-172" tabindex="-1"></a>data_not4<span class="ot">=</span><span class="fu">st_difference</span>(data_3,pages4_united)</span>
<span id="cb16-173"><a href="Ch04.html#cb16-173" tabindex="-1"></a>data_not4<span class="ot">=</span>data_not4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-174"><a href="Ch04.html#cb16-174" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-175"><a href="Ch04.html#cb16-175" tabindex="-1"></a>data_4<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v4partial.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;swamp_A&quot;</span>)</span>
<span id="cb16-176"><a href="Ch04.html#cb16-176" tabindex="-1"></a>data_4<span class="ot">=</span>data_4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-177"><a href="Ch04.html#cb16-177" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-178"><a href="Ch04.html#cb16-178" tabindex="-1"></a></span>
<span id="cb16-179"><a href="Ch04.html#cb16-179" tabindex="-1"></a>data_new<span class="ot">=</span><span class="fu">rbind</span>(data_not4,data_4)</span>
<span id="cb16-180"><a href="Ch04.html#cb16-180" tabindex="-1"></a>sfarrow<span class="sc">::</span><span class="fu">st_write_parquet</span>(data_new,<span class="st">&quot;./Geodata/2024/TopographicMap/SwampA_COMB.parquet&quot;</span>)</span>
<span id="cb16-181"><a href="Ch04.html#cb16-181" tabindex="-1"></a></span>
<span id="cb16-182"><a href="Ch04.html#cb16-182" tabindex="-1"></a></span>
<span id="cb16-183"><a href="Ch04.html#cb16-183" tabindex="-1"></a></span>
<span id="cb16-184"><a href="Ch04.html#cb16-184" tabindex="-1"></a><span class="co"># flora_L</span></span>
<span id="cb16-185"><a href="Ch04.html#cb16-185" tabindex="-1"></a>data_3<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v3.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;flora_L&quot;</span>)</span>
<span id="cb16-186"><a href="Ch04.html#cb16-186" tabindex="-1"></a>data_not4<span class="ot">=</span><span class="fu">st_difference</span>(data_3,pages4_united)</span>
<span id="cb16-187"><a href="Ch04.html#cb16-187" tabindex="-1"></a>data_not4<span class="ot">=</span>data_not4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-188"><a href="Ch04.html#cb16-188" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-189"><a href="Ch04.html#cb16-189" tabindex="-1"></a>data_4<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v4partial.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;flora_L&quot;</span>)</span>
<span id="cb16-190"><a href="Ch04.html#cb16-190" tabindex="-1"></a>data_4<span class="ot">=</span>data_4 <span class="sc">%&gt;%</span> </span>
<span id="cb16-191"><a href="Ch04.html#cb16-191" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-192"><a href="Ch04.html#cb16-192" tabindex="-1"></a></span>
<span id="cb16-193"><a href="Ch04.html#cb16-193" tabindex="-1"></a>data_new<span class="ot">=</span><span class="fu">rbind</span>(data_not4,data_4)</span>
<span id="cb16-194"><a href="Ch04.html#cb16-194" tabindex="-1"></a>sfarrow<span class="sc">::</span><span class="fu">st_write_parquet</span>(data_new,<span class="st">&quot;./Geodata/2024/TopographicMap/FloraL_COMB.parquet&quot;</span>)</span>
<span id="cb16-195"><a href="Ch04.html#cb16-195" tabindex="-1"></a></span>
<span id="cb16-196"><a href="Ch04.html#cb16-196" tabindex="-1"></a></span>
<span id="cb16-197"><a href="Ch04.html#cb16-197" tabindex="-1"></a><span class="co"># build_A</span></span>
<span id="cb16-198"><a href="Ch04.html#cb16-198" tabindex="-1"></a>data_3<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/TopographicMap/LGIAtopo10K_v3.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;build_A&quot;</span>)</span>
<span id="cb16-199"><a href="Ch04.html#cb16-199" tabindex="-1"></a>data_3<span class="ot">=</span>data_3 <span class="sc">%&gt;%</span> </span>
<span id="cb16-200"><a href="Ch04.html#cb16-200" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(FNAME,FCODE)</span>
<span id="cb16-201"><a href="Ch04.html#cb16-201" tabindex="-1"></a>sfarrow<span class="sc">::</span><span class="fu">st_write_parquet</span>(data_3,<span class="st">&quot;./Geodata/2024/TopographicMap/BuildA_v3.parquet&quot;</span>)</span></code></pre></div>
</details>
</div>
<div id="Ch04.05" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Corine Land Cover 2018<a href="Ch04.html#Ch04.05" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Corine Land Cover is publicly available geodata that characterizes land cover
and land use (LULC) across Europe over a long period of time using a generally
consistent (comparable) methodology (<a href="https://land.copernicus.eu/content/corine-land" class="uri">https://land.copernicus.eu/content/corine-land</a> -cover-nomenclature-guidelines/docs/pdf/CLC2018_Nomenclature_illustrated_guide_20190510.pdf),
providing results for individual years - 1990, 2000, 2006, 2012,
2018 (<a href="https://land.copernicus.eu/en/products/corine-land-cover" class="uri">https://land.copernicus.eu/en/products/corine-land-cover</a>).
Although the dataset has a coarse resolution – the mapping unit is 25 ha areas
that are at least 100 m wide – it provides sufficient information for general
use, such as workflow testing and observation filtering. This project uses
data from 2018.</p>
<p>The downloaded data set has been transformed into the Latvian coordinate
system (EPSG:3059), and the file format has been changed to geoparquet to
facilitate and speed up further work. As part of the file format change,
geometries (empty, validity) have been checked.</p>
<p>Data are stored at <code>Geodata/2024/CLC/</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="Ch04.html#cb17-1" tabindex="-1"></a><span class="co"># libs ----</span></span>
<span id="cb17-2"><a href="Ch04.html#cb17-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sf)) {<span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>); <span class="fu">require</span>(sf)}</span>
<span id="cb17-3"><a href="Ch04.html#cb17-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(arrow)) {<span class="fu">install.packages</span>(<span class="st">&quot;arrow&quot;</span>); <span class="fu">require</span>(arrow)}</span>
<span id="cb17-4"><a href="Ch04.html#cb17-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sfarrow)) {<span class="fu">install.packages</span>(<span class="st">&quot;sfarrow&quot;</span>); <span class="fu">require</span>(sfarrow)}</span>
<span id="cb17-5"><a href="Ch04.html#cb17-5" tabindex="-1"></a></span>
<span id="cb17-6"><a href="Ch04.html#cb17-6" tabindex="-1"></a><span class="co"># downloaded data</span></span>
<span id="cb17-7"><a href="Ch04.html#cb17-7" tabindex="-1"></a>clcLV<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/CLC/clcLV.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;clcLV&quot;</span>)</span>
<span id="cb17-8"><a href="Ch04.html#cb17-8" tabindex="-1"></a></span>
<span id="cb17-9"><a href="Ch04.html#cb17-9" tabindex="-1"></a><span class="co"># empty geoms</span></span>
<span id="cb17-10"><a href="Ch04.html#cb17-10" tabindex="-1"></a>clcLV2 <span class="ot">=</span> clcLV[<span class="sc">!</span><span class="fu">st_is_empty</span>(clcLV),,drop<span class="ot">=</span><span class="cn">FALSE</span>] <span class="co"># OK</span></span>
<span id="cb17-11"><a href="Ch04.html#cb17-11" tabindex="-1"></a></span>
<span id="cb17-12"><a href="Ch04.html#cb17-12" tabindex="-1"></a><span class="co"># validation</span></span>
<span id="cb17-13"><a href="Ch04.html#cb17-13" tabindex="-1"></a>validity<span class="ot">=</span><span class="fu">st_is_valid</span>(clcLV2) </span>
<span id="cb17-14"><a href="Ch04.html#cb17-14" tabindex="-1"></a><span class="fu">table</span>(validity) <span class="co"># 3 non-valid</span></span>
<span id="cb17-15"><a href="Ch04.html#cb17-15" tabindex="-1"></a>clcLV3<span class="ot">=</span><span class="fu">st_make_valid</span>(clcLV2)</span>
<span id="cb17-16"><a href="Ch04.html#cb17-16" tabindex="-1"></a></span>
<span id="cb17-17"><a href="Ch04.html#cb17-17" tabindex="-1"></a><span class="co"># crs</span></span>
<span id="cb17-18"><a href="Ch04.html#cb17-18" tabindex="-1"></a>clcLV3<span class="ot">=</span><span class="fu">st_transform</span>(clcLV3,<span class="at">crs=</span><span class="dv">3059</span>)</span>
<span id="cb17-19"><a href="Ch04.html#cb17-19" tabindex="-1"></a></span>
<span id="cb17-20"><a href="Ch04.html#cb17-20" tabindex="-1"></a><span class="co"># saving</span></span>
<span id="cb17-21"><a href="Ch04.html#cb17-21" tabindex="-1"></a>sfarrow<span class="sc">::</span><span class="fu">st_write_parquet</span>(clcLV3, <span class="st">&quot;./Geodata/2024/CLC/CLC_LV_2018.parquet&quot;</span>)</span></code></pre></div>
</details>
</div>
<div id="Ch04.06" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Publicly available LVM data<a href="Ch04.html#Ch04.06" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://data.gov.lv/dati/lv/dataset/as-latvijas-valsts-mezi-mezsaimniecibas-infrastruktura">Latvian State Forests geospatial data on forest infrastructure and its description</a>. The
following data sets were used in the project:
- roads:
- forest roads;
- forest roads to be developed;
- turning areas;
- changeover areas;
- driveways;
- drainage systems:
- ditches;
- drainage systems;
- renovated drainage facilities.
Initially, no additional processing of this data was performed. It was used to
prepare <a href="Ch05.html#Ch05">geodata products</a> (more specifically, <a href="Ch05.html#Ch05.03">Landscape classification</a>).</p>
<p>Data were downloaded to <code>Geodata/2024/LVM_OpenData</code></p>
</div>
<div id="Ch04.07" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Soil data<a href="Ch04.html#Ch04.07" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Directory <code>Geodata/2024/Soils/</code> contains various soil related datasets that need
to be combined (soil texture) or can be used individually (soil chemistry). These
datasets and their location in the filetree are documented in following subchapters.</p>
<div id="Ch04.07.01" class="section level3 hasAnchor" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Soil chemistry<a href="Ch04.html#Ch04.07.01" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Data on soil chemistry are obtained from <a href="https://esdac.jrc.ec.europa.eu/">European Soil Data Centre’s</a> European
Soil database <span class="citation">(<a href="#ref-esdac2">Panagos et al., 2022</a>)</span>. Dataset decribing soil chemistry is derived from <a href="https://esdac.jrc.ec.europa.eu/content/chemical-properties-european-scale-based-lucas-topsoil-data">LUCAS
2009/2012 topsoil data</a>. There are several chemical properties available with
download, however not all of them are experts chosen for SDM, therefore not used
further in this work:</p>
<ul>
<li><p>“P”: used;</p></li>
<li><p>“N”: used;</p></li>
<li><p>“K”: used;</p></li>
<li><p>“CEC”: not used;</p></li>
<li><p>“CN”: used;</p></li>
<li><p>“pH_CaCl”: not used;</p></li>
<li><p>“ph_H2o_ration_ph_CaCl”: not used;</p></li>
<li><p>“pH_H2O”: used;</p></li>
<li><p>“CaCO3”: used.</p></li>
</ul>
<p>Files were downloaded to <code>Geodata/2024/Soils/ESDAC/chemistry/</code> and no preprocessing
was carried out.</p>
</div>
<div id="Ch04.07.02" class="section level3 hasAnchor" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> Soil texture: Europe<a href="Ch04.html#Ch04.07.02" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Data on soil texture are obtained from <a href="https://esdac.jrc.ec.europa.eu/">European Soil Data Centre’s</a> European
Soil database <span class="citation">(<a href="#ref-esdac2">Panagos et al., 2022</a>)</span>. Dataset is available as <a href="https://esdac.jrc.ec.europa.eu/content/european-soil-database-v2-raster-library-1kmx1km">European Soil Database v2 Raster Library 1kmx1km</a>. There
are several properties available with download, <code>TXT</code> was used to
create <a href="Ch05.html#Ch05.02">soil texture product</a>. Files were downloaded to <code>eodata/2024/Soils/ESDAC/texture/</code>.</p>
<p>During the preprocessing (code below) layer was
projected to match 10 m template with “near” as interpolation method, value <code>0</code>
substituted with <code>NA</code> and masked and cropped to template. Result was saved for further
processing.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="Ch04.html#cb18-1" tabindex="-1"></a><span class="co"># libs ----</span></span>
<span id="cb18-2"><a href="Ch04.html#cb18-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(terra)) {<span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>); <span class="fu">require</span>(terra)}</span>
<span id="cb18-3"><a href="Ch04.html#cb18-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sf)) {<span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>); <span class="fu">require</span>(sf)}</span>
<span id="cb18-4"><a href="Ch04.html#cb18-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {<span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>); <span class="fu">require</span>(tidyverse)}</span>
<span id="cb18-5"><a href="Ch04.html#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="Ch04.html#cb18-6" tabindex="-1"></a><span class="co"># Template ----</span></span>
<span id="cb18-7"><a href="Ch04.html#cb18-7" tabindex="-1"></a>template10<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Templates/TemplateRasters/LV10m_10km.tif&quot;</span>)</span>
<span id="cb18-8"><a href="Ch04.html#cb18-8" tabindex="-1"></a></span>
<span id="cb18-9"><a href="Ch04.html#cb18-9" tabindex="-1"></a><span class="co"># ESDAC texture ----</span></span>
<span id="cb18-10"><a href="Ch04.html#cb18-10" tabindex="-1"></a></span>
<span id="cb18-11"><a href="Ch04.html#cb18-11" tabindex="-1"></a>sdTEXT<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/Soils/ESDAC/texture/SoilDatabaseV2_raster/ESDB-Raster-Library-1k-GeoTIFF-20240507/TEXT/TEXT.tif&quot;</span>)</span>
<span id="cb18-12"><a href="Ch04.html#cb18-12" tabindex="-1"></a><span class="fu">plot</span>(sdTEXT)</span>
<span id="cb18-13"><a href="Ch04.html#cb18-13" tabindex="-1"></a></span>
<span id="cb18-14"><a href="Ch04.html#cb18-14" tabindex="-1"></a>sdTEXT<span class="ot">=</span><span class="fu">project</span>(sdTEXT,template10,<span class="at">method=</span><span class="st">&quot;near&quot;</span>)</span>
<span id="cb18-15"><a href="Ch04.html#cb18-15" tabindex="-1"></a><span class="fu">plot</span>(sdTEXT)</span>
<span id="cb18-16"><a href="Ch04.html#cb18-16" tabindex="-1"></a></span>
<span id="cb18-17"><a href="Ch04.html#cb18-17" tabindex="-1"></a>sdTEXT<span class="ot">=</span><span class="fu">subst</span>(sdTEXT,<span class="dv">0</span>,<span class="cn">NA</span>)</span>
<span id="cb18-18"><a href="Ch04.html#cb18-18" tabindex="-1"></a><span class="fu">plot</span>(sdTEXT)</span>
<span id="cb18-19"><a href="Ch04.html#cb18-19" tabindex="-1"></a></span>
<span id="cb18-20"><a href="Ch04.html#cb18-20" tabindex="-1"></a>sdTEXT2<span class="ot">=</span><span class="fu">mask</span>(sdTEXT,template10,</span>
<span id="cb18-21"><a href="Ch04.html#cb18-21" tabindex="-1"></a>             <span class="at">filename=</span><span class="st">&quot;./RasterGrids_10m/2024/SoilTXT_ESDAC.tif&quot;</span>,</span>
<span id="cb18-22"><a href="Ch04.html#cb18-22" tabindex="-1"></a>             <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-23"><a href="Ch04.html#cb18-23" tabindex="-1"></a><span class="fu">plot</span>(sdTEXT2)</span></code></pre></div>
</details>
</div>
<div id="Ch04.07.03" class="section level3 hasAnchor" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> Soil texture: Farmland<a href="Ch04.html#Ch04.07.03" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Topsoil characteristics in Latvia were mapped in the mid-20th century, almost
exclusively in farmlands. With time, data were digitised and combined with some
other information creating artefacts. Therefore preprocessing was necessary. The
version we used was obtained form project “GOODWATER” C1D1_Deliverable_R2.</p>
<p>File is stored at <code>Geodata/2024/Soils/TopSoil_LV/</code>.</p>
<p>Preprocessing included:</p>
<ul>
<li><p>reclassification:</p>
<ul>
<li><p>we coded as <code>clay</code> (3) following labels from field <code>GrSast</code> - “M”,“M1”,“Mp”,“M2”,“sM1”,“sMp1”;</p></li>
<li><p>we coded as <code>silt</code> (2) following labels from field <code>GrSast</code> - “sM”, “sMp”, “M2”, “sM2”, “sMp2”, “sM3”, “sMp3”;</p></li>
<li><p>we coded as <code>sand</code> (1) following labels from field <code>GrSast</code> - “mS”, “mSp”, “S”, “sS”, “iS”, “Gr”, “mGr”, “D”;</p></li>
<li><p>we coded as <code>organic</code> (4) following labels from field <code>GrSast</code> - “l”, “vd”, “vj”, “n”,“T”;</p></li>
<li><p>left others as unclassified.</p></li>
</ul></li>
<li><p>coordinate transformation to epsg:3059;</p></li>
<li><p>invsestigated resulting layer looking for anomalies by scrolling in interactive
GIS. Investigations led to exclusion of land parcels from 200 ha.</p></li>
<li><p>rasterization to 10 m template with highest class code prevailing.</p></li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="Ch04.html#cb19-1" tabindex="-1"></a><span class="co"># libs ----</span></span>
<span id="cb19-2"><a href="Ch04.html#cb19-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(terra)) {<span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>); <span class="fu">require</span>(terra)}</span>
<span id="cb19-3"><a href="Ch04.html#cb19-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sf)) {<span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>); <span class="fu">require</span>(sf)}</span>
<span id="cb19-4"><a href="Ch04.html#cb19-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {<span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>); <span class="fu">require</span>(tidyverse)}</span>
<span id="cb19-5"><a href="Ch04.html#cb19-5" tabindex="-1"></a></span>
<span id="cb19-6"><a href="Ch04.html#cb19-6" tabindex="-1"></a><span class="co"># Template ----</span></span>
<span id="cb19-7"><a href="Ch04.html#cb19-7" tabindex="-1"></a>template10<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Templates/TemplateRasters/LV10m_10km.tif&quot;</span>)</span>
<span id="cb19-8"><a href="Ch04.html#cb19-8" tabindex="-1"></a></span>
<span id="cb19-9"><a href="Ch04.html#cb19-9" tabindex="-1"></a><span class="co"># Farmland soil texture ----</span></span>
<span id="cb19-10"><a href="Ch04.html#cb19-10" tabindex="-1"></a></span>
<span id="cb19-11"><a href="Ch04.html#cb19-11" tabindex="-1"></a>augsnes<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/Soils/TopSoil_LV/soil.gpkg&quot;</span>,<span class="at">layer=</span><span class="st">&quot;soilunion&quot;</span>)</span>
<span id="cb19-12"><a href="Ch04.html#cb19-12" tabindex="-1"></a></span>
<span id="cb19-13"><a href="Ch04.html#cb19-13" tabindex="-1"></a><span class="co"># calculate parcels area</span></span>
<span id="cb19-14"><a href="Ch04.html#cb19-14" tabindex="-1"></a>augsnes<span class="sc">$</span>platiba_ha<span class="ot">=</span><span class="fu">as.numeric</span>(<span class="fu">st_area</span>(augsnes))<span class="sc">/</span><span class="dv">10000</span></span>
<span id="cb19-15"><a href="Ch04.html#cb19-15" tabindex="-1"></a></span>
<span id="cb19-16"><a href="Ch04.html#cb19-16" tabindex="-1"></a><span class="co"># only parcels with existing information on texture</span></span>
<span id="cb19-17"><a href="Ch04.html#cb19-17" tabindex="-1"></a>tuksas<span class="ot">=</span>augsnes <span class="sc">%&gt;%</span> </span>
<span id="cb19-18"><a href="Ch04.html#cb19-18" tabindex="-1"></a>  <span class="fu">filter</span>(GrSast<span class="sc">==</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb19-19"><a href="Ch04.html#cb19-19" tabindex="-1"></a></span>
<span id="cb19-20"><a href="Ch04.html#cb19-20" tabindex="-1"></a><span class="co"># classification</span></span>
<span id="cb19-21"><a href="Ch04.html#cb19-21" tabindex="-1"></a>clay<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;M1&quot;</span>,<span class="st">&quot;Mp&quot;</span>,<span class="st">&quot;M2&quot;</span>,<span class="st">&quot;sM1&quot;</span>,<span class="st">&quot;sMp1&quot;</span>)</span>
<span id="cb19-22"><a href="Ch04.html#cb19-22" tabindex="-1"></a>silt<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;sM&quot;</span>, <span class="st">&quot;sMp&quot;</span>, <span class="st">&quot;M2&quot;</span>, <span class="st">&quot;sM2&quot;</span>, <span class="st">&quot;sMp2&quot;</span>, <span class="st">&quot;sM3&quot;</span>, <span class="st">&quot;sMp3&quot;</span>)</span>
<span id="cb19-23"><a href="Ch04.html#cb19-23" tabindex="-1"></a>sand<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;mS&quot;</span>, <span class="st">&quot;mSp&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;sS&quot;</span>, <span class="st">&quot;iS&quot;</span>, <span class="st">&quot;Gr&quot;</span>, <span class="st">&quot;mGr&quot;</span>, <span class="st">&quot;D&quot;</span>)</span>
<span id="cb19-24"><a href="Ch04.html#cb19-24" tabindex="-1"></a>peat<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="st">&quot;vd&quot;</span>, <span class="st">&quot;vj&quot;</span>, <span class="st">&quot;n&quot;</span>,<span class="st">&quot;T&quot;</span>)</span>
<span id="cb19-25"><a href="Ch04.html#cb19-25" tabindex="-1"></a>augsnes<span class="ot">=</span>augsnes <span class="sc">%&gt;%</span> </span>
<span id="cb19-26"><a href="Ch04.html#cb19-26" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grupas=</span><span class="fu">case_when</span>(GrSast <span class="sc">%in%</span> sand<span class="sc">~</span><span class="st">&quot;Sand&quot;</span>,</span>
<span id="cb19-27"><a href="Ch04.html#cb19-27" tabindex="-1"></a>                          GrSast <span class="sc">%in%</span> silt<span class="sc">~</span><span class="st">&quot;Silt&quot;</span>,</span>
<span id="cb19-28"><a href="Ch04.html#cb19-28" tabindex="-1"></a>                          GrSast <span class="sc">%in%</span> clay<span class="sc">~</span><span class="st">&quot;Clay&quot;</span>,</span>
<span id="cb19-29"><a href="Ch04.html#cb19-29" tabindex="-1"></a>                          GrSast <span class="sc">%in%</span> peat<span class="sc">~</span><span class="st">&quot;organika&quot;</span>,</span>
<span id="cb19-30"><a href="Ch04.html#cb19-30" tabindex="-1"></a>                          <span class="at">.default=</span><span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-31"><a href="Ch04.html#cb19-31" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grupas_num=</span><span class="fu">case_when</span>(GrSast <span class="sc">%in%</span> sand<span class="sc">~</span><span class="st">&quot;1&quot;</span>,</span>
<span id="cb19-32"><a href="Ch04.html#cb19-32" tabindex="-1"></a>                              GrSast <span class="sc">%in%</span> silt<span class="sc">~</span><span class="st">&quot;2&quot;</span>,</span>
<span id="cb19-33"><a href="Ch04.html#cb19-33" tabindex="-1"></a>                              GrSast <span class="sc">%in%</span> clay<span class="sc">~</span><span class="st">&quot;3&quot;</span>,</span>
<span id="cb19-34"><a href="Ch04.html#cb19-34" tabindex="-1"></a>                              GrSast <span class="sc">%in%</span> peat<span class="sc">~</span><span class="st">&quot;4&quot;</span>,</span>
<span id="cb19-35"><a href="Ch04.html#cb19-35" tabindex="-1"></a>                              <span class="at">.default=</span><span class="cn">NA</span>))</span>
<span id="cb19-36"><a href="Ch04.html#cb19-36" tabindex="-1"></a></span>
<span id="cb19-37"><a href="Ch04.html#cb19-37" tabindex="-1"></a><span class="co"># crs</span></span>
<span id="cb19-38"><a href="Ch04.html#cb19-38" tabindex="-1"></a>augsnes_3059<span class="ot">=</span><span class="fu">st_transform</span>(augsnes,<span class="at">crs=</span><span class="dv">3059</span>)</span>
<span id="cb19-39"><a href="Ch04.html#cb19-39" tabindex="-1"></a></span>
<span id="cb19-40"><a href="Ch04.html#cb19-40" tabindex="-1"></a><span class="co"># only existing texture classification</span></span>
<span id="cb19-41"><a href="Ch04.html#cb19-41" tabindex="-1"></a>augsnes_3059<span class="ot">=</span>augsnes_3059 <span class="sc">%&gt;%</span> </span>
<span id="cb19-42"><a href="Ch04.html#cb19-42" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(grupas_num))</span>
<span id="cb19-43"><a href="Ch04.html#cb19-43" tabindex="-1"></a></span>
<span id="cb19-44"><a href="Ch04.html#cb19-44" tabindex="-1"></a><span class="co"># parcels up to 200 ha</span></span>
<span id="cb19-45"><a href="Ch04.html#cb19-45" tabindex="-1"></a>augsnes_3059small<span class="ot">=</span>augsnes_3059 <span class="sc">%&gt;%</span> </span>
<span id="cb19-46"><a href="Ch04.html#cb19-46" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(grupas_num)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-47"><a href="Ch04.html#cb19-47" tabindex="-1"></a>  <span class="fu">filter</span>(platiba_ha<span class="sc">&lt;</span><span class="dv">200</span>)</span>
<span id="cb19-48"><a href="Ch04.html#cb19-48" tabindex="-1"></a></span>
<span id="cb19-49"><a href="Ch04.html#cb19-49" tabindex="-1"></a><span class="co"># rasterization</span></span>
<span id="cb19-50"><a href="Ch04.html#cb19-50" tabindex="-1"></a>virsaugsnem2<span class="ot">=</span><span class="fu">rasterize</span>(augsnes_3059small,template10,<span class="at">field=</span><span class="st">&quot;grupas_num&quot;</span>,<span class="at">fun=</span><span class="st">&quot;max&quot;</span>,</span>
<span id="cb19-51"><a href="Ch04.html#cb19-51" tabindex="-1"></a>                       <span class="at">filename=</span><span class="st">&quot;./RasterGrids_10m/2024/SoilTXT_topSoilLV.tif&quot;</span>,</span>
<span id="cb19-52"><a href="Ch04.html#cb19-52" tabindex="-1"></a>                       <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-53"><a href="Ch04.html#cb19-53" tabindex="-1"></a><span class="fu">plot</span>(virsaugsnem2)</span></code></pre></div>
</details>
</div>
<div id="Ch04.07.04" class="section level3 hasAnchor" number="4.7.4">
<h3><span class="header-section-number">4.7.4</span> Soil texture: Quaternary<a href="Ch04.html#Ch04.07.04" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Data on Quaternary Geology are digitised and stored by University of Latvia
Geology group.</p>
<p>File is stored at <code>Geodata/2024/Soils/QuaternaryGeology_LV/</code>.</p>
<p>Preprocessing included:</p>
<ul>
<li><p>reclassification:</p>
<ul>
<li><p>we coded as <code>sand</code> (1) following values from field <code>Litologija</code> - “smilts”, “smilts_aleiritiska”,
“smilts_dunjaina”, “smilts_grants”, “smilts_grants_oli”, “smilts_grants_oli_aleirits”, “smilts_kudraina”,
“smilts_videjgraudaina, malsmilts”, “smilts_videjgraudaina”~“Sand”;</p></li>
<li><p>we coded as <code>silt</code> (2) following values from field <code>Litologija</code> - “aleirits”, “aleirits_malains”,
“morena”, “smilts_aleirits_mals”, “smilts_aleirits_sapropelis”, “smilts_malaina_dazadgraudaina, malsmilts”;</p></li>
<li><p>we coded as <code>clay</code> (3) following values from field <code>Litologija</code> - “mals”, “mals_aleiritisks”;</p></li>
<li><p>we coded as <code>organic</code> (4) following values from field <code>Litologija</code> - “dunjas”, “kudra”;</p></li>
</ul></li>
<li><p>coordinate transformation to epsg:3059;</p></li>
<li><p>rasterization to 10 m template with highest class code prevailing.</p></li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="Ch04.html#cb20-1" tabindex="-1"></a><span class="co"># libs ----</span></span>
<span id="cb20-2"><a href="Ch04.html#cb20-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(terra)) {<span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>); <span class="fu">require</span>(terra)}</span>
<span id="cb20-3"><a href="Ch04.html#cb20-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sf)) {<span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>); <span class="fu">require</span>(sf)}</span>
<span id="cb20-4"><a href="Ch04.html#cb20-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {<span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>); <span class="fu">require</span>(tidyverse)}</span>
<span id="cb20-5"><a href="Ch04.html#cb20-5" tabindex="-1"></a></span>
<span id="cb20-6"><a href="Ch04.html#cb20-6" tabindex="-1"></a><span class="co"># Template ----</span></span>
<span id="cb20-7"><a href="Ch04.html#cb20-7" tabindex="-1"></a>template10<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Templates/TemplateRasters/LV10m_10km.tif&quot;</span>)</span>
<span id="cb20-8"><a href="Ch04.html#cb20-8" tabindex="-1"></a></span>
<span id="cb20-9"><a href="Ch04.html#cb20-9" tabindex="-1"></a><span class="co"># Quarternary geology ----</span></span>
<span id="cb20-10"><a href="Ch04.html#cb20-10" tabindex="-1"></a></span>
<span id="cb20-11"><a href="Ch04.html#cb20-11" tabindex="-1"></a>kvartars<span class="ot">=</span>sfarrow<span class="sc">::</span><span class="fu">st_read_parquet</span>(<span class="st">&quot;./Geodata/2024/Soils/QuaternaryGeology_LV/Kvartargeologija.parquet&quot;</span>)</span>
<span id="cb20-12"><a href="Ch04.html#cb20-12" tabindex="-1"></a></span>
<span id="cb20-13"><a href="Ch04.html#cb20-13" tabindex="-1"></a><span class="co"># reclassification</span></span>
<span id="cb20-14"><a href="Ch04.html#cb20-14" tabindex="-1"></a>kvartars<span class="ot">=</span>kvartars <span class="sc">%&gt;%</span> </span>
<span id="cb20-15"><a href="Ch04.html#cb20-15" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grupas =</span> <span class="fu">case_when</span>(Litologija<span class="sc">==</span><span class="st">&quot;aleirits&quot;</span><span class="sc">~</span><span class="st">&quot;Silt&quot;</span>,</span>
<span id="cb20-16"><a href="Ch04.html#cb20-16" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;aleirits_malains&quot;</span><span class="sc">~</span><span class="st">&quot;Silt&quot;</span>,</span>
<span id="cb20-17"><a href="Ch04.html#cb20-17" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;dunjas&quot;</span><span class="sc">~</span><span class="st">&quot;organika&quot;</span>,</span>
<span id="cb20-18"><a href="Ch04.html#cb20-18" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;kudra&quot;</span><span class="sc">~</span><span class="st">&quot;organika&quot;</span>,</span>
<span id="cb20-19"><a href="Ch04.html#cb20-19" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;mals&quot;</span><span class="sc">~</span><span class="st">&quot;Clay&quot;</span>,</span>
<span id="cb20-20"><a href="Ch04.html#cb20-20" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;mals_aleiritisks&quot;</span><span class="sc">~</span><span class="st">&quot;Clay&quot;</span>,</span>
<span id="cb20-21"><a href="Ch04.html#cb20-21" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;morena&quot;</span><span class="sc">~</span><span class="st">&quot;Silt&quot;</span>,</span>
<span id="cb20-22"><a href="Ch04.html#cb20-22" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;smilts&quot;</span><span class="sc">~</span><span class="st">&quot;Sand&quot;</span>,</span>
<span id="cb20-23"><a href="Ch04.html#cb20-23" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;smilts_aleiritiska&quot;</span><span class="sc">~</span><span class="st">&quot;Sand&quot;</span>,</span>
<span id="cb20-24"><a href="Ch04.html#cb20-24" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;smilts_aleirits_mals&quot;</span><span class="sc">~</span><span class="st">&quot;Silt&quot;</span>,</span>
<span id="cb20-25"><a href="Ch04.html#cb20-25" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;smilts_aleirits_sapropelis&quot;</span><span class="sc">~</span><span class="st">&quot;Silt&quot;</span>,</span>
<span id="cb20-26"><a href="Ch04.html#cb20-26" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;smilts_dunjaina&quot;</span><span class="sc">~</span><span class="st">&quot;Sand&quot;</span>,</span>
<span id="cb20-27"><a href="Ch04.html#cb20-27" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;smilts_grants&quot;</span><span class="sc">~</span><span class="st">&quot;Sand&quot;</span>,</span>
<span id="cb20-28"><a href="Ch04.html#cb20-28" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;smilts_grants_oli&quot;</span><span class="sc">~</span><span class="st">&quot;Sand&quot;</span>,</span>
<span id="cb20-29"><a href="Ch04.html#cb20-29" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;smilts_grants_oli_aleirits&quot;</span><span class="sc">~</span><span class="st">&quot;Sand&quot;</span>,</span>
<span id="cb20-30"><a href="Ch04.html#cb20-30" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;smilts_kudraina&quot;</span><span class="sc">~</span><span class="st">&quot;Sand&quot;</span>,</span>
<span id="cb20-31"><a href="Ch04.html#cb20-31" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;smilts_malaina_dazadgraudaina, malsmilts&quot;</span><span class="sc">~</span><span class="st">&quot;Silt&quot;</span>,</span>
<span id="cb20-32"><a href="Ch04.html#cb20-32" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;smilts_videjgraudaina, malsmilts&quot;</span><span class="sc">~</span><span class="st">&quot;Sand&quot;</span>,</span>
<span id="cb20-33"><a href="Ch04.html#cb20-33" tabindex="-1"></a>                            Litologija<span class="sc">==</span><span class="st">&quot;smilts_videjgraudaina&quot;</span><span class="sc">~</span><span class="st">&quot;Sand&quot;</span>,</span>
<span id="cb20-34"><a href="Ch04.html#cb20-34" tabindex="-1"></a>                            <span class="at">.default=</span><span class="cn">NA</span>))</span>
<span id="cb20-35"><a href="Ch04.html#cb20-35" tabindex="-1"></a><span class="co"># numeric codes</span></span>
<span id="cb20-36"><a href="Ch04.html#cb20-36" tabindex="-1"></a>kvartars<span class="ot">=</span>kvartars <span class="sc">%&gt;%</span> </span>
<span id="cb20-37"><a href="Ch04.html#cb20-37" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grupas_num=</span><span class="fu">case_when</span>(grupas <span class="sc">==</span> <span class="st">&quot;Sand&quot;</span> <span class="sc">~</span><span class="st">&quot;1&quot;</span>,</span>
<span id="cb20-38"><a href="Ch04.html#cb20-38" tabindex="-1"></a>                              grupas <span class="sc">==</span> <span class="st">&quot;Silt&quot;</span> <span class="sc">~</span><span class="st">&quot;2&quot;</span>,</span>
<span id="cb20-39"><a href="Ch04.html#cb20-39" tabindex="-1"></a>                              grupas <span class="sc">==</span> <span class="st">&quot;Clay&quot;</span> <span class="sc">~</span><span class="st">&quot;3&quot;</span>,</span>
<span id="cb20-40"><a href="Ch04.html#cb20-40" tabindex="-1"></a>                              grupas <span class="sc">==</span> <span class="st">&quot;organika&quot;</span> <span class="sc">~</span><span class="st">&quot;4&quot;</span>,</span>
<span id="cb20-41"><a href="Ch04.html#cb20-41" tabindex="-1"></a>                              <span class="at">.default=</span><span class="cn">NA</span>))</span>
<span id="cb20-42"><a href="Ch04.html#cb20-42" tabindex="-1"></a></span>
<span id="cb20-43"><a href="Ch04.html#cb20-43" tabindex="-1"></a><span class="co"># crs transformation</span></span>
<span id="cb20-44"><a href="Ch04.html#cb20-44" tabindex="-1"></a>kvartars_3059<span class="ot">=</span><span class="fu">st_transform</span>(kvartars,<span class="at">crs=</span><span class="dv">3059</span>)</span>
<span id="cb20-45"><a href="Ch04.html#cb20-45" tabindex="-1"></a></span>
<span id="cb20-46"><a href="Ch04.html#cb20-46" tabindex="-1"></a><span class="co"># nonmissing classes</span></span>
<span id="cb20-47"><a href="Ch04.html#cb20-47" tabindex="-1"></a>kvartars_3059<span class="ot">=</span>kvartars_3059 <span class="sc">%&gt;%</span> </span>
<span id="cb20-48"><a href="Ch04.html#cb20-48" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(grupas_num))</span>
<span id="cb20-49"><a href="Ch04.html#cb20-49" tabindex="-1"></a></span>
<span id="cb20-50"><a href="Ch04.html#cb20-50" tabindex="-1"></a><span class="co"># rasterization</span></span>
<span id="cb20-51"><a href="Ch04.html#cb20-51" tabindex="-1"></a>apaksaugsnem<span class="ot">=</span><span class="fu">rasterize</span>(kvartars_3059,template10,<span class="at">field=</span><span class="st">&quot;grupas_num&quot;</span>,<span class="at">fun=</span><span class="st">&quot;max&quot;</span>,</span>
<span id="cb20-52"><a href="Ch04.html#cb20-52" tabindex="-1"></a>                       <span class="at">filename=</span><span class="st">&quot;./RasterGrids_10m/2024/SoilTXT_QuarternaryLV.tif&quot;</span>,</span>
<span id="cb20-53"><a href="Ch04.html#cb20-53" tabindex="-1"></a>                       <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb20-54"><a href="Ch04.html#cb20-54" tabindex="-1"></a><span class="fu">plot</span>(apaksaugsnem)</span></code></pre></div>
</details>
</div>
<div id="Ch04.07.05" class="section level3 hasAnchor" number="4.7.5">
<h3><span class="header-section-number">4.7.5</span> Organic soils: SILAVA<a href="Ch04.html#Ch04.07.05" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The distribution of organic soils was modelled by EU LIFE Programme project
“Demonstration of climate change mitigation potential of nutrients rich organic
soils in Baltic States and Finland” at the scientific institue SILAVA. Results are
available from their web service: <a href="https://silava.forestradar.com/geoserver/silava" class="uri">https://silava.forestradar.com/geoserver/silava</a></p>
<p>Downloaded file was stored at <code>Geodata/2024/Soils/OrganicSoils_SILAVA/</code>.</p>
<p>Even tough the layer covers whole of Latvia, it has visible inconsistencies,
particularly stripes. These were drawn manually (as vector polygons) and masked
out as a part of preprocessing.</p>
<p>For further soil texture analysis we saved a GeoTIFF file with only presences.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="Ch04.html#cb21-1" tabindex="-1"></a><span class="co"># libs ----</span></span>
<span id="cb21-2"><a href="Ch04.html#cb21-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(terra)) {<span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>); <span class="fu">require</span>(terra)}</span>
<span id="cb21-3"><a href="Ch04.html#cb21-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sf)) {<span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>); <span class="fu">require</span>(sf)}</span>
<span id="cb21-4"><a href="Ch04.html#cb21-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {<span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>); <span class="fu">require</span>(tidyverse)}</span>
<span id="cb21-5"><a href="Ch04.html#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="Ch04.html#cb21-6" tabindex="-1"></a><span class="co"># Template ----</span></span>
<span id="cb21-7"><a href="Ch04.html#cb21-7" tabindex="-1"></a>template10<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Templates/TemplateRasters/LV10m_10km.tif&quot;</span>)</span>
<span id="cb21-8"><a href="Ch04.html#cb21-8" tabindex="-1"></a></span>
<span id="cb21-9"><a href="Ch04.html#cb21-9" tabindex="-1"></a><span class="co"># Organic Soils SILAVA ----</span></span>
<span id="cb21-10"><a href="Ch04.html#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a href="Ch04.html#cb21-11" tabindex="-1"></a>organika_silava<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/Soils/OrganicSoils_SILAVA/Silava_OrgSoils.tif&quot;</span>)</span>
<span id="cb21-12"><a href="Ch04.html#cb21-12" tabindex="-1"></a><span class="fu">plot</span>(organika_silava)</span>
<span id="cb21-13"><a href="Ch04.html#cb21-13" tabindex="-1"></a><span class="co"># visible stripes</span></span>
<span id="cb21-14"><a href="Ch04.html#cb21-14" tabindex="-1"></a></span>
<span id="cb21-15"><a href="Ch04.html#cb21-15" tabindex="-1"></a><span class="co"># only 40+ cm deep</span></span>
<span id="cb21-16"><a href="Ch04.html#cb21-16" tabindex="-1"></a>organika_silava<span class="ot">=</span><span class="fu">ifel</span>(organika_silava<span class="sc">==</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="cn">NA</span>)</span>
<span id="cb21-17"><a href="Ch04.html#cb21-17" tabindex="-1"></a>organika_silavaLV<span class="ot">=</span><span class="fu">project</span>(organika_silava,template10)</span>
<span id="cb21-18"><a href="Ch04.html#cb21-18" tabindex="-1"></a></span>
<span id="cb21-19"><a href="Ch04.html#cb21-19" tabindex="-1"></a><span class="co"># stripes drawn manually, rasterization</span></span>
<span id="cb21-20"><a href="Ch04.html#cb21-20" tabindex="-1"></a>silavas_telpai<span class="ot">=</span><span class="fu">st_read</span>(<span class="st">&quot;./Geodata/2024/Soils/OrganicSoils_SILAVA/stripam.gpkg&quot;</span>,</span>
<span id="cb21-21"><a href="Ch04.html#cb21-21" tabindex="-1"></a>                       <span class="at">layer=</span><span class="st">&quot;stripam&quot;</span>)</span>
<span id="cb21-22"><a href="Ch04.html#cb21-22" tabindex="-1"></a>silavas_telpai<span class="ot">=</span><span class="fu">st_transform</span>(silavas_telpai,<span class="at">crs=</span><span class="dv">3059</span>)</span>
<span id="cb21-23"><a href="Ch04.html#cb21-23" tabindex="-1"></a>silavas_telpai<span class="sc">$</span>yes<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb21-24"><a href="Ch04.html#cb21-24" tabindex="-1"></a>SilavasTelpa_10<span class="ot">=</span><span class="fu">rasterize</span>(silavas_telpai,template10,<span class="at">field=</span><span class="st">&quot;yes&quot;</span>)</span>
<span id="cb21-25"><a href="Ch04.html#cb21-25" tabindex="-1"></a></span>
<span id="cb21-26"><a href="Ch04.html#cb21-26" tabindex="-1"></a><span class="co"># presence-only layer without stripes</span></span>
<span id="cb21-27"><a href="Ch04.html#cb21-27" tabindex="-1"></a>silava_BezStripam1<span class="ot">=</span><span class="fu">ifel</span>(organika_silavaLV<span class="sc">==</span><span class="dv">1</span><span class="sc">&amp;</span>SilavasTelpa_10<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="cn">NA</span>)</span>
<span id="cb21-28"><a href="Ch04.html#cb21-28" tabindex="-1"></a>silava_BezStripam<span class="ot">=</span><span class="fu">mask</span>(silava_BezStripam1,template10)</span>
<span id="cb21-29"><a href="Ch04.html#cb21-29" tabindex="-1"></a><span class="fu">plot</span>(silava_BezStripam)</span>
<span id="cb21-30"><a href="Ch04.html#cb21-30" tabindex="-1"></a><span class="fu">writeRaster</span>(silava_BezStripam,</span>
<span id="cb21-31"><a href="Ch04.html#cb21-31" tabindex="-1"></a>            <span class="st">&quot;./RasterGrids_10m/2024/SoilTXT_OrganicSilava.tif&quot;</span>,</span>
<span id="cb21-32"><a href="Ch04.html#cb21-32" tabindex="-1"></a>            <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</details>
</div>
<div id="Ch04.07.06" class="section level3 hasAnchor" number="4.7.6">
<h3><span class="header-section-number">4.7.6</span> Organic soils: LU<a href="Ch04.html#Ch04.07.06" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The distribution of organic soils in farmlands was modelled by the University of
Latvia project “Improvement of sustainable soil resource management in agriculture”.</p>
<p>From all the results we used layer <code>YN_prognozes_smooth.tif</code> stored
at <code>Geodata/2024/Soils/OrganicSoils_LU/</code>.</p>
<p>Preprocessing consisted of projecting the layer to match 10 m template. Both presences
and absences were saved for further processing.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="Ch04.html#cb22-1" tabindex="-1"></a><span class="co"># libs ----</span></span>
<span id="cb22-2"><a href="Ch04.html#cb22-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(terra)) {<span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>); <span class="fu">require</span>(terra)}</span>
<span id="cb22-3"><a href="Ch04.html#cb22-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sf)) {<span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>); <span class="fu">require</span>(sf)}</span>
<span id="cb22-4"><a href="Ch04.html#cb22-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {<span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>); <span class="fu">require</span>(tidyverse)}</span>
<span id="cb22-5"><a href="Ch04.html#cb22-5" tabindex="-1"></a></span>
<span id="cb22-6"><a href="Ch04.html#cb22-6" tabindex="-1"></a><span class="co"># Template ----</span></span>
<span id="cb22-7"><a href="Ch04.html#cb22-7" tabindex="-1"></a>template10<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Templates/TemplateRasters/LV10m_10km.tif&quot;</span>)</span>
<span id="cb22-8"><a href="Ch04.html#cb22-8" tabindex="-1"></a></span>
<span id="cb22-9"><a href="Ch04.html#cb22-9" tabindex="-1"></a><span class="co"># Organic Soils LU ----</span></span>
<span id="cb22-10"><a href="Ch04.html#cb22-10" tabindex="-1"></a></span>
<span id="cb22-11"><a href="Ch04.html#cb22-11" tabindex="-1"></a></span>
<span id="cb22-12"><a href="Ch04.html#cb22-12" tabindex="-1"></a>kudra_norvegi<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/Soils/OrganicSoils_LU/YN_prognozes_smooth.tif&quot;</span>)</span>
<span id="cb22-13"><a href="Ch04.html#cb22-13" tabindex="-1"></a>kudra_norvLV<span class="ot">=</span><span class="fu">project</span>(kudra_norvegi,template10)</span>
<span id="cb22-14"><a href="Ch04.html#cb22-14" tabindex="-1"></a><span class="fu">plot</span>(kudra_norvLV)</span>
<span id="cb22-15"><a href="Ch04.html#cb22-15" tabindex="-1"></a></span>
<span id="cb22-16"><a href="Ch04.html#cb22-16" tabindex="-1"></a><span class="fu">writeRaster</span>(kudra_norvLV,</span>
<span id="cb22-17"><a href="Ch04.html#cb22-17" tabindex="-1"></a>            <span class="st">&quot;./RasterGrids_10m/2024/SoilTXT_OrganicLU.tif&quot;</span>,</span>
<span id="cb22-18"><a href="Ch04.html#cb22-18" tabindex="-1"></a>            <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</details>
</div>
</div>
<div id="Ch04.08" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Dynamic World data<a href="Ch04.html#Ch04.08" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Dynamic World (DW) is a relatively new Earth observation system product that
classifies land cover and land use (LULC) into nine categories (0=water, 1=trees,
2=grass, 3=flooded_vegetation, 4=crops, 5=shrub_and_scrub, 6=built, 7=bare,
8=snow_and_ice), for each ESA Copernicus Sentinel-2 image with identified
cloudiness ≤35, allowing for filtering and various aggregations <span class="citation">(<a href="#ref-DynWorld">Brown et al., 2022</a>)</span>.</p>
<p>DW input information - raster layer for each season in each year - prepared on
the Google Earth Engine platform <span class="citation">(<a href="#ref-GEEpaper">Gorelick et al., 2017</a>)</span> using
a <a href="https://code.earthengine.google.com/0f9fd61ee41af11d218ce8692abebe9b">replication script</a>.
To use this script, you need a <a href="https://console.cloud.google.com/earth-engine/welcome">GEE account and project</a>
and sufficient space on Google Drive. When executing the command line, a download
will be offered for a file covering the time period from the value in row 7 to
the value in row 8 (the file name should be specified in row 32, its
description in row 33 and the directory on Google Drive in row 31, or
all of this can be specified by confirming the save). This script is not optimized
for preparing all seasonal sections for all years, so in order to reproduce or
expand this study, it is necessary to change it manually.</p>
<p>Downloaded files are to be stored at <code>Geodata/2024/DynamicWorld/RAW/</code>.</p>
<p>During download, it can be seen that each layer covering the whole of Latvia is
divided into several sheets. This is because, in order to ensure a true zero
class (class “water” rather than background), the layers are encoded as Float
rather than integers. All of these tiles need to be downloaded, and the following
R command lines combine them, ensuring that the coordinate system and pixels
correspond to the reference raster.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="Ch04.html#cb23-1" tabindex="-1"></a><span class="co"># libs ----</span></span>
<span id="cb23-2"><a href="Ch04.html#cb23-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(terra)) {<span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>); <span class="fu">require</span>(terra)}</span>
<span id="cb23-3"><a href="Ch04.html#cb23-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {<span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>); <span class="fu">require</span>(tidyverse)}</span>
<span id="cb23-4"><a href="Ch04.html#cb23-4" tabindex="-1"></a></span>
<span id="cb23-5"><a href="Ch04.html#cb23-5" tabindex="-1"></a><span class="co"># 10 m template ----</span></span>
<span id="cb23-6"><a href="Ch04.html#cb23-6" tabindex="-1"></a>template10<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Templates/TemplateRasters/LV10m_10km.tif&quot;</span>)</span>
<span id="cb23-7"><a href="Ch04.html#cb23-7" tabindex="-1"></a></span>
<span id="cb23-8"><a href="Ch04.html#cb23-8" tabindex="-1"></a><span class="co"># DW export no GEE ----</span></span>
<span id="cb23-9"><a href="Ch04.html#cb23-9" tabindex="-1"></a>faili<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">faili=</span><span class="fu">list.files</span>(<span class="st">&quot;./Geodata/2024/DynamicWorld/RAW/&quot;</span>))</span>
<span id="cb23-10"><a href="Ch04.html#cb23-10" tabindex="-1"></a>faili<span class="sc">$</span>celi_sakums<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;./Geodata/2024/DynamicWorld/RAW/&quot;</span>,faili<span class="sc">$</span>faili)</span>
<span id="cb23-11"><a href="Ch04.html#cb23-11" tabindex="-1"></a></span>
<span id="cb23-12"><a href="Ch04.html#cb23-12" tabindex="-1"></a><span class="co"># prepping ----</span></span>
<span id="cb23-13"><a href="Ch04.html#cb23-13" tabindex="-1"></a>faili<span class="ot">=</span>faili <span class="sc">%&gt;%</span> </span>
<span id="cb23-14"><a href="Ch04.html#cb23-14" tabindex="-1"></a>  <span class="fu">separate</span>(faili,<span class="at">into=</span><span class="fu">c</span>(<span class="st">&quot;DW&quot;</span>,<span class="st">&quot;gads&quot;</span>,<span class="st">&quot;periods&quot;</span>,<span class="st">&quot;parejais&quot;</span>),<span class="at">sep=</span><span class="st">&quot;_&quot;</span>,<span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-15"><a href="Ch04.html#cb23-15" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unikalais=</span><span class="fu">paste0</span>(DW,<span class="st">&quot;_&quot;</span>,gads,<span class="st">&quot;_&quot;</span>,periods),</span>
<span id="cb23-16"><a href="Ch04.html#cb23-16" tabindex="-1"></a>         <span class="at">mosaic_name=</span><span class="fu">paste0</span>(unikalais,<span class="st">&quot;.tif&quot;</span>),</span>
<span id="cb23-17"><a href="Ch04.html#cb23-17" tabindex="-1"></a>         <span class="at">masaic_cels=</span><span class="fu">paste0</span>(<span class="st">&quot;./Geodata/2024/DynamicWorld/&quot;</span>,mosaic_name))</span>
<span id="cb23-18"><a href="Ch04.html#cb23-18" tabindex="-1"></a></span>
<span id="cb23-19"><a href="Ch04.html#cb23-19" tabindex="-1"></a><span class="co"># every layer consists of two tiles</span></span>
<span id="cb23-20"><a href="Ch04.html#cb23-20" tabindex="-1"></a>unikalie<span class="ot">=</span><span class="fu">levels</span>(<span class="fu">factor</span>(faili<span class="sc">$</span>unikalais))</span>
<span id="cb23-21"><a href="Ch04.html#cb23-21" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">table</span>(faili<span class="sc">$</span>unikalais))</span>
<span id="cb23-22"><a href="Ch04.html#cb23-22" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">table</span>(faili<span class="sc">$</span>unikalais))</span>
<span id="cb23-23"><a href="Ch04.html#cb23-23" tabindex="-1"></a></span>
<span id="cb23-24"><a href="Ch04.html#cb23-24" tabindex="-1"></a><span class="co"># job</span></span>
<span id="cb23-25"><a href="Ch04.html#cb23-25" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(unikalie)){</span>
<span id="cb23-26"><a href="Ch04.html#cb23-26" tabindex="-1"></a>  unikalais<span class="ot">=</span>faili <span class="sc">%&gt;%</span> <span class="fu">filter</span>(unikalais<span class="sc">==</span>unikalie[i])</span>
<span id="cb23-27"><a href="Ch04.html#cb23-27" tabindex="-1"></a>  beigu_cels<span class="ot">=</span><span class="fu">unique</span>(unikalais<span class="sc">$</span>masaic_cels)</span>
<span id="cb23-28"><a href="Ch04.html#cb23-28" tabindex="-1"></a>  </span>
<span id="cb23-29"><a href="Ch04.html#cb23-29" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb23-30"><a href="Ch04.html#cb23-30" tabindex="-1"></a>  </span>
<span id="cb23-31"><a href="Ch04.html#cb23-31" tabindex="-1"></a>  viens<span class="ot">=</span><span class="fu">rast</span>(unikalais<span class="sc">$</span>celi_sakums[<span class="dv">1</span>])</span>
<span id="cb23-32"><a href="Ch04.html#cb23-32" tabindex="-1"></a>  divi<span class="ot">=</span><span class="fu">rast</span>(unikalais<span class="sc">$</span>celi_sakums[<span class="dv">2</span>])</span>
<span id="cb23-33"><a href="Ch04.html#cb23-33" tabindex="-1"></a>  </span>
<span id="cb23-34"><a href="Ch04.html#cb23-34" tabindex="-1"></a>  viens2<span class="ot">=</span><span class="fu">project</span>(viens,template10)</span>
<span id="cb23-35"><a href="Ch04.html#cb23-35" tabindex="-1"></a>  divi2<span class="ot">=</span><span class="fu">project</span>(divi,template10)</span>
<span id="cb23-36"><a href="Ch04.html#cb23-36" tabindex="-1"></a>  </span>
<span id="cb23-37"><a href="Ch04.html#cb23-37" tabindex="-1"></a>  mozaika<span class="ot">=</span><span class="fu">mosaic</span>(viens2,divi2,<span class="at">fun=</span><span class="st">&quot;first&quot;</span>)</span>
<span id="cb23-38"><a href="Ch04.html#cb23-38" tabindex="-1"></a>  maskets<span class="ot">=</span><span class="fu">mask</span>(mozaika,template10,</span>
<span id="cb23-39"><a href="Ch04.html#cb23-39" tabindex="-1"></a>               <span class="at">filename=</span>beigu_cels,</span>
<span id="cb23-40"><a href="Ch04.html#cb23-40" tabindex="-1"></a>               <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb23-41"><a href="Ch04.html#cb23-41" tabindex="-1"></a>  </span>
<span id="cb23-42"><a href="Ch04.html#cb23-42" tabindex="-1"></a>  <span class="fu">print</span>(beigu_cels)</span>
<span id="cb23-43"><a href="Ch04.html#cb23-43" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
<div id="Ch04.09" class="section level2 hasAnchor" number="4.9">
<h2><span class="header-section-number">4.9</span> The Global Forest Watch<a href="Ch04.html#Ch04.09" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Global Forest Watch (GFW) is a widely known product that describes tree
canopy cover in 2000, its annual growth from 2001 to 2012, and its annual
loss from 2001 to the current version, which is updated annually <span class="citation">(<a href="#ref-theGFW">Hansen et al., 2013</a>)</span>. The
data is available both on the <a href="https://data.globalforestwatch.org/documents/941f17325a494ed78c4817f9bb20f33a/explore">project website</a>
and on <a href="https://developers.google.com/earth-engine/datasets/catalog/UMD_hansen_global_forest_change_2024_v1_12">GEE</a>, where
it was developed. This project uses v1.12, in which the last year of tree loss
dating is 2024, preparing it for download on the GEE platform with
this <a href="https://code.earthengine.google.com/4a12b7504ceafe7f422dd7efbe804b67">replication script</a>.
To use this script, you need a <a href="https://console.cloud.google.com/earth-engine/welcome">GEE account and project</a>
and sufficient space on Google Drive. When executing the command lines, you will
be offered to download the file, which you need to save to Google Drive.</p>
<p>After executing the command lines and preparing the results in Google Drive,
four files are available for download. The location to download them is
<code>Geodata/2024/Trees/GFW/RAW/</code>. After download, these files need to be projected
to match the reference raster.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="Ch04.html#cb24-1" tabindex="-1"></a><span class="co"># libs ----</span></span>
<span id="cb24-2"><a href="Ch04.html#cb24-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(terra)) {<span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>); <span class="fu">require</span>(terra)}</span>
<span id="cb24-3"><a href="Ch04.html#cb24-3" tabindex="-1"></a></span>
<span id="cb24-4"><a href="Ch04.html#cb24-4" tabindex="-1"></a><span class="co"># 10 m rastra template ----</span></span>
<span id="cb24-5"><a href="Ch04.html#cb24-5" tabindex="-1"></a>template10<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Templates/TemplateRasters/LV10m_10km.tif&quot;</span>)</span>
<span id="cb24-6"><a href="Ch04.html#cb24-6" tabindex="-1"></a></span>
<span id="cb24-7"><a href="Ch04.html#cb24-7" tabindex="-1"></a><span class="co"># TreeCoverLoss ----</span></span>
<span id="cb24-8"><a href="Ch04.html#cb24-8" tabindex="-1"></a>treecoverloss<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/Trees/GFW/RAW/TreeCoverLoss_v1_12.tif&quot;</span>)</span>
<span id="cb24-9"><a href="Ch04.html#cb24-9" tabindex="-1"></a></span>
<span id="cb24-10"><a href="Ch04.html#cb24-10" tabindex="-1"></a>tcl<span class="ot">=</span><span class="fu">ifel</span>(treecoverloss<span class="sc">&lt;</span><span class="dv">1</span>,<span class="cn">NA</span>,treecoverloss)</span>
<span id="cb24-11"><a href="Ch04.html#cb24-11" tabindex="-1"></a></span>
<span id="cb24-12"><a href="Ch04.html#cb24-12" tabindex="-1"></a>tcl2<span class="ot">=</span>terra<span class="sc">::</span><span class="fu">project</span>(tcl,paraugs)</span>
<span id="cb24-13"><a href="Ch04.html#cb24-13" tabindex="-1"></a>tcl3<span class="ot">=</span><span class="fu">mask</span>(tcl2,paraugs,<span class="at">filename=</span><span class="st">&quot;./Geodata/2024/Trees/GFW/TreeCoverLoss_v1_12.tif&quot;</span>,<span class="at">overwrite=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</details>
</div>
<div id="Ch04.10" class="section level2 hasAnchor" number="4.10">
<h2><span class="header-section-number">4.10</span> Palsar<a href="Ch04.html#Ch04.10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Palsar Forests resource is based on PALSAR-2 synthetic aperture radar (SAR)
reflectance classification of forest and non-forest land with a pixel
resolution of 25 m. Forests are classified as areas of at least 0.5 ha covered
with trees, where tree cover (at least 5 m high) is at least 10% <span class="citation">(<a href="#ref-PALSARForest">Shimada et al., 2013</a>)</span>.
The data is available at <a href="https://developers.google.com/earth-engine/datasets/catalog/JAXA_ALOS_PALSAR_YEARLY_FNF4">GEE</a>.
This project uses a 4-class version (1=Dense Forest, 2=Non-dense Forest,
3=Non-Forest, 4=Water), in which the last tree cover dating year is 2020,
prepared for download on the GEE platform with this
<a href="https://code.earthengine.google.com/3ec78ab057e6c8910cb1546002132b34">replication script</a>.
To use this script, you need a <a href="https://console.cloud.google.com/earth-engine/welcome">GEE account and project</a>
and sufficient space on Google Drive. When executing the command lines, you will
be offered to download the file, which you need to save to Google Drive.</p>
<p>After executing the command lines and preparing the results in Google Drive,
four files are available for download. The location to download them is
<code>Geodata/2024/Trees/Palsar/RAW/</code>. After download, these files need to be projected
to match the reference raster and merged. In this resource, trees are coded into
two groups: 1=Dense Forest and 2=Non-dense Forest, which need to be merged and
the rest converted to missing values (code below).</p>
<p>Although the data in this resource describes the situation in 2020 rather
than 2024, it has been used because <a href="Ch04.html#Ch04.09">The Global Forest Watch data</a> is
available to describe the disappearance of tree canopy cover, but the appearance
of canopy cover is not so rapid that there would be significant changes over a
four-year period.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="Ch04.html#cb25-1" tabindex="-1"></a><span class="co"># libs ----</span></span>
<span id="cb25-2"><a href="Ch04.html#cb25-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(terra)) {<span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>); <span class="fu">require</span>(terra)}</span>
<span id="cb25-3"><a href="Ch04.html#cb25-3" tabindex="-1"></a></span>
<span id="cb25-4"><a href="Ch04.html#cb25-4" tabindex="-1"></a><span class="co"># 10 m rastra template ----</span></span>
<span id="cb25-5"><a href="Ch04.html#cb25-5" tabindex="-1"></a>template10<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Templates/TemplateRasters/LV10m_10km.tif&quot;</span>)</span>
<span id="cb25-6"><a href="Ch04.html#cb25-6" tabindex="-1"></a></span>
<span id="cb25-7"><a href="Ch04.html#cb25-7" tabindex="-1"></a></span>
<span id="cb25-8"><a href="Ch04.html#cb25-8" tabindex="-1"></a><span class="co"># PALSAR Forests ----</span></span>
<span id="cb25-9"><a href="Ch04.html#cb25-9" tabindex="-1"></a></span>
<span id="cb25-10"><a href="Ch04.html#cb25-10" tabindex="-1"></a>fnf1<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/Trees/Palsar/RAW/ForestNonForest-0000023296-0000023296.tif&quot;</span>)</span>
<span id="cb25-11"><a href="Ch04.html#cb25-11" tabindex="-1"></a>fnf2<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/Trees/Palsar/RAW/ForestNonForest-0000023296-0000000000.tif&quot;</span>)</span>
<span id="cb25-12"><a href="Ch04.html#cb25-12" tabindex="-1"></a>fnf3<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/Trees/Palsar/RAW/ForestNonForest-0000000000-0000023296.tif&quot;</span>)</span>
<span id="cb25-13"><a href="Ch04.html#cb25-13" tabindex="-1"></a>fnf4<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/Trees/Palsar/RAW/ForestNonForest-0000000000-0000000000.tif&quot;</span>)</span>
<span id="cb25-14"><a href="Ch04.html#cb25-14" tabindex="-1"></a></span>
<span id="cb25-15"><a href="Ch04.html#cb25-15" tabindex="-1"></a>fnf1p<span class="ot">=</span>terra<span class="sc">::</span><span class="fu">project</span>(fnf1,template10)</span>
<span id="cb25-16"><a href="Ch04.html#cb25-16" tabindex="-1"></a>fnf2p<span class="ot">=</span>terra<span class="sc">::</span><span class="fu">project</span>(fnf2,template10)</span>
<span id="cb25-17"><a href="Ch04.html#cb25-17" tabindex="-1"></a>fnf3p<span class="ot">=</span>terra<span class="sc">::</span><span class="fu">project</span>(fnf3,template10)</span>
<span id="cb25-18"><a href="Ch04.html#cb25-18" tabindex="-1"></a>fnf4p<span class="ot">=</span>terra<span class="sc">::</span><span class="fu">project</span>(fnf4,template10)</span>
<span id="cb25-19"><a href="Ch04.html#cb25-19" tabindex="-1"></a></span>
<span id="cb25-20"><a href="Ch04.html#cb25-20" tabindex="-1"></a>fnfA<span class="ot">=</span>terra<span class="sc">::</span><span class="fu">merge</span>(fnf1p,fnf2p)</span>
<span id="cb25-21"><a href="Ch04.html#cb25-21" tabindex="-1"></a>fnfB<span class="ot">=</span>terra<span class="sc">::</span><span class="fu">merge</span>(fnfA,fnf3p)</span>
<span id="cb25-22"><a href="Ch04.html#cb25-22" tabindex="-1"></a>fnfC<span class="ot">=</span>terra<span class="sc">::</span><span class="fu">merge</span>(fnfB,fnf4p)</span>
<span id="cb25-23"><a href="Ch04.html#cb25-23" tabindex="-1"></a><span class="fu">plot</span>(fnfC)</span>
<span id="cb25-24"><a href="Ch04.html#cb25-24" tabindex="-1"></a></span>
<span id="cb25-25"><a href="Ch04.html#cb25-25" tabindex="-1"></a>fnf_X<span class="ot">=</span><span class="fu">ifel</span>(fnfC<span class="sc">&lt;=</span><span class="dv">2</span><span class="sc">&amp;</span>fnfC<span class="sc">&gt;=</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="cn">NA</span>)</span>
<span id="cb25-26"><a href="Ch04.html#cb25-26" tabindex="-1"></a><span class="fu">plot</span>(fnf_X)</span>
<span id="cb25-27"><a href="Ch04.html#cb25-27" tabindex="-1"></a></span>
<span id="cb25-28"><a href="Ch04.html#cb25-28" tabindex="-1"></a>fnf_XX<span class="ot">=</span><span class="fu">mask</span>(fnf_X,template10,</span>
<span id="cb25-29"><a href="Ch04.html#cb25-29" tabindex="-1"></a>            <span class="at">filename=</span><span class="st">&quot;./Geodata/2024/Trees/Palsar/Palsar_Forests.tif&quot;</span>,</span>
<span id="cb25-30"><a href="Ch04.html#cb25-30" tabindex="-1"></a>            <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</details>
</div>
<div id="Ch04.11" class="section level2 hasAnchor" number="4.11">
<h2><span class="header-section-number">4.11</span> CHELSA v2.1<a href="Ch04.html#Ch04.11" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Climatologies at high resolution for the Earth’s land surface areas (CHELSA) is
30 arc second global downscaled climate data set <span class="citation">(<a href="#ref-CHELSA">Karger et al., 2017</a>)</span>. The temperature algorithm
is based on statistical downscaling of atmospheric temperatures. The precipitation
algorithm incorporates orographic predictors including wind fields, valley
exposition, and boundary layer height, with a subsequent bias correction. CHELSA
climatological data has a similar accuracy as other products for temperature, but
that its predictions of precipitation patterns are better <span class="citation">(<a href="#ref-CHELSA">Karger et al., 2017</a>)</span>. Data
(1980-2010 baseline) are freely available for download
from <a href="https://chelsa-climate.org/">homepage</a> forwarding
to download server, providing download links for selected products. There is also technical
specification available, to decode layer names (<a href="https://chelsa-climate.org/wp-admin/download-page/CHELSA_tech_specification_V2.pdf" class="uri">https://chelsa-climate.org/wp-admin/download-page/CHELSA_tech_specification_V2.pdf</a>).</p>
<p>The download links we used together with renaming scheme are <a href="https://github.com/aavotins/HiQBioDiv_EGVs/blob/main/Data/Geodata/2024/CHELSA/CHELSAdownload_rename.csv">available</a>
with this document. The following command lines perform download, crop to the
extent of Latvia (using 1 km vector grid) and saves files for further processing
described with other <a href="Ch06.html#Ch06">EGVs</a>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="Ch04.html#cb26-1" tabindex="-1"></a><span class="co"># libs ----</span></span>
<span id="cb26-2"><a href="Ch04.html#cb26-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(terra)) {<span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>); <span class="fu">require</span>(terra)}</span>
<span id="cb26-3"><a href="Ch04.html#cb26-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sf)) {<span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>); <span class="fu">require</span>(sf)}</span>
<span id="cb26-4"><a href="Ch04.html#cb26-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sfarrow)) {<span class="fu">install.packages</span>(<span class="st">&quot;sfarrow&quot;</span>); <span class="fu">require</span>(sfarrow)}</span>
<span id="cb26-5"><a href="Ch04.html#cb26-5" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {<span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>); <span class="fu">require</span>(tidyverse)}</span>
<span id="cb26-6"><a href="Ch04.html#cb26-6" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(curl)) {<span class="fu">install.packages</span>(<span class="st">&quot;curl&quot;</span>); <span class="fu">require</span>(curl)}</span>
<span id="cb26-7"><a href="Ch04.html#cb26-7" tabindex="-1"></a></span>
<span id="cb26-8"><a href="Ch04.html#cb26-8" tabindex="-1"></a><span class="co"># templates ----</span></span>
<span id="cb26-9"><a href="Ch04.html#cb26-9" tabindex="-1"></a><span class="co"># 1km grid</span></span>
<span id="cb26-10"><a href="Ch04.html#cb26-10" tabindex="-1"></a>tikls1km<span class="ot">=</span>sfarrow<span class="sc">::</span><span class="fu">st_read_parquet</span>(<span class="st">&quot;./Templates/TemplateGrids/tikls1km_sauzeme.parquet&quot;</span>)</span>
<span id="cb26-11"><a href="Ch04.html#cb26-11" tabindex="-1"></a>telpai<span class="ot">=</span>tikls1km <span class="sc">%&gt;%</span> </span>
<span id="cb26-12"><a href="Ch04.html#cb26-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yes=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-13"><a href="Ch04.html#cb26-13" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">yes=</span><span class="fu">max</span>(yes)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-14"><a href="Ch04.html#cb26-14" tabindex="-1"></a>  <span class="fu">st_buffer</span>(.,<span class="at">dist=</span><span class="dv">10000</span>)</span>
<span id="cb26-15"><a href="Ch04.html#cb26-15" tabindex="-1"></a></span>
<span id="cb26-16"><a href="Ch04.html#cb26-16" tabindex="-1"></a><span class="co"># download and crop ----</span></span>
<span id="cb26-17"><a href="Ch04.html#cb26-17" tabindex="-1"></a></span>
<span id="cb26-18"><a href="Ch04.html#cb26-18" tabindex="-1"></a>links_names<span class="ot">=</span><span class="fu">read_csv</span>(<span class="st">&quot;./Geodata/2024/CHELSA/CHELSAdownload_rename.csv&quot;</span>)</span>
<span id="cb26-19"><a href="Ch04.html#cb26-19" tabindex="-1"></a>links_names<span class="ot">=</span>links_names <span class="sc">%&gt;%</span> </span>
<span id="cb26-20"><a href="Ch04.html#cb26-20" tabindex="-1"></a>  <span class="fu">filter</span>(todownload<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb26-21"><a href="Ch04.html#cb26-21" tabindex="-1"></a></span>
<span id="cb26-22"><a href="Ch04.html#cb26-22" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(links_names<span class="sc">$</span>localname)){</span>
<span id="cb26-23"><a href="Ch04.html#cb26-23" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb26-24"><a href="Ch04.html#cb26-24" tabindex="-1"></a>  sakums<span class="ot">=</span><span class="fu">Sys.time</span>()</span>
<span id="cb26-25"><a href="Ch04.html#cb26-25" tabindex="-1"></a>  links<span class="ot">=</span>links_names<span class="sc">$</span>weblocation[i]</span>
<span id="cb26-26"><a href="Ch04.html#cb26-26" tabindex="-1"></a>  saving1<span class="ot">=</span><span class="st">&quot;./Geodata/2024/CHELSA/draza.tif&quot;</span></span>
<span id="cb26-27"><a href="Ch04.html#cb26-27" tabindex="-1"></a>  saving2<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;./Geodata/2024/CHELSA/&quot;</span>,links_names<span class="sc">$</span>localname[i])</span>
<span id="cb26-28"><a href="Ch04.html#cb26-28" tabindex="-1"></a>  </span>
<span id="cb26-29"><a href="Ch04.html#cb26-29" tabindex="-1"></a>  <span class="fu">curl_download</span>(<span class="at">url=</span>links,<span class="at">destfile =</span> saving1,<span class="at">quiet =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-30"><a href="Ch04.html#cb26-30" tabindex="-1"></a>  fails<span class="ot">=</span><span class="fu">rast</span>(saving1)</span>
<span id="cb26-31"><a href="Ch04.html#cb26-31" tabindex="-1"></a>  telpa<span class="ot">=</span><span class="fu">st_transform</span>(telpai,<span class="at">crs=</span><span class="fu">st_crs</span>(fails))</span>
<span id="cb26-32"><a href="Ch04.html#cb26-32" tabindex="-1"></a>  nogriezts<span class="ot">=</span><span class="fu">crop</span>(fails,telpa,</span>
<span id="cb26-33"><a href="Ch04.html#cb26-33" tabindex="-1"></a>                 <span class="at">filename=</span>saving2,</span>
<span id="cb26-34"><a href="Ch04.html#cb26-34" tabindex="-1"></a>                 <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb26-35"><a href="Ch04.html#cb26-35" tabindex="-1"></a>  <span class="fu">unlink</span>(saving1)</span>
<span id="cb26-36"><a href="Ch04.html#cb26-36" tabindex="-1"></a>  beigas<span class="ot">=</span><span class="fu">Sys.time</span>()</span>
<span id="cb26-37"><a href="Ch04.html#cb26-37" tabindex="-1"></a>  ilgums<span class="ot">=</span>beigas<span class="sc">-</span>sakums</span>
<span id="cb26-38"><a href="Ch04.html#cb26-38" tabindex="-1"></a>  <span class="fu">print</span>(ilgums)</span>
<span id="cb26-39"><a href="Ch04.html#cb26-39" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
<div id="Ch04.12" class="section level2 hasAnchor" number="4.12">
<h2><span class="header-section-number">4.12</span> HydroClim data<a href="Ch04.html#Ch04.12" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>HydroClim is a near-global freshwater-specific environmental variable dataset,
created for biodiversity analysis at 1 km resolution <span class="citation">(<a href="#ref-HydroClim">Domisch et al., 2015</a>)</span>. Dataset
contains many different variables along the HydroSHEDS river
network <span class="citation">(<a href="#ref-HydroSheds">Lehner et al., 2008</a>)</span>, including upstream climate recalculated from
worldclim <span class="citation">(<a href="#ref-worldclim_hijmans">Hijmans et al., 2005</a>)</span>. We downloaded (to <code>Geodata/2024/HydroClim/</code>)
averaged upstream climate from <a href="https://zenodo.org/records/5089529">Zenodo repository</a>
(available also from <a href="https://datadryad.org/dataset/doi:10.5061/dryad.dv920">Dryad</a>)
and cropped to the extent of Latvia and renamed files for further processing
with the code below. Renaming scheme is <a href="https://github.com/aavotins/HiQBioDiv_EGVs/blob/main/Data/Geodata/2024/HydroClim/HydroClim_renaming.csv">published with document</a></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="Ch04.html#cb27-1" tabindex="-1"></a><span class="co"># libs ----</span></span>
<span id="cb27-2"><a href="Ch04.html#cb27-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(terra)) {<span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>); <span class="fu">require</span>(terra)}</span>
<span id="cb27-3"><a href="Ch04.html#cb27-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sf)) {<span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>); <span class="fu">require</span>(sf)}</span>
<span id="cb27-4"><a href="Ch04.html#cb27-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sfarrow)) {<span class="fu">install.packages</span>(<span class="st">&quot;sfarrow&quot;</span>); <span class="fu">require</span>(sfarrow)}</span>
<span id="cb27-5"><a href="Ch04.html#cb27-5" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {<span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>); <span class="fu">require</span>(tidyverse)}</span>
<span id="cb27-6"><a href="Ch04.html#cb27-6" tabindex="-1"></a></span>
<span id="cb27-7"><a href="Ch04.html#cb27-7" tabindex="-1"></a><span class="co"># templates ----</span></span>
<span id="cb27-8"><a href="Ch04.html#cb27-8" tabindex="-1"></a>template100<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Templates/TemplateRasters/LV100m_10km.tif&quot;</span>)</span>
<span id="cb27-9"><a href="Ch04.html#cb27-9" tabindex="-1"></a>tikls1km<span class="ot">=</span>sfarrow<span class="sc">::</span><span class="fu">st_read_parquet</span>(<span class="st">&quot;./Templates/TemplateGrids/tikls1km_sauzeme.parquet&quot;</span>)</span>
<span id="cb27-10"><a href="Ch04.html#cb27-10" tabindex="-1"></a></span>
<span id="cb27-11"><a href="Ch04.html#cb27-11" tabindex="-1"></a><span class="co"># reading HydroClim ----</span></span>
<span id="cb27-12"><a href="Ch04.html#cb27-12" tabindex="-1"></a>videjie<span class="ot">=</span>terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/HydroClim/hydroclim_average+sum.nc&quot;</span>)</span>
<span id="cb27-13"><a href="Ch04.html#cb27-13" tabindex="-1"></a></span>
<span id="cb27-14"><a href="Ch04.html#cb27-14" tabindex="-1"></a><span class="co"># reading dictionary -----</span></span>
<span id="cb27-15"><a href="Ch04.html#cb27-15" tabindex="-1"></a>slanu_nosaukumi<span class="ot">=</span><span class="fu">read_csv</span>(<span class="st">&quot;./Geodata/2024/HydroClim/HydroClim_renaming.csv&quot;</span>)</span>
<span id="cb27-16"><a href="Ch04.html#cb27-16" tabindex="-1"></a></span>
<span id="cb27-17"><a href="Ch04.html#cb27-17" tabindex="-1"></a><span class="co"># cropping ---</span></span>
<span id="cb27-18"><a href="Ch04.html#cb27-18" tabindex="-1"></a>tikls1km_reproj<span class="ot">=</span><span class="fu">st_transform</span>(tikls1km,<span class="at">crs=</span><span class="fu">st_crs</span>(videjie))</span>
<span id="cb27-19"><a href="Ch04.html#cb27-19" tabindex="-1"></a>telpai<span class="ot">=</span>tikls1km <span class="sc">%&gt;%</span> </span>
<span id="cb27-20"><a href="Ch04.html#cb27-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yes=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-21"><a href="Ch04.html#cb27-21" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">yes=</span><span class="fu">max</span>(yes)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-22"><a href="Ch04.html#cb27-22" tabindex="-1"></a>  <span class="fu">st_buffer</span>(.,<span class="at">dist=</span><span class="dv">10000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-23"><a href="Ch04.html#cb27-23" tabindex="-1"></a>  <span class="fu">st_transform</span>(.,<span class="at">crs=</span><span class="fu">st_crs</span>(videjie))</span>
<span id="cb27-24"><a href="Ch04.html#cb27-24" tabindex="-1"></a>videjie<span class="ot">=</span>terra<span class="sc">::</span><span class="fu">crop</span>(videjie,telpai)</span>
<span id="cb27-25"><a href="Ch04.html#cb27-25" tabindex="-1"></a></span>
<span id="cb27-26"><a href="Ch04.html#cb27-26" tabindex="-1"></a><span class="co"># layer names ----</span></span>
<span id="cb27-27"><a href="Ch04.html#cb27-27" tabindex="-1"></a><span class="fu">names</span>(videjie)<span class="ot">=</span>slanu_nosaukumi<span class="sc">$</span>local_name</span>
<span id="cb27-28"><a href="Ch04.html#cb27-28" tabindex="-1"></a></span>
<span id="cb27-29"><a href="Ch04.html#cb27-29" tabindex="-1"></a><span class="co"># saving files ----</span></span>
<span id="cb27-30"><a href="Ch04.html#cb27-30" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(slanu_nosaukumi<span class="sc">$</span>local_name)){</span>
<span id="cb27-31"><a href="Ch04.html#cb27-31" tabindex="-1"></a>  nosaukumam<span class="ot">=</span>slanu_nosaukumi<span class="sc">$</span>local_name[i]</span>
<span id="cb27-32"><a href="Ch04.html#cb27-32" tabindex="-1"></a>  <span class="fu">writeRaster</span>(videjie[[i]],</span>
<span id="cb27-33"><a href="Ch04.html#cb27-33" tabindex="-1"></a>              <span class="fu">paste0</span>(<span class="st">&quot;./Geodata/2024/HydroClim/&quot;</span>,nosaukumam),</span>
<span id="cb27-34"><a href="Ch04.html#cb27-34" tabindex="-1"></a>              <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb27-35"><a href="Ch04.html#cb27-35" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>The raster dataset contains values only where large enough rivers are detected
in HydroSHEDS. However, for species distribution modelling in this project
we need continuously covered raster surfaces. For necessary geoprocessing to create such surfaces, we downloaded also HydroBASINS <span class="citation">(<a href="#ref-HydroBasins">Lehner and Grill, 2013</a>)</span> <a href="https://www.hydrosheds.org/products/hydrobasins">dataset</a> to <code>Geodata/2024/HydroClim/</code>.
These procedures were EGV-specific and are described with other <a href="Ch06.html#Ch06">EGVs</a>.</p>
</div>
<div id="Ch04.13" class="section level2 hasAnchor" number="4.13">
<h2><span class="header-section-number">4.13</span> Sentinel-2 indices<a href="Ch04.html#Ch04.13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The European Space Agency (ESA) Copernicus program’s Sentinel-2 mission is a
constellation of two (three since 09/05/2024) identical satellites orbiting in
the same orbit. The first satellite, Sentinel-2A, entered its orbit and
underwent calibration tests on 2015-06-23, the second (Sentinel-2B) on 2017-03-07,
with the first images available earlier. Each satellite captures high-resolution
images (from 10 m (at the equator) pixel resolution) in 13 spectral channels
with a return time of up to 5 days (more frequently closer to the poles) (<a href="https://www.esa.int/Applications/Observing_the_Earth/Copernicus/Sentinel-2" class="uri">https://www.esa.int/Applications/Observing_the_Earth/Copernicus/Sentinel-2</a>). The
data from this mission is freely available, including on the Google Earth Engine
platform <span class="citation">(<a href="#ref-GEEpaper">Gorelick et al., 2017</a>)</span> for various large-scale pre-processing and analysis. We use
the harmonized Level-2A (<a href="https://developers.google.com/earth-engine/datasets/catalog/COPERNICUS_S2_SR_HARMONIZED#description" class="uri">https://developers.google.com/earth-engine/datasets/catalog/COPERNICUS_S2_SR_HARMONIZED#description</a>) product, applying a cloud mask that includes not only cloud filtering but also
shadow filtering, so that for each filtered (cloud and seasonal - from April to
October and from 2020 to 2024) to calculate the normalized difference vegetation
index (NDVI), the normalized difference moisture index (NDMI), and the
normalized difference water index (NDWI) as well as various metrics.
A <a href="https://code.earthengine.google.com/78024b3354cccb526159fd865b214771">replication script</a>
can be used to prepare the data. To use this script,
you need a <a href="https://console.cloud.google.com/earth-engine/welcome">GEE account and project</a>
and sufficient space on Google Drive. When executing the command lines, the
following files will be offered for download:</p>
<ul>
<li><p><code>NDVI_median-ST-[runtag, 20250820 by default]</code> - NDVI short-term median (2020-2024) of annual medians (April to October)</p></li>
<li><p><code>NDVI_p25-ST-[runtag, 20250820 by default]</code> - NDVI short-term median (2020-2024) of annual 25th percentiles (April to October)</p></li>
<li><p><code>NDVI_p75-ST-[runtag, 20250820 by default]</code>- NDVI short-term median (2020-2024) of annual 75th percentiles (April to October)</p></li>
<li><p><code>NDVI_iqr-ST-[runtag, 20250820 by default]</code> - NDVI short-term median (2020-2024) of inter-quartile ranges (April to October)</p></li>
<li><p><code>NDVI_median-LY-[runtag, 20250820 by default]</code> - NDVI last-years (2024) median (April to October)</p></li>
<li><p><code>NDMI_median-ST-[runtag, 20250820 by default]</code> - NDMI short-term median (2020-2024) of annual medians (April to October)</p></li>
<li><p><code>NDMI_p25-ST-[runtag, 20250820 by default]</code> - NDMI short-term median (2020-2024) of annual 25th percentiles (April to October)</p></li>
<li><p><code>NDMI_p75-ST-[runtag, 20250820 by default]</code> - NDMI short-term median (2020-2024) of annual 75th percentiles (April to October)</p></li>
<li><p><code>NDMI_iqr-ST-[runtag, 20250820 by default]</code> - NDMI short-term median (2020-2024) of inter-quartile ranges (April to October)</p></li>
<li><p><code>NDMI_median-LY-[runtag, 20250820 by default]</code> - NDMI last-years (2024) median (April to October)</p></li>
<li><p><code>NDWI_median-ST-[runtag, 20250820 by default]</code> - NDMI short-term median (2020-2024) of annual medians (April to October)</p></li>
<li><p><code>NDWI_p25-ST-[runtag, 20250820 by default]</code> - NDWI short-term median (2020-2024) of annual 25th percentiles (April to October)</p></li>
<li><p><code>NDWI_p75-ST-[runtag, 20250820 by default]</code> - NDWI short-term median (2020-2024) of annual 75th percentiles (April to October)</p></li>
<li><p><code>NDWI_iqr-ST-[runtag, 20250820 by default]</code> - NDWI short-term median (2020-2024) of inter-quartile ranges (April to October)</p></li>
<li><p><code>NDWI_median-LY-[runtag, 20250820 by default]</code> - NDWI last-years (2024) median (April to October)</p></li>
</ul>
<p>After executing the command line and preparing the results in Google Drive, it
can be seen that each layer covering the whole of Latvia is divided into
several tiles. This is because the layers are encoded as Float and exceed 4 GB
in size before GeoTIFF compression. All of these files need to be downloaded and
located at <code>Geodata/2024/S2indices/RAW</code>. The following R commands combine them,
ensuring the coordinate systems and its naming, and pixels match the reference
raster, while renaming files to <code>EO_[index]-[term: ST or LY][statistic]</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="Ch04.html#cb28-1" tabindex="-1"></a><span class="co"># libs ----</span></span>
<span id="cb28-2"><a href="Ch04.html#cb28-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(terra)) {<span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>); <span class="fu">require</span>(terra)}</span>
<span id="cb28-3"><a href="Ch04.html#cb28-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {<span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>); <span class="fu">require</span>(tidyverse)}</span>
<span id="cb28-4"><a href="Ch04.html#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="Ch04.html#cb28-5" tabindex="-1"></a></span>
<span id="cb28-6"><a href="Ch04.html#cb28-6" tabindex="-1"></a><span class="co"># 10 m raster template ----</span></span>
<span id="cb28-7"><a href="Ch04.html#cb28-7" tabindex="-1"></a>template10<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Templates/TemplateRasters/LV10m_10km.tif&quot;</span>)</span>
<span id="cb28-8"><a href="Ch04.html#cb28-8" tabindex="-1"></a></span>
<span id="cb28-9"><a href="Ch04.html#cb28-9" tabindex="-1"></a><span class="co"># Fails as exported from GEE ----</span></span>
<span id="cb28-10"><a href="Ch04.html#cb28-10" tabindex="-1"></a>faili<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">fails=</span><span class="fu">list.files</span>(<span class="st">&quot;./Geodata/2024/S2indices/RAW/&quot;</span>,<span class="at">pattern =</span> <span class="st">&quot;.tif&quot;</span>))</span>
<span id="cb28-11"><a href="Ch04.html#cb28-11" tabindex="-1"></a>faili<span class="sc">$</span>celi_sakums<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;./Geodata/2024/S2indices/RAW/&quot;</span>,faili<span class="sc">$</span>fails)</span>
<span id="cb28-12"><a href="Ch04.html#cb28-12" tabindex="-1"></a></span>
<span id="cb28-13"><a href="Ch04.html#cb28-13" tabindex="-1"></a></span>
<span id="cb28-14"><a href="Ch04.html#cb28-14" tabindex="-1"></a><span class="co"># file names ----</span></span>
<span id="cb28-15"><a href="Ch04.html#cb28-15" tabindex="-1"></a>faili<span class="ot">=</span>faili <span class="sc">%&gt;%</span> </span>
<span id="cb28-16"><a href="Ch04.html#cb28-16" tabindex="-1"></a>  <span class="fu">separate</span>(fails,<span class="at">into=</span><span class="fu">c</span>(<span class="st">&quot;nosaukums&quot;</span>,<span class="st">&quot;vidus&quot;</span>,<span class="st">&quot;beigas&quot;</span>),<span class="at">sep=</span><span class="st">&quot;-&quot;</span>,<span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-17"><a href="Ch04.html#cb28-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mosaic_name=</span><span class="fu">paste0</span>(<span class="st">&quot;EO_&quot;</span>,nosaukums,<span class="st">&quot;-&quot;</span>,beigas,<span class="fu">tolower</span>(vidus),<span class="st">&quot;.tif&quot;</span>),</span>
<span id="cb28-18"><a href="Ch04.html#cb28-18" tabindex="-1"></a>         <span class="at">masaic_cels=</span><span class="fu">paste0</span>(<span class="st">&quot;./Geodata/2024/S2indices/Mosaics/&quot;</span>,mosaic_name))</span>
<span id="cb28-19"><a href="Ch04.html#cb28-19" tabindex="-1"></a></span>
<span id="cb28-20"><a href="Ch04.html#cb28-20" tabindex="-1"></a></span>
<span id="cb28-21"><a href="Ch04.html#cb28-21" tabindex="-1"></a>unikalie<span class="ot">=</span><span class="fu">levels</span>(<span class="fu">factor</span>(faili<span class="sc">$</span>mosaic_name))</span>
<span id="cb28-22"><a href="Ch04.html#cb28-22" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">table</span>(faili<span class="sc">$</span>mosaic_name))</span>
<span id="cb28-23"><a href="Ch04.html#cb28-23" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">table</span>(faili<span class="sc">$</span>mosaic_name))</span>
<span id="cb28-24"><a href="Ch04.html#cb28-24" tabindex="-1"></a></span>
<span id="cb28-25"><a href="Ch04.html#cb28-25" tabindex="-1"></a><span class="co"># preparation of mosaics ----</span></span>
<span id="cb28-26"><a href="Ch04.html#cb28-26" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(unikalie)){</span>
<span id="cb28-27"><a href="Ch04.html#cb28-27" tabindex="-1"></a>  sakums<span class="ot">=</span><span class="fu">Sys.time</span>()</span>
<span id="cb28-28"><a href="Ch04.html#cb28-28" tabindex="-1"></a>  unikalais<span class="ot">=</span>faili <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mosaic_name<span class="sc">==</span>unikalie[i])</span>
<span id="cb28-29"><a href="Ch04.html#cb28-29" tabindex="-1"></a>  beigu_cels<span class="ot">=</span><span class="fu">unique</span>(unikalais<span class="sc">$</span>masaic_cels)</span>
<span id="cb28-30"><a href="Ch04.html#cb28-30" tabindex="-1"></a>  </span>
<span id="cb28-31"><a href="Ch04.html#cb28-31" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb28-32"><a href="Ch04.html#cb28-32" tabindex="-1"></a>  </span>
<span id="cb28-33"><a href="Ch04.html#cb28-33" tabindex="-1"></a>  <span class="co"># there are exactly 2 tiles per file</span></span>
<span id="cb28-34"><a href="Ch04.html#cb28-34" tabindex="-1"></a>  viens<span class="ot">=</span><span class="fu">rast</span>(unikalais<span class="sc">$</span>celi_sakums[<span class="dv">1</span>])</span>
<span id="cb28-35"><a href="Ch04.html#cb28-35" tabindex="-1"></a>  divi<span class="ot">=</span><span class="fu">rast</span>(unikalais<span class="sc">$</span>celi_sakums[<span class="dv">2</span>])</span>
<span id="cb28-36"><a href="Ch04.html#cb28-36" tabindex="-1"></a>  </span>
<span id="cb28-37"><a href="Ch04.html#cb28-37" tabindex="-1"></a>  viens2<span class="ot">=</span>terra<span class="sc">::</span><span class="fu">project</span>(viens,template10)</span>
<span id="cb28-38"><a href="Ch04.html#cb28-38" tabindex="-1"></a>  divi2<span class="ot">=</span>terra<span class="sc">::</span><span class="fu">project</span>(divi,template10)</span>
<span id="cb28-39"><a href="Ch04.html#cb28-39" tabindex="-1"></a>  </span>
<span id="cb28-40"><a href="Ch04.html#cb28-40" tabindex="-1"></a>  mozaika<span class="ot">=</span>terra<span class="sc">::</span><span class="fu">merge</span>(viens2,divi2)</span>
<span id="cb28-41"><a href="Ch04.html#cb28-41" tabindex="-1"></a>  maskets<span class="ot">=</span><span class="fu">mask</span>(mozaika,template10,</span>
<span id="cb28-42"><a href="Ch04.html#cb28-42" tabindex="-1"></a>               <span class="at">filename=</span>beigu_cels,<span class="at">overwrite=</span><span class="cn">TRUE</span>,</span>
<span id="cb28-43"><a href="Ch04.html#cb28-43" tabindex="-1"></a>               <span class="at">gdal=</span><span class="fu">c</span>(<span class="st">&quot;COMPRESS=LZW&quot;</span>,<span class="st">&quot;TILED=YES&quot;</span>,<span class="st">&quot;BIGTIFF=IF_SAFER&quot;</span>),</span>
<span id="cb28-44"><a href="Ch04.html#cb28-44" tabindex="-1"></a>               <span class="at">datatype=</span><span class="st">&quot;FLT4S&quot;</span>,</span>
<span id="cb28-45"><a href="Ch04.html#cb28-45" tabindex="-1"></a>               <span class="at">NAflag=</span><span class="cn">NA</span>)</span>
<span id="cb28-46"><a href="Ch04.html#cb28-46" tabindex="-1"></a>  </span>
<span id="cb28-47"><a href="Ch04.html#cb28-47" tabindex="-1"></a>  <span class="fu">plot</span>(maskets,<span class="at">main=</span>unikalie[i])</span>
<span id="cb28-48"><a href="Ch04.html#cb28-48" tabindex="-1"></a>  <span class="fu">print</span>(beigu_cels)</span>
<span id="cb28-49"><a href="Ch04.html#cb28-49" tabindex="-1"></a>  beigas<span class="ot">=</span><span class="fu">Sys.time</span>()</span>
<span id="cb28-50"><a href="Ch04.html#cb28-50" tabindex="-1"></a>  ilgums<span class="ot">=</span>beigas<span class="sc">-</span>sakums</span>
<span id="cb28-51"><a href="Ch04.html#cb28-51" tabindex="-1"></a>  <span class="fu">print</span>(ilgums)</span>
<span id="cb28-52"><a href="Ch04.html#cb28-52" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
<div id="Ch04.14" class="section level2 hasAnchor" number="4.14">
<h2><span class="header-section-number">4.14</span> Waste and garbage disposal sites, landfills<a href="Ch04.html#Ch04.14" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Information on landfills has been compiled from <a href="https://www.varam.gov.lv/sites/varam/files/content/files/atkritumu_poligoni_lv_karte.pdf">VARAM</a> and
Latvian Environment, Geology and Meteorology Center
<a href="https://videscentrs.lvgmc.lv/files/Vide/Atkritumi_un_radiacijas_objekti/Nr_3_parskats_par_atkritumiem/3Atkritumi_kopsavilkums_2023.pdf">“Report on landfills in Latvia in 2023”</a> listed landfills and their addresses. The coordinates required
for the preparation of EGVs were found by combining the
resources <a href="https://www.google.com/maps" class="uri">https://www.google.com/maps</a> and <a href="https://balticmaps.eu/" class="uri">https://balticmaps.eu/</a>. In addition to
the resources mentioned above, an object was added at the address
“Dardedzes C, Mārupes pag., Mārupes nov., Latvia, LV-2166”.</p>
<p>In addition, information from the <a href="https://skiroviegli.lv/#/">State Environmental Service on
separated waste and deposit packaging collection points</a>
was used, exporting it to an Excel file.</p>
<p>Both data sets were combined into a single file
and <a href="https://github.com/aavotins/HiQBioDiv_EGVs/blob/main/Data/Geodata/2024/GarbageWasteLandfills/Atkritumi.xlsx">added</a> to this material.</p>
</div>
<div id="Ch04.15" class="section level2 hasAnchor" number="4.15">
<h2><span class="header-section-number">4.15</span> Digital elevation/terrain models<a href="Ch04.html#Ch04.15" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With the publication of continuous aerial laser scanning data for the territory of Latvia (<a href="https://www.lgia.gov.lv/lv/digitalie-augstuma-modeli-0" class="uri">https://www.lgia.gov.lv/lv/digitalie-augstuma-modeli-0</a>), various
high-resolution (1 m and higher) digital surface models (DSM) and
digital elevation models (DEM) have been developed. Since the input data is the
same in all cases, the values of these (corresponding) models are identical
across almost the entire territory of the country. However, airborne laser
scanning data (1) is not available for the entire territory of the country,
and (2) there are differences between the models in terms of filling (availability
of values) outside inland waters and (3) filling of water bodies themselves.
However, for areas covered by data on land, the values are almost
identical (Pearson’s correlation coefficients between the DEMs developed
by LU ĢZZF, LVMI Silava, and LĢIA are greater than 0.999999).</p>
<p>The arithmetic mean between the DEMs developed by LU ĢZZF and LVMI Silava,
prepared in the University of Latvia project “Improvement of sustainable soil resource management
in agriculture”, was used as the base DEM. The resolution of this DEM is 1 m,
which is not necessary for species distribution modeling input data, therefore
the layer is designed to correspond to the reference 10 m raster.</p>
<p>When comparing the projected DEM with the reference, there are clearly
distinguishable areas where there is no data. This has been solved by using
the DEM with a resolution of 10 m developed by Māris Nartišs (LU ĢZZF) in 2018,
which covers the entire territory of Latvia without gaps. To prevent sharp
edges from forming in the fill areas (smooth transitions), an arithmetic mean
layer was created, covering the entire territory of Latvia and matching the
reference raster.</p>
<p>A slope layer has also been created from this raster, which is designed in
accordance with the reference. The slope is expressed in degrees and calculated
using the 8-neighbor approach. The same applies to the aspect or slope
direction.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="Ch04.html#cb29-1" tabindex="-1"></a><span class="co"># libs</span></span>
<span id="cb29-2"><a href="Ch04.html#cb29-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(terra)) {<span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>); <span class="fu">require</span>(terra)}</span>
<span id="cb29-3"><a href="Ch04.html#cb29-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sf)) {<span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>); <span class="fu">require</span>(sf)}</span>
<span id="cb29-4"><a href="Ch04.html#cb29-4" tabindex="-1"></a></span>
<span id="cb29-5"><a href="Ch04.html#cb29-5" tabindex="-1"></a><span class="co"># reference</span></span>
<span id="cb29-6"><a href="Ch04.html#cb29-6" tabindex="-1"></a>template10<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Templates/TemplateRasters/LV10m_10km.tif&quot;</span>)</span>
<span id="cb29-7"><a href="Ch04.html#cb29-7" tabindex="-1"></a></span>
<span id="cb29-8"><a href="Ch04.html#cb29-8" tabindex="-1"></a><span class="co"># LiDAR DEM 1 m to 10 m </span></span>
<span id="cb29-9"><a href="Ch04.html#cb29-9" tabindex="-1"></a></span>
<span id="cb29-10"><a href="Ch04.html#cb29-10" tabindex="-1"></a>lapas_1m<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">faili=</span><span class="fu">list.files</span>(<span class="st">&quot;./Geodata/2024/DEM/meanDEM_1mOLD/&quot;</span>,<span class="at">pattern=</span><span class="st">&quot;*.tif$&quot;</span>))</span>
<span id="cb29-11"><a href="Ch04.html#cb29-11" tabindex="-1"></a>lapas_1m<span class="sc">$</span>numurs<span class="ot">=</span><span class="fu">substr</span>(lapas_1m<span class="sc">$</span>faili,<span class="dv">10</span>,<span class="dv">13</span>)</span>
<span id="cb29-12"><a href="Ch04.html#cb29-12" tabindex="-1"></a>lapas_1m<span class="sc">$</span>cels1<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;./Geodata/2024/DEM/meanDEM_1mOLD/&quot;</span>,lapas_1m<span class="sc">$</span>faili)</span>
<span id="cb29-13"><a href="Ch04.html#cb29-13" tabindex="-1"></a>lapas_1m<span class="sc">$</span>cels2<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;./Geodata/2024/DEM/meanDEM_10mOLD/&quot;</span>,lapas_1m<span class="sc">$</span>faili)</span>
<span id="cb29-14"><a href="Ch04.html#cb29-14" tabindex="-1"></a></span>
<span id="cb29-15"><a href="Ch04.html#cb29-15" tabindex="-1"></a>kvadrati<span class="ot">=</span><span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">&quot;GIS_Latvija10.2.gdb&quot;</span>,<span class="at">layer=</span><span class="st">&quot;tks93_50000&quot;</span>)</span>
<span id="cb29-16"><a href="Ch04.html#cb29-16" tabindex="-1"></a>kvadrati<span class="sc">$</span>name<span class="ot">=</span><span class="fu">as.character</span>(kvadrati<span class="sc">$</span>num50tk)</span>
<span id="cb29-17"><a href="Ch04.html#cb29-17" tabindex="-1"></a></span>
<span id="cb29-18"><a href="Ch04.html#cb29-18" tabindex="-1"></a>moz2<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/DEM/Nartiss_visa_Latvija/dem10_20_kopa.tif&quot;</span>)</span>
<span id="cb29-19"><a href="Ch04.html#cb29-19" tabindex="-1"></a></span>
<span id="cb29-20"><a href="Ch04.html#cb29-20" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(kvadrati<span class="sc">$</span>name)){</span>
<span id="cb29-21"><a href="Ch04.html#cb29-21" tabindex="-1"></a>  kvadrats<span class="ot">=</span>kvadrati[i,]</span>
<span id="cb29-22"><a href="Ch04.html#cb29-22" tabindex="-1"></a>  nosaukums<span class="ot">=</span>kvadrats<span class="sc">$</span>name</span>
<span id="cb29-23"><a href="Ch04.html#cb29-23" tabindex="-1"></a>  telpa<span class="ot">=</span>terra<span class="sc">::</span><span class="fu">ext</span>(kvadrats)</span>
<span id="cb29-24"><a href="Ch04.html#cb29-24" tabindex="-1"></a>  </span>
<span id="cb29-25"><a href="Ch04.html#cb29-25" tabindex="-1"></a>  paraugs<span class="ot">=</span><span class="fu">crop</span>(template10,telpa)</span>
<span id="cb29-26"><a href="Ch04.html#cb29-26" tabindex="-1"></a>  nart<span class="ot">=</span><span class="fu">crop</span>(moz2,telpa)</span>
<span id="cb29-27"><a href="Ch04.html#cb29-27" tabindex="-1"></a>  nart2<span class="ot">=</span><span class="fu">project</span>(nart,paraugs,<span class="at">mask=</span><span class="cn">TRUE</span>)</span>
<span id="cb29-28"><a href="Ch04.html#cb29-28" tabindex="-1"></a>  </span>
<span id="cb29-29"><a href="Ch04.html#cb29-29" tabindex="-1"></a>  dem1m<span class="ot">=</span>lapas_1m[lapas_1m<span class="sc">$</span>numurs<span class="sc">==</span>kvadrats<span class="sc">$</span>name,]</span>
<span id="cb29-30"><a href="Ch04.html#cb29-30" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(dem1m)<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb29-31"><a href="Ch04.html#cb29-31" tabindex="-1"></a>    sakumcels<span class="ot">=</span>dem1m<span class="sc">$</span>cels1</span>
<span id="cb29-32"><a href="Ch04.html#cb29-32" tabindex="-1"></a>    dem<span class="ot">=</span><span class="fu">rast</span>(sakumcels)</span>
<span id="cb29-33"><a href="Ch04.html#cb29-33" tabindex="-1"></a>    reproj<span class="ot">=</span><span class="fu">project</span>(dem,paraugs,<span class="at">mask=</span><span class="cn">TRUE</span>,<span class="at">method=</span><span class="st">&quot;bilinear&quot;</span>,<span class="at">use_gdal=</span><span class="cn">TRUE</span>)</span>
<span id="cb29-34"><a href="Ch04.html#cb29-34" tabindex="-1"></a>    videjais <span class="ot">&lt;-</span> <span class="fu">ifel</span>(<span class="fu">is.na</span>(nart2),nart2,<span class="fu">ifel</span>(<span class="fu">is.na</span>(reproj),nart2,</span>
<span id="cb29-35"><a href="Ch04.html#cb29-35" tabindex="-1"></a>                                             <span class="fu">app</span>(<span class="fu">c</span>(nart2,reproj), mean)))</span>
<span id="cb29-36"><a href="Ch04.html#cb29-36" tabindex="-1"></a>    <span class="fu">writeRaster</span>(videjais,<span class="at">overwrite=</span><span class="cn">TRUE</span>,</span>
<span id="cb29-37"><a href="Ch04.html#cb29-37" tabindex="-1"></a>                <span class="at">filename=</span><span class="fu">paste0</span>(<span class="st">&quot;./Geodata/2024/DEM/meanDEM_10m/&quot;</span>,<span class="st">&quot;vidDEM_&quot;</span>,</span>
<span id="cb29-38"><a href="Ch04.html#cb29-38" tabindex="-1"></a>                                nosaukums,<span class="st">&quot;.tif&quot;</span>))</span>
<span id="cb29-39"><a href="Ch04.html#cb29-39" tabindex="-1"></a>  }</span>
<span id="cb29-40"><a href="Ch04.html#cb29-40" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb29-41"><a href="Ch04.html#cb29-41" tabindex="-1"></a>    <span class="fu">writeRaster</span>(nart2,<span class="at">overwrite=</span><span class="cn">TRUE</span>,</span>
<span id="cb29-42"><a href="Ch04.html#cb29-42" tabindex="-1"></a>                <span class="at">filename=</span><span class="fu">paste0</span>(<span class="st">&quot;./Geodata/2024/DEM/meanDEM_10m/&quot;</span>,<span class="st">&quot;vidDEM_&quot;</span>,</span>
<span id="cb29-43"><a href="Ch04.html#cb29-43" tabindex="-1"></a>                                nosaukums,<span class="st">&quot;.tif&quot;</span>))</span>
<span id="cb29-44"><a href="Ch04.html#cb29-44" tabindex="-1"></a>  }</span>
<span id="cb29-45"><a href="Ch04.html#cb29-45" tabindex="-1"></a>}</span>
<span id="cb29-46"><a href="Ch04.html#cb29-46" tabindex="-1"></a></span>
<span id="cb29-47"><a href="Ch04.html#cb29-47" tabindex="-1"></a><span class="co"># vrt un mozaic</span></span>
<span id="cb29-48"><a href="Ch04.html#cb29-48" tabindex="-1"></a>lapas_10<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">faili=</span><span class="fu">list.files</span>(<span class="st">&quot;./Geodata/2024/DEM/meanDEM_10m/&quot;</span>,<span class="at">pattern=</span><span class="st">&quot;*.tif$&quot;</span>))</span>
<span id="cb29-49"><a href="Ch04.html#cb29-49" tabindex="-1"></a>lapas_10<span class="sc">$</span>celi1<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;./Geodata/2024/DEM/meanDEM_10m/&quot;</span>,lapas_10<span class="sc">$</span>faili)</span>
<span id="cb29-50"><a href="Ch04.html#cb29-50" tabindex="-1"></a>mozaikai<span class="ot">=</span><span class="fu">vrt</span>(lapas_10<span class="sc">$</span>celi1,<span class="at">overwrite=</span><span class="cn">TRUE</span>,</span>
<span id="cb29-51"><a href="Ch04.html#cb29-51" tabindex="-1"></a>             <span class="at">filename=</span><span class="st">&quot;./Geodata/2024/DEM/vrtDEM_10m.tif&quot;</span>)</span>
<span id="cb29-52"><a href="Ch04.html#cb29-52" tabindex="-1"></a>mozaika<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/DEM/vrtDEM_10m.tif&quot;</span>)</span>
<span id="cb29-53"><a href="Ch04.html#cb29-53" tabindex="-1"></a><span class="fu">writeRaster</span>(mozaika,<span class="st">&quot;./Geodata/2024/DEM/mozDEM_10m.tif&quot;</span>)</span>
<span id="cb29-54"><a href="Ch04.html#cb29-54" tabindex="-1"></a></span>
<span id="cb29-55"><a href="Ch04.html#cb29-55" tabindex="-1"></a></span>
<span id="cb29-56"><a href="Ch04.html#cb29-56" tabindex="-1"></a><span class="do">## slope</span></span>
<span id="cb29-57"><a href="Ch04.html#cb29-57" tabindex="-1"></a>reljefs<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/DEM/mozDEM_10m.tif&quot;</span>)</span>
<span id="cb29-58"><a href="Ch04.html#cb29-58" tabindex="-1"></a>slipumi<span class="ot">=</span><span class="fu">terrain</span>(reljefs, <span class="at">v=</span><span class="st">&quot;slope&quot;</span>, <span class="at">neighbors=</span><span class="dv">8</span>, <span class="at">unit=</span><span class="st">&quot;degrees&quot;</span>, </span>
<span id="cb29-59"><a href="Ch04.html#cb29-59" tabindex="-1"></a>                <span class="at">filename=</span><span class="st">&quot;./Geodata/2024/DEM/Terrain_Slope_10m.tif&quot;</span>, <span class="at">overwrite=</span><span class="cn">TRUE</span>)  </span>
<span id="cb29-60"><a href="Ch04.html#cb29-60" tabindex="-1"></a></span>
<span id="cb29-61"><a href="Ch04.html#cb29-61" tabindex="-1"></a><span class="do">## aspect </span></span>
<span id="cb29-62"><a href="Ch04.html#cb29-62" tabindex="-1"></a>reljefs<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/DEM/mozDEM_10m.tif&quot;</span>)</span>
<span id="cb29-63"><a href="Ch04.html#cb29-63" tabindex="-1"></a>virzieni<span class="ot">=</span><span class="fu">terrain</span>(reljefs, <span class="at">v=</span><span class="st">&quot;aspect&quot;</span>, <span class="at">neighbors=</span><span class="dv">8</span>, <span class="at">unit=</span><span class="st">&quot;degrees&quot;</span>, </span>
<span id="cb29-64"><a href="Ch04.html#cb29-64" tabindex="-1"></a>                 <span class="at">filename=</span><span class="st">&quot;./Geodata/2024/DEM/Terrain_Aspect_10m.tif&quot;</span>, <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</details>
</div>
<div id="Ch04.16" class="section level2 hasAnchor" number="4.16">
<h2><span class="header-section-number">4.16</span> Latvian Exclusive Economic Zone polygon<a href="Ch04.html#Ch04.16" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The waters of Latvia’s Exclusive Economic Zone were obtained from
the <a href="https://maps.helcom.fi/website/mapservice/?datasetID=ae58c373-674c-45d1-be0f-1ff69a59f9ba">HELCOM map and data service</a>. After downloading, this line file was
analogically connected to the coastline file obtained from the same resource.</p>
</div>
<div id="Ch04.17" class="section level2 hasAnchor" number="4.17">
<h2><span class="header-section-number">4.17</span> Bogs and Mires: EDI<a href="Ch04.html#Ch04.17" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data (training and classification) used in project “Remote Sensing and Machine
Learning for Peatland Habitat Monitoring (PurvEO)” by Institute of electronics
and computer science are stored at <code>Geodata/2024/Bogs_EDI</code>.</p>
<p>Preprocessing combines this information to create two layers:</p>
<ul>
<li><p><code>EDI_BogsYN.tif</code>: training and classification results on open raised bogs (EU
protected habitat codes 7110 and 7120) and locations where on of those overlaps
with transitional mires (EU protected habitat code 7140);</p></li>
<li><p><code>EDI_TransitionalMiresYN.tif</code>: training and classification results on
transitional mires (EU protected habitat code 7140) with no overlap with open
rised bogs.</p></li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="Ch04.html#cb30-1" tabindex="-1"></a><span class="co"># libs</span></span>
<span id="cb30-2"><a href="Ch04.html#cb30-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(sf)) {<span class="fu">install.packages</span>(<span class="st">&quot;sf&quot;</span>); <span class="fu">require</span>(sf)}</span>
<span id="cb30-3"><a href="Ch04.html#cb30-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {<span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>); <span class="fu">require</span>(tidyverse)}</span>
<span id="cb30-4"><a href="Ch04.html#cb30-4" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(terra)) {<span class="fu">install.packages</span>(<span class="st">&quot;terra&quot;</span>); <span class="fu">require</span>(terra)}</span>
<span id="cb30-5"><a href="Ch04.html#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="Ch04.html#cb30-6" tabindex="-1"></a></span>
<span id="cb30-7"><a href="Ch04.html#cb30-7" tabindex="-1"></a><span class="co"># Templates ----</span></span>
<span id="cb30-8"><a href="Ch04.html#cb30-8" tabindex="-1"></a>template10<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Templates/TemplateRasters/LV10m_10km.tif&quot;</span>)</span>
<span id="cb30-9"><a href="Ch04.html#cb30-9" tabindex="-1"></a>template100<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Templates/TemplateRasters/LV100m_10km.tif&quot;</span>)</span>
<span id="cb30-10"><a href="Ch04.html#cb30-10" tabindex="-1"></a></span>
<span id="cb30-11"><a href="Ch04.html#cb30-11" tabindex="-1"></a>nulles10<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Templates/TemplateRasters/nulls_LV10m_10km.tif&quot;</span>)</span>
<span id="cb30-12"><a href="Ch04.html#cb30-12" tabindex="-1"></a></span>
<span id="cb30-13"><a href="Ch04.html#cb30-13" tabindex="-1"></a></span>
<span id="cb30-14"><a href="Ch04.html#cb30-14" tabindex="-1"></a><span class="co"># Bogs ----</span></span>
<span id="cb30-15"><a href="Ch04.html#cb30-15" tabindex="-1"></a>neatklata71107120<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/Bogs_EDI/purvi_EDI_projekts/purvi/!LV_kopa_apv1020_30_05_2022/!LV_kopa_apv1020_30_05_2022/Neatklata_purviem_raksturiga_zemsedze_7110_7120.tif&quot;</span>)</span>
<span id="cb30-16"><a href="Ch04.html#cb30-16" tabindex="-1"></a>neatklata71107120<span class="ot">=</span><span class="fu">ifel</span>(neatklata71107120<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="cn">NA</span>)</span>
<span id="cb30-17"><a href="Ch04.html#cb30-17" tabindex="-1"></a><span class="fu">plot</span>(neatklata71107120)</span>
<span id="cb30-18"><a href="Ch04.html#cb30-18" tabindex="-1"></a>neatklata7140<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/Bogs_EDI/purvi_EDI_projekts/purvi/!LV_kopa_apv1020_30_05_2022/!LV_kopa_apv1020_30_05_2022/Neatklata_purviem_raksturiga_zemsedze_7140.tif&quot;</span>)</span>
<span id="cb30-19"><a href="Ch04.html#cb30-19" tabindex="-1"></a>neatklata7140<span class="ot">=</span><span class="fu">ifel</span>(neatklata7140<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="cn">NA</span>)</span>
<span id="cb30-20"><a href="Ch04.html#cb30-20" tabindex="-1"></a></span>
<span id="cb30-21"><a href="Ch04.html#cb30-21" tabindex="-1"></a>raskturiga71107120<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/Bogs_EDI/purvi_EDI_projekts/purvi/!LV_kopa_apv1020_30_05_2022/!LV_kopa_apv1020_30_05_2022/Purviem_neraksturiga_zemsedze_7110_7120.tif&quot;</span>)</span>
<span id="cb30-22"><a href="Ch04.html#cb30-22" tabindex="-1"></a>raskturiga71107120<span class="ot">=</span><span class="fu">ifel</span>(raskturiga71107120<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="cn">NA</span>)</span>
<span id="cb30-23"><a href="Ch04.html#cb30-23" tabindex="-1"></a>raksturiga7140<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/Bogs_EDI/purvi_EDI_projekts/purvi/!LV_kopa_apv1020_30_05_2022/!LV_kopa_apv1020_30_05_2022/Purviem_neraksturiga_zemsedze_7140.tif&quot;</span>)</span>
<span id="cb30-24"><a href="Ch04.html#cb30-24" tabindex="-1"></a>raksturiga7140<span class="ot">=</span><span class="fu">ifel</span>(raksturiga7140<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="cn">NA</span>)</span>
<span id="cb30-25"><a href="Ch04.html#cb30-25" tabindex="-1"></a></span>
<span id="cb30-26"><a href="Ch04.html#cb30-26" tabindex="-1"></a>labels71107120<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/Bogs_EDI/purvi_EDI_projekts/purvi/!LV_kopa_apv1020_30_05_2022/!LV_kopa_apv1020_30_05_2022/latvija_Labels_B7110_7120.tif&quot;</span>)</span>
<span id="cb30-27"><a href="Ch04.html#cb30-27" tabindex="-1"></a>labels71107120<span class="ot">=</span><span class="fu">ifel</span>(labels71107120<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="cn">NA</span>)</span>
<span id="cb30-28"><a href="Ch04.html#cb30-28" tabindex="-1"></a>labels7140<span class="ot">=</span><span class="fu">rast</span>(<span class="st">&quot;./Geodata/2024/Bogs_EDI/purvi_EDI_projekts/purvi/!LV_kopa_apv1020_30_05_2022/!LV_kopa_apv1020_30_05_2022/latvija_Labels_B7140.tif&quot;</span>)</span>
<span id="cb30-29"><a href="Ch04.html#cb30-29" tabindex="-1"></a>labels7140<span class="ot">=</span><span class="fu">ifel</span>(labels7140<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="cn">NA</span>)</span>
<span id="cb30-30"><a href="Ch04.html#cb30-30" tabindex="-1"></a></span>
<span id="cb30-31"><a href="Ch04.html#cb30-31" tabindex="-1"></a>augstie<span class="ot">=</span><span class="fu">cover</span>(<span class="fu">cover</span>(neatklata71107120,raskturiga71107120),labels71107120)</span>
<span id="cb30-32"><a href="Ch04.html#cb30-32" tabindex="-1"></a>parejas<span class="ot">=</span><span class="fu">cover</span>(<span class="fu">cover</span>(neatklata7140,raksturiga7140),labels7140)</span>
<span id="cb30-33"><a href="Ch04.html#cb30-33" tabindex="-1"></a>tikai_parejas<span class="ot">=</span><span class="fu">ifel</span>(parejas<span class="sc">==</span><span class="dv">1</span><span class="sc">&amp;</span>augstie<span class="sc">==</span><span class="dv">1</span>,<span class="cn">NA</span>,parejas)</span>
<span id="cb30-34"><a href="Ch04.html#cb30-34" tabindex="-1"></a>sunainie<span class="ot">=</span><span class="fu">ifel</span>(parejas<span class="sc">==</span><span class="dv">1</span><span class="sc">&amp;</span>augstie<span class="sc">==</span><span class="dv">1</span>,parejas,<span class="cn">NA</span>)</span>
<span id="cb30-35"><a href="Ch04.html#cb30-35" tabindex="-1"></a></span>
<span id="cb30-36"><a href="Ch04.html#cb30-36" tabindex="-1"></a>sunu_purvi<span class="ot">=</span><span class="fu">cover</span>(augstie,sunainie)</span>
<span id="cb30-37"><a href="Ch04.html#cb30-37" tabindex="-1"></a></span>
<span id="cb30-38"><a href="Ch04.html#cb30-38" tabindex="-1"></a>sunu_proj<span class="ot">=</span><span class="fu">project</span>(sunu_purvi,template10)</span>
<span id="cb30-39"><a href="Ch04.html#cb30-39" tabindex="-1"></a>sunuYN<span class="ot">=</span><span class="fu">cover</span>(sunu_proj,nulles10)</span>
<span id="cb30-40"><a href="Ch04.html#cb30-40" tabindex="-1"></a><span class="fu">plot</span>(sunuYN)</span>
<span id="cb30-41"><a href="Ch04.html#cb30-41" tabindex="-1"></a><span class="fu">writeRaster</span>(sunuYN,</span>
<span id="cb30-42"><a href="Ch04.html#cb30-42" tabindex="-1"></a>            <span class="at">overwrite=</span><span class="cn">TRUE</span>,</span>
<span id="cb30-43"><a href="Ch04.html#cb30-43" tabindex="-1"></a>            <span class="at">filename=</span><span class="st">&quot;./RasterGrids_10m/2024/EDI_BogsYN.tif&quot;</span>)</span>
<span id="cb30-44"><a href="Ch04.html#cb30-44" tabindex="-1"></a></span>
<span id="cb30-45"><a href="Ch04.html#cb30-45" tabindex="-1"></a></span>
<span id="cb30-46"><a href="Ch04.html#cb30-46" tabindex="-1"></a></span>
<span id="cb30-47"><a href="Ch04.html#cb30-47" tabindex="-1"></a><span class="co"># Transitional mires ----</span></span>
<span id="cb30-48"><a href="Ch04.html#cb30-48" tabindex="-1"></a>parejas_proj<span class="ot">=</span><span class="fu">project</span>(tikai_parejas,template10)</span>
<span id="cb30-49"><a href="Ch04.html#cb30-49" tabindex="-1"></a>parejasYN<span class="ot">=</span><span class="fu">cover</span>(parejas_proj,nulles10)</span>
<span id="cb30-50"><a href="Ch04.html#cb30-50" tabindex="-1"></a><span class="fu">plot</span>(parejasYN)</span>
<span id="cb30-51"><a href="Ch04.html#cb30-51" tabindex="-1"></a><span class="fu">writeRaster</span>(parejasYN,</span>
<span id="cb30-52"><a href="Ch04.html#cb30-52" tabindex="-1"></a>            <span class="at">overwrite=</span><span class="cn">TRUE</span>,</span>
<span id="cb30-53"><a href="Ch04.html#cb30-53" tabindex="-1"></a>            <span class="at">filename=</span><span class="st">&quot;./RasterGrids_10m/2024/EDI_TransitionalMiresYN.tif&quot;</span>)</span></code></pre></div>
</details>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-DynWorld" class="csl-entry">
Brown, C.F., Brumby, S.P., Guzder-Williams, B., Birch, T., Hyde, S.B., Mazzariello, J., Czerwinski, W., Pasquarella, V.J., Haertel, R., Ilyushchenko, S., Schwehr, K., Weisse, M., Stolle, F., Hanson, C., Guinan, O., Moore, R., Tait, A.M., 2022. <span>Dynamic</span> <span>World</span>, <span>Near</span> real-time global 10 m land use land cover mapping. Scientific Data 9, 251. <a href="https://doi.org/10.1038/s41597-022-01307-4">https://doi.org/10.1038/s41597-022-01307-4</a>
</div>
<div id="ref-HydroClim" class="csl-entry">
Domisch, S., Amatulli, G., Jetz, W., 2015. Near-global freshwater-specific environmental variables for biodiversity analyses in 1 km resolution. Scientific Data 2:150073, 1–13. <a href="https://doi.org/10.1038/sdata.2015.73">https://doi.org/10.1038/sdata.2015.73</a>
</div>
<div id="ref-GEEpaper" class="csl-entry">
Gorelick, N., Hancher, M., Dixon, M., Ilyushchenko, S., Thau, D., Moore, R., 2017. <span>Google</span> <span>Earth</span> <span>Engine</span>: <span class="nocase">Planetary-scale</span> geospatial analysis for everyone. Remote Sensing of Environment 202, 18–27. <a href="https://doi.org/10.1016/j.rse.2017.06.031">https://doi.org/10.1016/j.rse.2017.06.031</a>
</div>
<div id="ref-theGFW" class="csl-entry">
Hansen, M.C., Potapov, P.V., Moore, R., Hancher, M., Turubanova, S.A., Tyukavina, A., Thau, D., Stehman, S.V., Goetz, S.J., Loveland, T.R., Kommareddy, A., Egorov, A., Chini, L., Justice, C.O., Townshend, J.R.G., 2013. <span>High</span>-resolution <span>Global</span> maps of 21st-century forest cover change. Science 342, 850–853. <a href="https://doi.org/10.1126/science.1244693">https://doi.org/10.1126/science.1244693</a>
</div>
<div id="ref-worldclim_hijmans" class="csl-entry">
Hijmans, R.J., Cameron, S.E., Parra, J.L., Jones, P.G., Jarvis, A., 2005. Very high resolution interpolated climate surfaces for global land areas. International Journal of Climatology 25, 1965–1978. <a href="https://doi.org/10.1002/joc.1276">https://doi.org/10.1002/joc.1276</a>
</div>
<div id="ref-CHELSA" class="csl-entry">
Karger, D.N., Conrad, O., Böhner, J., Kawohl, T., Kreft, H., Soria-Auza, R.W., Zimmermann, N.E., Linder, H.P., Kessler, M., 2017. <span>Data</span> <span>Descriptor</span>: <span>Climatologies</span> at high resolution for the earth’s land surface areas. Scientific Data 4:170122. <a href="https://doi.org/10.1038/sdata.2017.122">https://doi.org/10.1038/sdata.2017.122</a>
</div>
<div id="ref-HydroBasins" class="csl-entry">
Lehner, B., Grill, G., 2013. Global river hydrography and network routing: Baseline data and new approaches to study the world’s large river systems. Hydrological Processes 27, 2171–2186. <a href="https://doi.org/10.1002/hyp.9740">https://doi.org/10.1002/hyp.9740</a>
</div>
<div id="ref-HydroSheds" class="csl-entry">
Lehner, B., Verdin, K., Jarvis, A., 2008. New global hydrography derived from spaceborne elevation data. Eos, Transactions, American Geophysical Union 89, 93–94. <a href="https://doi.org/10.1029/2008EO100001">https://doi.org/10.1029/2008EO100001</a>
</div>
<div id="ref-esdac2" class="csl-entry">
Panagos, P., Liedekerke, M.V., Borrelli, P., Köninger, J., Ballabio, C., Orgiazzi, A., Lugato, E., Liakos, L., Hervas, J., Jones, A., Montanarella, L., 2022. <span>European</span> <span>Soil</span> <span>Data</span> <span>Centre</span> 2.0: <span>Soil</span> data and knowledge in support of the <span>EU</span> policies. European Journal of Soil Science 73, e13315. <a href="https://doi.org/10.1111/ejss.13315">https://doi.org/10.1111/ejss.13315</a>
</div>
<div id="ref-PALSARForest" class="csl-entry">
Shimada, M., Itoh, T., Motooka, T., Watanabe, M., Shiraishi, T., Thapa, R., Lucas, R., 2013. New global forest/non-forest maps from <span>ALOS PALSAR</span> data (2007–2010). Remote Sensing of Environment 155, 13–31. <a href="https://doi.org/10.1016/j.rse.2014.04.014">https://doi.org/10.1016/j.rse.2014.04.014</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Ch03.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Ch05.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": false,
    "twitter": false,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/aavotins/HiQBioDiv_EGVs/edit/main/book/04-RawGeodata.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["HiQBioDiv-EGVs.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true
  }
});
});
</script>

</body>

</html>
